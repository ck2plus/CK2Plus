namespace = Plus

#reserved: Plus.1850 to Plus.1899

#######################################
# IMPERIAL EVENTS
# Written by Rylock
#######################################

### MAINTENANCE EVENTS

# Main decadence event upon an imperial title being inherited/usurped
# ROOT is the character, FROM is the title, FROMFROM is the old holder
character_event = {
	id = Plus.1850

	is_triggered_only = yes
	hide_window = yes

	trigger = {
		OR = {
			# Inheritance
			AND = {
				FROMFROM = { always = yes }

				FROM = {
					real_tier = EMPEROR
					is_primary_holder_title = yes
					temporary = no
					is_tribal = no
					is_nomadic = no
				}

				uses_decadence = no
				is_nomadic = no
				is_tribal = no
			}

			# TODO: Why is this here?
			AND = {
				is_playable = yes
				has_game_started = no
				FROM = { is_primary_holder_title = yes }
			}
		}
	}

	immediate = {
		FROM = { save_event_target_as = imperial_decadence_title }

		FROMFROM = {
			save_event_target_as = imperial_decadence_old_holder

			# Remove the decadence modifier from the former owner, if alive
			if = {
				limit = {
					is_alive = yes
					lower_real_tier_than = EMPEROR
				}

				remove_character_modifier = imperial_decadence_1
				remove_character_modifier = imperial_decadence_2
				remove_character_modifier = imperial_decadence_3
				remove_character_modifier = imperial_decadence_4
				remove_character_modifier = imperial_decadence_5
				remove_character_modifier = imperial_decadence_6
				remove_character_modifier = imperial_decadence_7
				remove_character_modifier = imperial_decadence_8
			}
		}

		character_event = {
			id = Plus.1851
			days = 1
		}
	}
}

# ROOT/FROM is the character
# FROMFROM is the title
# FROMFROMFROM is the old holder
character_event = {
	id = Plus.1851

	is_triggered_only = yes
	hide_window = yes

	only_rulers = yes

	trigger = {
		has_landed_title = event_target:imperial_decadence_title
		uses_decadence = no
		is_ironman = no
		is_nomadic = no
	}

	immediate = {
		# First look for other held imperial titles which have higher decadence, and copy their value over
		any_demesne_title = {
			limit = {
				real_tier = EMPEROR
				is_primary_holder_title = no

				check_variable = {
					which = imperial_decadence
					which >= event_target:imperial_decadence_title
				}
			}

			event_target:imperial_decadence_title = {
				set_variable = {
					which = imperial_decadence
					which = PREV
				}
			}
		}

		event_target:imperial_decadence_title = {
			# Reset the decadence value to 0, in case it's negative
			if = {
				limit = { check_variable = { which = imperial_decadence value < 0 } }
				set_variable = { which = imperial_decadence value = 0 }
			}

			# Set new ruler decadence to 0
			set_variable = { which = local_new_ruler_decadence value = 0 }

			# New ruler decadence base is dependant on inherited decadence
			if = {
				limit = { check_variable = { which = imperial_decadence value < 11 } }
				change_variable = { which = local_new_ruler_decadence value = 1 }
			}
			else_if = {
				limit = { check_variable = { which = imperial_decadence value < 21 } }
				change_variable = { which = local_new_ruler_decadence value = 2 }
			}
			else_if = {
				limit = { check_variable = { which = imperial_decadence value < 31 } }
				change_variable = { which = local_new_ruler_decadence value = 3 }
			}
			else_if = {
				limit = { check_variable = { which = imperial_decadence value < 41 } }
				change_variable = { which = local_new_ruler_decadence value = 5 }
			}
			else_if = {
				limit = { check_variable = { which = imperial_decadence value < 51 } }
				change_variable = { which = local_new_ruler_decadence value = 8 }
			}
			else = {
				change_variable = { which = local_new_ruler_decadence value = 13 }
			}

			# Increase new ruler decadence by one if this is a continuing dynasty
			if = {
				limit = { ROOT = { dynasty = event_target:imperial_decadence_old_holder } }
				change_variable = { which = local_new_ruler_decadence value = 1 }
			}

			# Increase more if this is a usurpation
			if = {
				limit = {
					event_target:imperial_decadence_old_holder = {
						has_claim = event_target:imperial_decadence_title
						is_alive = yes
					}
				}

				change_variable = { which = local_new_ruler_decadence value = 2 }
			}

			# Byzantium/Roman Empire/HRE gets an additional +1
			if = {
				limit = {
					event_target:imperial_decadence_title = {
						OR = {
							title = e_byzantium
							title = e_roman_empire
							title = e_hre
						}
					}
				}

				change_variable = { which = local_new_ruler_decadence value = 1 }
			}

			# Then determine how much the realm size should change it
			if = {
				limit = { ROOT = { has_horde_culture = yes } }
				change_variable = { which = local_new_ruler_decadence value = -2 }
			}

			if = {
				limit = { ROOT = { realm_size >= 500 } }
				change_variable = { which = local_new_ruler_decadence value = 10 }
			}
			else_if = {
				limit = { ROOT = { realm_size >= 400 } }
				change_variable = { which = local_new_ruler_decadence value = 6 }
			}
			else_if = {
				limit = { ROOT = { realm_size >= 300 } }
				change_variable = { which = local_new_ruler_decadence value = 3 }
			}
			else_if = {
				limit = { ROOT = { realm_size >= 200 } }
				change_variable = { which = local_new_ruler_decadence value = 1 }
			}
			else_if = {
				limit = { ROOT = { realm_size < 100 } }
				change_variable = { which = local_new_ruler_decadence value = -1 }
			}

			# Then determine how much CA should change it
			if = {
				limit = { has_law = crown_authority_1 }
				change_variable = { which = local_new_ruler_decadence value = 1 }
			}
			else_if = {
				limit = { has_law = crown_authority_2 }
				change_variable = { which = local_new_ruler_decadence value = 2 }
			}
			else_if = {
				limit = { has_law = crown_authority_3 }
				change_variable = { which = local_new_ruler_decadence value = 3 }
			}
			else_if = {
				limit = { has_law = crown_authority_4 }
				change_variable = { which = local_new_ruler_decadence value = 4 }
			}

			# One if imperial government
			if = {
				limit = { owner = { has_imperial_government_trigger = yes } }
				change_variable = { which = local_new_ruler_decadence value = 1 }
			}

			# Reduce if low vasssal count
			if = {
				limit = { ROOT = { num_of_vassals < 10 } }
				change_variable = { which = local_new_ruler_decadence value = -3 }
			}
			else_if = {
				limit = { ROOT = { num_of_vassals < 20 } }
				change_variable = { which = local_new_ruler_decadence value = -2 }
			}
			else_if = {
				limit = { ROOT = { num_of_vassals < 30 } }
				change_variable = { which = local_new_ruler_decadence value = -1 }
			}

			# Cut inherited decadence by a fifth if continuing dynasty we've had normal dynastic succession, or elective
			if = {
				limit = {
					event_target:imperial_decadence_old_holder = {
						is_alive = no

						OR = {
							dynasty = ROOT
							has_law = succ_feudal_elective
							has_law = succ_hre_elective
							has_law = succ_byzantine_elective
						}
					}
				}

				multiply_variable = { which = imperial_decadence value = 0.8 }
			}

			# Reduce a bit more if ruler was overthrown
			else_if = {
				limit = { has_title_flag = skip_decadence_gain }
				clr_title_flag = skip_decadence_gain
				multiply_variable = { which = imperial_decadence value = 0.67 }
			}
			else = { # whatever situation
				multiply_variable = { which = imperial_decadence value = 0.75 }
			}

			change_variable = { which = imperial_decadence which = local_new_ruler_decadence }

		}

		# Change the decadence modifier
		character_event = { id = Plus.1852 }
		clear_event_target = imperial_decadence_old_holder
		clear_event_target = imperial_decadence_title
	}
}

# Notification of decadence change and adding the proper decadence modifier
character_event = {
	id = Plus.1852
	desc = EVTDESC_Plus_1852
	picture = GFX_evt_council

	is_triggered_only = yes
	notification = yes

	trigger = {
		trigger_if = {
			limit = {
				OR = {
					uses_decadence = yes
					is_tribal = yes
					is_nomadic = yes
				}
			}

			primary_title = {
				check_variable = {
					which = imperial_decadence
					value < 0
				}
			}
		}
	}

	immediate = {
		# Reset the decadence value to 0, in case it's negative, or set it on game-start
		primary_title = {
			if = {
				limit = {
					check_variable = {
						which = imperial_decadence
						value <= 0
					}
				}

				set_variable = {
					which = imperial_decadence
					value = 0
				}
			}
		}

		# Remove old decadence modifier and add the new one
		remove_character_modifier = imperial_decadence_1
		remove_character_modifier = imperial_decadence_2
		remove_character_modifier = imperial_decadence_3
		remove_character_modifier = imperial_decadence_4
		remove_character_modifier = imperial_decadence_5
		remove_character_modifier = imperial_decadence_6
		remove_character_modifier = imperial_decadence_7
		remove_character_modifier = imperial_decadence_8

		# These don't use this system
		if = {
			limit = {
				OR = {
					uses_decadence = yes
					is_tribal = yes
					is_nomadic = yes
				}
			}

			primary_title = {
				set_variable = {
					which = imperial_decadence
					value = 0
				}
			}
		}


		if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 80 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_8
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 70 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_6
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 60 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_6
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 50 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_5
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 40 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_4
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 30 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_3
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 20 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_2
				duration = -1
			}
		}
		else_if = {
			limit = {
				primary_title = {
					check_variable = { which = imperial_decadence value >= 10 }
				}
			}
			add_character_modifier = {
				name = imperial_decadence_1
				duration = -1
			}
		}
	}

	option = {
		name = "OK"
	}
}

### RANDOM EVENTS

# Emperor/Regent is Just
character_event = {
	id = Plus.1855
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1855A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1855B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes # on_yearly_pulse (random_events)
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value > 0 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = { trait = just }
			NOT = { trait = arbitrary }
		}
		trigger_else = {
			trait = just
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_MINUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = -1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Arbitrary
character_event = {
	id = Plus.1856
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1856A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1856B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = { trait = arbitrary }
			NOT = { trait = just }
		}
		trigger_else = {
			trait = arbitrary
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Diligent
character_event = {
	id = Plus.1857
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1857A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1857B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value > 0 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = { trait = diligent }
			NOT = { trait = slothful }
		}
		trigger_else = {
			trait = diligent
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_MINUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = -1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Slothful
character_event = {
	id = Plus.1858
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1858A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1858B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = { trait = slothful }
			NOT = { trait = diligent }
		}
		trigger_else = {
			trait = slothful
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Hedonist
character_event = {
	id = Plus.1859
	picture = GFX_evt_brothel

	desc = {
		text = EVTDESC_Plus_1859A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1859B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { trait = hedonist }
		}
		trigger_else = {
			trait = hedonist
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Cruel/Impaler
character_event = {
	id = Plus.1860
	picture = GFX_evt_brothel

	desc = {
		text = EVTDESC_Plus_1860A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1860B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = {
				OR = {
					trait = cruel
					trait = impaler
				}
			}

			NOT = { trait = kind }
		}
		trigger_else = {
			OR = {
				trait = cruel
				trait = impaler
			}
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Quick/Genius
character_event = {
	id = Plus.1861
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1861A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1861B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value > 0 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { is_smart_trigger = yes }
		}
		trigger_else = {
			is_smart_trigger = yes
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0

			trait = genius
			has_regent = no
		}

		mult_modifier = {
			factor = 2.0

			has_regent = yes
			regent = { trait = genius }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_MINUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = -1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Inbred/Imbecile/Slow
character_event = {
	id = Plus.1862
	picture = GFX_evt_throne_room

	desc = {
		text = EVTDESC_Plus_1862A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1862B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }

			regent = {
				OR = {
					is_dumb_trigger = yes
					trait = inbred
				}
			}
		}
		trigger_else = {
			OR = {
				is_dumb_trigger = yes
				trait = inbred
			}
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0

			trait = imbecile
			has_regent = no
		}

		mult_modifier = {
			factor = 2.0

			has_regent = yes
			regent = { trait = imbecile }
		}

		mult_modifier = {
			factor = 1.5

			trait = inbred
			has_regent = no
		}

		mult_modifier = {
			factor = 1.5

			has_regent = yes
			regent = { trait = inbred }
		}

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor is Incapable
character_event = {
	id = Plus.1863
	picture = GFX_evt_throne_room
	desc = EVTDESC_Plus_1863

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		is_incapable = yes
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }
		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Drunkard
character_event = {
	id = Plus.1864
	picture = GFX_evt_dancing

	desc = {
		text = EVTDESC_Plus_1864A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1864B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { trait = drunkard }
		}
		trigger_else = {
			trait = drunkard
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Lunatic
character_event = {
	id = Plus.1865
	picture = GFX_evt_lunatic

	desc = {
		text = EVTDESC_Plus_1865A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1865B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { trait = lunatic }
		}
		trigger_else = {
			trait = lunatic
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Possessed
character_event = {
	id = Plus.1866
	picture = GFX_evt_lunatic

	desc = {
		text = EVTDESC_Plus_1866A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1866B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { trait = possessed }
		}
		trigger_else = {
			trait = possessed
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 1.5

			has_character_modifier = voice_of_jesus
			has_regent = no
		}

		mult_modifier = {
			factor = 1.5

			has_regent = yes
			regent = { has_character_modifier = voice_of_jesus }
		}

		mult_modifier = {
			factor = 2.0

			has_character_modifier = voice_of_satan
			has_regent = no
		}

		mult_modifier = {
			factor = 2.0

			has_regent = yes
			regent = { has_character_modifier = voice_of_satan }
		}

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor/Regent is Depressed
character_event = {
	id = Plus.1867
	picture = GFX_evt_bad_news

	desc = {
		text = EVTDESC_Plus_1867A
		trigger = { ROOT = { has_regent = no } }
	}
	desc = {
		text = EVTDESC_Plus_1867B
		trigger = { ROOT = { has_regent = yes } }
	}

	is_triggered_only = yes
	major = yes

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	only_independent = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }

		trigger_if = {
			limit = { has_regent = yes }
			regent = { trait = depressed }
		}
		trigger_else = {
			trait = depressed
		}

		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			has_regent = yes
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor is a prisoner
character_event = {
	id = Plus.1868
	picture = GFX_evt_into_the_dungeon
	desc = EVTDESC_Plus_1868

	is_triggered_only = yes
	major = yes

	only_independent = yes
	prisoner = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }
		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor has a capable Steward
character_event = {
	id = Plus.1869
	desc = EVTDESC_Plus_1869
	picture = GFX_evt_throne_room

	is_triggered_only = yes
	major = yes

	only_independent = yes

	trigger = {
		higher_real_tier_than = KING
		primary_title = { check_variable = { which = imperial_decadence value >= 1 } }
		job_treasurer = { stewardship >= 15 }
		realm_stewardship >= 30
		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 1.5
			job_treasurer = { stewardship >= 20 }
		}

		mult_modifier = {
			factor = 1.5
			job_treasurer = { stewardship >= 25 }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_MINUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = -1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Emperor has a lousy Steward
character_event = {
	id = Plus.1870
	desc = EVTDESC_Plus_1870
	picture = GFX_evt_throne_room

	is_triggered_only = yes
	major = yes

	only_rulers = yes

	trigger = {
		real_tier = EMPEROR
		primary_title = { check_variable = { which = imperial_decadence value < 100 } }
		job_treasurer = { stewardship < 10 }
		is_ironman = no
		is_tribal = no
		is_nomadic = no
		uses_decadence = no
		NOT = { has_character_modifier = decadence_event_timer }
	}

	major_trigger = {
		ai = no
		same_realm = ROOT
	}

	weight_multiplier = {
		days = 1

		mult_modifier = {
			factor = 1.5
			job_treasurer = { stewardship < 8 }
		}

		mult_modifier = {
			factor = 1.5
			job_treasurer = { stewardship < 5 }
		}

		mult_modifier = {
			factor = 2.0
			primary_title = { check_variable = { which = imperial_decadence value < 10 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 30 } }
		}

		mult_modifier = {
			factor = 0.75
			primary_title = { check_variable = { which = imperial_decadence value >= 60 } }
		}

		mult_modifier = {
			factor = 0.5
			primary_title = { check_variable = { which = imperial_decadence value >= 90 } }
		}
	}

	option = {
		name = OK

		custom_tooltip = {
			text = IMPERIAL_DECADENCE_PLUS_1

			if = {
				limit = { character = ROOT }

				primary_title = {
					change_variable = {
						which = imperial_decadence
						value = 1
					}
				}

				character_event = { id = Plus.1852 } # change the decadence modifier

				add_character_modifier = {
					name = decadence_event_timer
					years = 5
					hidden = yes
				}
			}
		}
	}
}

# Grant Imperial Title
character_event = {
	id = Plus.1871
	desc = EVTDESC_Plus_1871
	picture = GFX_evt_imperial_court

	is_triggered_only = yes

	immediate = {
		random_demesne_title = {
			limit = {
				real_tier = EMPEROR
				is_primary_holder_title = no
				temporary = no
			}

			save_event_target_as = secondary_title_target
		}

		clr_character_flag = must_grant_empire_flag
	}

	option = { # Give my primary title
		name = EVTOPTA_Plus_1871

		primary_title = {
			show_scope_change = no

			grant_title = FROM
		}

		make_tributary = {
			who = FROM
			tributary_type = imperial
		}
	}

	option = { # Give second title
		name = EVTOPTB_Plus_1871

		event_target:secondary_title_target = {
			show_scope_change = no

			grant_title = FROM
		}

		make_tributary = {
			who = FROM
			tributary_type = imperial
		}
	}

	option = {
		name = NEVERMIND

		set_character_flag = must_grant_empire_flag
	}
}

# Make capital kingdom de jure to empire if kingdom entirely controled
# ROOT is the creating character
# FROM is the title
character_event = {
	id = Plus.1872

	is_triggered_only = yes # on_create_title
	hide_window = yes

	trigger = {
		FROM = { real_tier = EMPEROR }
		num_of_emperor_titles >= 1

		capital_scope = {
			kingdom = {
				is_titular = no
				ROOT = { completely_controls = PREV }
			}
		}
	}

	immediate = {
		capital_scope = {
			kingdom = {
				de_jure_liege = FROM
			}
		}
	}
}