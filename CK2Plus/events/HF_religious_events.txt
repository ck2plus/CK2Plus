# Written by Flavio

namespace = HF
namespace = HFP

# Ritual Sacrifice Prisoner
character_event = {
	id = HF.23001
	desc = EVTDESCHF23001
	picture = GFX_evt_pagan_blood_sacrifice
	border = GFX_event_normal_frame_war

	is_triggered_only = yes # vassal_generic_sacrifice_decision, HF_religious_decisions.txt

	ai = no

	option = {
		name = EVTOPTAHF23001
	}
}

# Ritual Sacrifice Prisoner (Jailer's perspective)
character_event = {
	id = HF.23002
	border = GFX_event_normal_frame_war

	desc = {
		text = EVTDESCHF23002
		trigger = {
			NOR = {
				trait = bloodthirsty_gods_1
				trait = bloodthirsty_gods_2
				trait = bloodthirsty_gods_3

				any_realm_wonder_upgrade = {
					has_wonder_upgrade = upgrade_sacrificial_altar
					is_active = yes
				}
			}
		}
	}
	desc = {
		text = EVTDESCHF23002_B # Do it yourself
		trigger = {
			OR = {
				trait = bloodthirsty_gods_1
				trait = bloodthirsty_gods_2
				trait = bloodthirsty_gods_3
			}

			NOT = {
				any_realm_wonder_upgrade = {
					has_wonder_upgrade = upgrade_sacrificial_altar
					is_active = yes
				}
			}
		}
	}
	desc = {
		text = EVTDESCHF23002_C
		trigger = {
			NOR = {
				trait = bloodthirsty_gods_1
				trait = bloodthirsty_gods_2
				trait = bloodthirsty_gods_3
			}

			any_realm_wonder_upgrade = {
				has_wonder_upgrade = upgrade_sacrificial_altar
				is_active = yes
			}
		}
	}
	desc = {
		text = EVTDESCHF23002_D # Do it yourself
		trigger = {
			OR = {
				trait = bloodthirsty_gods_1
				trait = bloodthirsty_gods_2
				trait = bloodthirsty_gods_3
			}

			any_realm_wonder_upgrade = {
				has_wonder_upgrade = upgrade_sacrificial_altar
				is_active = yes
			}
		}
	}

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes #  # vassal_generic_sacrifice_decision, HF_religious_decisions.txt

	immediate = {
		random_realm_wonder_upgrade = {
			limit = {
				has_wonder_upgrade = upgrade_sacrificial_altar
				is_active = yes
			}

			save_event_target_as = the_sacrificial_altar
			wonder = { save_event_target_as = the_temple }
		}
	}

	option = {
		name = EVTOPTAHF23002

		if = {
			limit = {
				any_realm_wonder_upgrade = {
					has_wonder_upgrade = upgrade_sacrificial_altar
					is_active = yes
				}
			}

			prestige = 10
		}
	}

	option = {
		name = EVTOPTBHF23002
		tooltip_info_custom = EVTOPTBHF23002_TT

		trigger = {
			any_realm_wonder_upgrade = {
				has_wonder_upgrade = upgrade_sacrificial_altar
				is_active = yes
			}
		}

		add_character_modifier = {
			name = ate_beating_heart
			months = 6
		}
	}

	after = {
		if = {
			limit = { FROM = { is_ruler = no } }
			piety = 5
		}
		else_if = {
			limit = { FROM = { real_tier = BARON } }
			piety = 15
		}
		else_if = {
			limit = { FROM = { real_tier = COUNT } }
			piety = 30
		}
		else_if = {
			limit = { FROM = { real_tier = DUKE } }
			piety = 75
		}
		else_if = {
			limit = { FROM = { real_tier = KING } }
			piety = 150
		}
		else_if = {
			limit = { FROM = { real_tier = EMPEROR } }
			piety = 250
		}

		# Bloodthirsty Bloodline bonus
		if = {
			limit = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_prestige_sacrifice
					bloodline_is_active_for = PREV
				}
			}

			if = {
				limit = { FROM = { is_ruler = no } }
				prestige = 10
			}
			else_if = {
				limit = { FROM = { real_tier = BARON } }
				prestige = 30
			}
			else_if = {
				limit = { FROM = { real_tier = COUNT } }
				prestige = 60
			}
			else_if = {
				limit = { FROM = { real_tier = DUKE } }
				prestige = 150
			}
			else_if = {
				limit = { FROM = { real_tier = KING } }
				prestige = 300
			}
			else_if = {
				limit = { FROM = { real_tier = EMPEROR } }
				prestige = 500
			}
		}
	}
}

# Syncretic rulers can pick a random sympathy (Player only)
character_event = {
	id = HF.23003
	desc = EVTDESCHF23003
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # syncretic_sympathy_decision, HF_religious_decisions.txt

	option = { # Christianity
		name = {
			text = EVTOPTAHF23003
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTAHF23003_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = christian } # Random World safety check
		}

		add_trait = sympathy_christendom
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 0.25

				spouse = {
					OR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = christian
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = christian }
			}
		}
	}

	option = { # Islam
		name = {
			text = EVTOPTBHF23003
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTBHF23003_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = muslim } # Random World safety check
		}

		add_trait = sympathy_islam
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_christendom
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_christendom
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 0.25

				spouse = {
					OR = {
						trait = sympathy_christendom
						trait = sympathy_zoroastrianism
						trait = sympathy_judaism
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = muslim
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = muslim }
			}
		}
	}

	option = { # Jews
		name = {
			text = EVTOPTCHF23003
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTCHF23003_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = jewish_group } # Random World safety check
		}

		add_trait = sympathy_judaism
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_christendom
						trait = sympathy_indian
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_christendom
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 0.25

				spouse = {
					OR = {
						trait = sympathy_islam
						trait = sympathy_zoroastrianism
						trait = sympathy_christendom
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = jewish_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = jewish_group }
			}
		}
	}

	option = { # Others
		name = {
			text = EVTOPTDHF23003
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTDHF23003_ALT
			trigger = { is_alternate_start = yes }
		}

		character_event = { id = HF.23004 }

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_judaism
						trait = sympathy_christendom
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_islam
						trait = sympathy_judaism
						trait = sympathy_christendom
					}
				}
			}

			mult_modifier = {
				factor = 0.25

				spouse = {
					OR = {
						trait = sympathy_islam
						trait = sympathy_judaism
						trait = sympathy_christendom
					}
				}
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = indian_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = indian_group }
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = zoroastrian_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = zoroastrian_group }
			}
		}
	}
}

# Second sympathy list
character_event = {
	id = HF.23004
	desc = EVTDESCHF23004
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # Zoroastrians
		name = {
			text = EVTOPTAHF23004
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTAHF23004_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = zoroastrian_group } # Random World safety check
		}

		add_trait = sympathy_zoroastrianism
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_indian
						trait = sympathy_pagans
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_indian
						trait = sympathy_pagans
					}
				}
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_indian }
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_pagans }
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = zoroastrian_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = zoroastrian_group }
			}
		}
	}

	option = { # Indians
		name = {
			text = EVTOPTBHF23004
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTBHF23004_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = indian_group } # Random World safety check
		}

		add_trait = sympathy_indian
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_zoroastrianism
						trait = sympathy_pagans
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_zoroastrianism
						trait = sympathy_pagans
					}
				}
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_zoroastrianism }
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_pagans }
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = zoroastrian_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = zoroastrian_group }
			}
		}
	}

	option = { # Pagans - Just for Random World
		name = {
			text = EVTOPTCHF23004
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTCHF23004_ALT
			trigger = { is_alternate_start = yes }
		}

		trigger = {
			NOT = { religion_group = pagan_group } # Random World safety check
		}

		add_trait = sympathy_pagans
		clr_character_flag = flag_picking_sympathy

		ai_chance = {
			factor = 25

			trigger = {
				liege = {
					NOR = {
						trait = sympathy_zoroastrianism
						trait = sympathy_indian
					}
				}

				top_liege = {
					NOR = {
						trait = sympathy_zoroastrianism
						trait = sympathy_indian
					}
				}
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_zoroastrianism }
			}

			mult_modifier = {
				factor = 0.25
				spouse = { trait = sympathy_indian }
			}

			mult_modifier = {
				factor = 1.5

				any_demesne_province = {
					religion_group = pagan_group
					owned_by = PREV
				}
			}

			mult_modifier = {
				factor = 1.5
				any_courtier_or_vassal = { religion_group = pagan_group }
			}
		}
	}

	option = { # Return
		name = {
			text = EVTOPTDHF23004
			trigger = { is_alternate_start = no }
		}
		name = {
			text = EVTOPTDHF23004_ALT
			trigger = { is_alternate_start = yes }
		}

		character_event = { id = HF.23003 }

		ai_chance = { factor = 0 }
	}
}

#############################################################

## Divination: on war started, chance to divine outcome
# Hidden ping to select haruspex
character_event = {
	id = HF.23005

	is_triggered_only = yes # fire_haruspicy_event_effect, 00_cb_effects.txt
	hide_window = yes

	trigger = {
		OR = {
			has_religion_feature = religion_haruspicy
			has_religion_feature = religion_feature_celtic
			religion_openly_hellenic_or_reformed_trigger = yes
		}

		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}

		# Do not fire for minor peasant uprisings
		any_war = {
			NOR = {
				attacker = { using_cb = peasant_revolt }
				defender = { using_cb = peasant_revolt }
			}
		}
	}

	immediate = {
		if = {
			limit = {
				any_realm_character = {
					is_theocracy = yes
					religion = ROOT
				}
			}

			any_realm_character = {
				limit = {
					is_theocracy = yes
					religion = ROOT
				}

				score_value = {
					value = 10

					interesting_courtier_selection_score = yes

					additive_modifier = {
						value = 10000

						has_job_title = job_spiritual
						religion = liege
						vassal_of = ROOT
					}
				}

				character_event = { id = HF.23006 }
			}
		}
		else = {
			set_character_flag = flag_cheap_diviner
			character_event = { id = HF.23007 }
		}
	}
}

# Hidden ping on diviner
character_event = {
	id = HF.23006

	is_triggered_only = yes
	hide_window = yes

	trigger = {
		OR = {
			has_religion_feature = religion_haruspicy
			has_religion_feature = religion_feature_celtic
			religion_openly_hellenic_or_reformed_trigger = yes
		}

		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}
	}

	immediate = {
		FROM = {
			character_event = {
				id = HF.23007
				days = 7
				random = 7
			}
		}
	}
}

character_event = {
	id = HF.23007
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23007
		trigger = {
			FROM = {
				is_alive = yes
				NOT = { character = ROOT }
			}
		}
	}
	desc = { # Generic desc if priest dies in between or there was no priest available
		text = EVTDESCBHF23007
		trigger = {
			FROM = {
				OR = {
					character = ROOT
					is_alive = no
				}
			}
		}
	}

	is_triggered_only = yes

	war = yes

	trigger = {
		OR = {
			has_religion_feature = religion_haruspicy
			has_religion_feature = religion_feature_celtic
			religion_openly_hellenic_or_reformed_trigger = yes
		}

		NOR = {
			has_character_modifier = divination_crit_success
			has_character_modifier = divination_success
			has_character_modifier = divination_failure
			has_character_modifier = divination_crit_failure
		}
	}

	immediate = {
		if = {
			limit = { FROM = { is_alive = no } }
			set_character_flag = flag_cheap_diviner # Prevents crit success, increases crit failure
		}

		if = {
			limit = { has_religion_feature = religion_ritual_sacrifice }

			random_courtier = {
				limit = {
					NOR = {
						dynasty = ROOT
						has_job_title = job_spiritual
						is_ruler = yes
						is_married = ROOT
						is_close_relative = ROOT
						is_lover = ROOT
						is_friend = ROOT
					}
				}

				preferred_limit = {
					is_unimportant_trigger = yes
				}

				save_event_target_as = potential_victim
			}
		}

		# Safety cleanup
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
		clr_character_flag = flag_sacrificing_human
	}

	# Great Bull
	# Cow
	# Goat
	# Chicken

	option = { # Human - Ensure no Critical Fail - Unlocks Critical success - Only if also Bloodthirsty Gods
		name = EVTOPTZHF23007

		trigger = {
			has_religion_feature = religion_ritual_sacrifice
			event_target:potential_victim = { always = yes }
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1
				min = -200
				max = -400
			}
		}

		event_target:potential_victim = {
			show_scope_change = no

			death = {
				death_reason = death_execution_aztec_sacrifice
				killer = ROOT
			}
		}

		set_character_flag = flag_sacrificing_human

		ai_chance = {
			factor = 60

			trigger = {
				NOT = { trait = greedy }
			}

			mult_modifier = {
				factor = 0.1
				trait = cynical
			}

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}

			mult_modifier = {
				factor = 0.1
				wealth < 300
			}
		}
	}

	option = { # Great bull - Ensure no Critical Fail - Unlocks Critical success
		name = EVTOPTAHF23007

		trigger = {
			NOT = { has_religion_feature = religion_ritual_sacrifice }
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1
				min = -175
				max = -500
			}
		}

		set_character_flag = flag_sacrificing_bull

		ai_chance = {
			factor = 60

			trigger = {
				NOT = { trait = greedy }
			}

			mult_modifier = {
				factor = 0.1
				trait = cynical
			}

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}

			mult_modifier = {
				factor = 0.1
				wealth < 300
			}
		}
	}

	option = { # Cow - Unlocks critical success
		name = EVTOPTBHF23007

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.75
				min = -50
				max = -130
			}
		}

		set_character_flag = flag_sacrificing_cow

		ai_chance = {
			factor = 30

			mult_modifier = {
				factor = 0.5
				trait = greedy
			}

			mult_modifier = {
				factor = 0.75
				trait = cynical
			}

			mult_modifier = {
				factor = 1.25
				trait = zealous
			}

			mult_modifier = {
				factor = 0.1
				wealth < 100
			}
		}
	}

	option = { # Goat
		name = EVTOPTCHF23007

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -30
				max = -75
			}
		}

		set_character_flag = flag_sacrificing_goat

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 0.75
				trait = zealous
			}
		}
	}

	option = { # Chicken
		name = EVTOPTDHF23007

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.1
				min = -5
				max = -30
			}
		}

		set_character_flag = flag_sacrificing_chicken

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 0.5
				trait = zealous
			}

			mult_modifier = {
				factor = 0.5
				trait = charitable
			}
		}
	}

	after = {
		hidden_effect = {
			random_list = {
				20 = {
					trigger = {
						OR = {
							has_character_flag = flag_sacrificing_bull
							has_character_flag = flag_sacrificing_human
						}

						NOT = { has_character_flag = flag_cheap_diviner }
					}

					mult_modifier = {
						factor = 0.7
						trait = cynical
					}

					mult_modifier = {
						factor = 1.5
						trait = zealous
					}

					mult_modifier = {
						factor = 0.7
						piety < -150
					}

					mult_modifier = {
						factor = 0.8
						piety < -100
					}

					mult_modifier = {
						factor = 0.8
						piety < -50
					}

					mult_modifier = {
						factor = 0.8
						piety < 0
					}

					mult_modifier = {
						factor = 1.15
						piety >= 30
					}

					mult_modifier = {
						factor = 1.15
						piety >= 40
					}

					mult_modifier = {
						factor = 1.15
						piety >= 50
					}

					mult_modifier = {
						factor = 1.15
						piety >= 70
					}

					mult_modifier = {
						factor = 1.15
						piety >= 100
					}

					mult_modifier = {
						factor = 1.25
						piety >= 150
					}

					mult_modifier = {
						factor = 1.25
						piety >= 250
					}

					mult_modifier = {
						factor = 1.5
						piety >= 350
					}

					mult_modifier = {
						factor = 1.5
						piety >= 450
					}

					mult_modifier = {
						factor = 1.5
						piety >= 550
					}

					mult_modifier = {
						factor = 0.6
						FROM = { learning < 3 }
					}

					mult_modifier = {
						factor = 0.7
						FROM = { learning < 4 }
					}

					mult_modifier = {
						factor = 0.8
						FROM = { learning < 6 }
					}

					mult_modifier = {
						factor = 0.8
						FROM = { learning < 8 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 10 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 12 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 14 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 16 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 18 }
					}

					mult_modifier = {
						factor = 1.15
						FROM = { learning >= 20 }
					}

					mult_modifier = {
						factor = 1.25
						FROM = { learning >= 25 }
					}

					mult_modifier = {
						factor = 1.35
						FROM = { learning >= 30 }
					}

					# But, more importantly, does the divine like you?

					mult_modifier = {
						factor = 0.75

						reverse_opinion = {
							who = FROM
							value < -80
						}
					}

					mult_modifier = {
						factor = 0.75

						reverse_opinion = {
							who = FROM
							value < -60
						}
					}

					mult_modifier = {
						factor = 0.75

						reverse_opinion = {
							who = FROM
							value < -40
						}
					}

					mult_modifier = {
						factor = 0.85

						reverse_opinion = {
							who = FROM
							value < -20
						}
					}

					mult_modifier = {
						factor = 0.85

						reverse_opinion = {
							who = FROM
							value < 0
						}
					}

					mult_modifier = {
						factor = 1.15

						reverse_opinion = {
							who = FROM
							value >= 20
						}
					}

					mult_modifier = {
						factor = 1.25

						reverse_opinion = {
							who = FROM
							value >= 40
						}
					}

					mult_modifier = {
						factor = 1.25

						reverse_opinion = {
							who = FROM
							value >= 60
						}
					}

					mult_modifier = {
						factor = 1.35

						reverse_opinion = {
							who = FROM
							value >= 80
						}
					}

					mult_modifier = {
						factor = 1.45

						reverse_opinion = {
							who = FROM
							value >= 90
						}
					}

					character_event = { id = HF.23008 } # Crit success
				}

				50 = {
					mult_modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_human
					}

					mult_modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_bull
					}

					mult_modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_goat
					}

					mult_modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_chicken
					}

					mult_modifier = {
						factor = 0.8
						has_character_flag = flag_cheap_diviner
					}

					mult_modifier = {
						factor = 0.7
						trait = cynical
					}

					mult_modifier = {
						factor = 1.5
						trait = zealous
					}

					mult_modifier = {
						factor = 0.8
						piety < -150
					}

					mult_modifier = {
						factor = 0.9
						piety < -100
					}

					mult_modifier = {
						factor = 0.9
						piety < -50
					}

					mult_modifier = {
						factor = 0.9
						piety < 0
					}

					mult_modifier = {
						factor = 0.7
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning < 3 }
					}

					mult_modifier = {
						factor = 0.8
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning < 4 }
					}

					mult_modifier = {
						factor = 0.9
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning < 6 }
					}

					mult_modifier = {
						factor = 0.9
						NOT = { has_character_flag = flag_cheap_diviner }
						FROM = { learning < 8 }
					}

					# But, more importantly, does the divine like you?
					mult_modifier = {
						factor = 0.85

						NOT = { has_character_flag = flag_cheap_diviner }

						reverse_opinion = {
							who = FROM
							value < -80
						}
					}

					mult_modifier = {
						factor = 0.85

						NOT = { has_character_flag = flag_cheap_diviner }

						reverse_opinion = {
							who = FROM
							value < -60
						}
					}

					mult_modifier = {
						factor = 0.85

						NOT = { has_character_flag = flag_cheap_diviner }

						reverse_opinion = {
							who = FROM
							value < -40
						}
					}

					mult_modifier = {
						factor = 0.95

						NOT = { has_character_flag = flag_cheap_diviner }

						reverse_opinion = {
							who = FROM
							value < -20
						}
					}

					mult_modifier = {
						factor = 0.95

						NOT = { has_character_flag = flag_cheap_diviner }

						reverse_opinion = {
							who = FROM
							value < 0
						}
					}

					character_event = { id = HF.23009 } # Success
				}

				30 = {
					mult_modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_human
					}

					mult_modifier = {
						factor = 0.7
						has_character_flag = flag_sacrificing_bull
					}

					mult_modifier = {
						factor = 0.8
						has_character_flag = flag_sacrificing_cow
					}

					character_event = { id = HF.23010 } # Failure
				}

				5 = {
					trigger = {
						NOR = {
							has_character_flag = flag_sacrificing_bull
							has_character_flag = flag_sacrificing_human
						}
					}

					mult_modifier = {
						factor = 0.5
						has_character_flag = flag_sacrificing_cow
					}

					character_event = { id = HF.23011 } # Crit failure
				}
			}
		}
	}
}

# Divination: Critical success
character_event = {
	id = HF.23008
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCZHF23008
		trigger = { has_character_flag = flag_sacrificing_human }
	}
	desc = {
		text = EVTDESCAHF23008
		trigger = { has_character_flag = flag_sacrificing_bull }
	}
	desc = {
		text = EVTDESCBHF23008
		trigger = { has_character_flag = flag_sacrificing_cow }
	}
	desc = {
		text = EVTDESCCHF23008
		trigger = { has_character_flag = flag_sacrificing_goat }
	}
	desc = {
		text = EVTDESCDHF23008
		trigger = { has_character_flag = flag_sacrificing_chicken }
	}

	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = EVTOPTAHF23008

		add_character_modifier = {
			name = divination_crit_success
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}

# Divination: Success
character_event = {
	id = HF.23009
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCZHF23009
		trigger = { has_character_flag = flag_sacrificing_human }
	}
	desc = {
		text = EVTDESCAHF23009
		trigger = { has_character_flag = flag_sacrificing_bull }
	}
	desc = {
		text = EVTDESCBHF23009
		trigger = { has_character_flag = flag_sacrificing_cow }
	}
	desc = {
		text = EVTDESCCHF23009
		trigger = { has_character_flag = flag_sacrificing_goat }
	}
	desc = {
		text = EVTDESCDHF23009
		trigger = { has_character_flag = flag_sacrificing_chicken }
	}

	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = EVTOPTAHF23009

		add_character_modifier = {
			name = divination_success
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}

# Divination: Failure
character_event = {
	id = HF.23010
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCZHF23010
		trigger = { has_character_flag = flag_sacrificing_human }
	}
	desc = {
		text = EVTDESCAHF23010
		trigger = { has_character_flag = flag_sacrificing_bull }
	}
	desc = {
		text = EVTDESCBHF23010
		trigger = { has_character_flag = flag_sacrificing_cow }
	}
	desc = {
		text = EVTDESCCHF23010
		trigger = { has_character_flag = flag_sacrificing_goat }
	}
	desc = {
		text = EVTDESCDHF23010
		trigger = { has_character_flag = flag_sacrificing_chicken }
	}

	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = EVTOPTXHF23010
		tooltip_info = learning

		trigger = { learning >= 15 }

		tiered_piety_negative_effect = yes

		add_character_modifier = {
			name = divination_success
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}

	option = {
		name = UNFORTUNATE

		add_character_modifier = {
			name = divination_failure
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}

# Divination: Critical Failure
character_event = {
	id = HF.23011
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCZHF23011
		trigger = { has_character_flag = flag_sacrificing_human }
	}
	desc = {
		text = EVTDESCAHF23011
		trigger = { has_character_flag = flag_sacrificing_bull }
	}
	desc = {
		text = EVTDESCBHF23011
		trigger = { has_character_flag = flag_sacrificing_cow }
	}
	desc = {
		text = EVTDESCCHF23011
		trigger = { has_character_flag = flag_sacrificing_goat }
	}
	desc = {
		text = EVTDESCDHF23011
		trigger = { has_character_flag = flag_sacrificing_chicken }
	}

	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = EVTOPTXHF23011
		tooltip_info = learning

		trigger = { learning >= 15 }

		tiered_piety_negative_effect = yes

		add_character_modifier = {
			name = divination_failure
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}

	option = {
		name = EVTOPTZHF23011
		tooltip_info = cynical

		trigger = { trait = cynical }

		scaled_wealth = {
			value = -0.75
			min = -100
			max = -250
		}

		tiered_piety_negative_effect = yes

		add_character_modifier = {
			name = divination_failure
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}

	option = {
		name = EVTOPTAHF23011

		add_character_modifier = {
			name = divination_crit_failure
			duration = -1
		}

		clr_character_flag = flag_cheap_diviner
		clr_character_flag = flag_sacrificing_human
		clr_character_flag = flag_sacrificing_bull
		clr_character_flag = flag_sacrificing_cow
		clr_character_flag = flag_sacrificing_goat
		clr_character_flag = flag_sacrificing_chicken
	}
}

# Divination: Cleanup event on war over
character_event = {
	id = HF.23012

	is_triggered_only = yes # on_war_ended_victory/whitepeace/defeat/invalid
	hide_window = yes

	immediate = {
		character_event = {
			id = HF.23013
			days = 1
		}
	}
}

# Divination: Cleanup event on war over
character_event = {
	id = HF.23013

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		if = {
			limit = {
				war = no # Maintain modifier if embroiled in multiple wars

				OR = {
					has_character_modifier = divination_crit_success
					has_character_modifier = divination_success
					has_character_modifier = divination_failure
					has_character_modifier = divination_crit_failure
				}
			}

			remove_character_modifier = divination_crit_success
			remove_character_modifier = divination_success
			remove_character_modifier = divination_failure
			remove_character_modifier = divination_crit_failure
		}

		FROMFROM = {
			if = {
				limit = {
					war = no # Maintain modifier if embroiled in multiple wars

					OR = {
						has_character_modifier = divination_crit_success
						has_character_modifier = divination_success
						has_character_modifier = divination_failure
						has_character_modifier = divination_crit_failure
					}
				}

				remove_character_modifier = divination_crit_success
				remove_character_modifier = divination_success
				remove_character_modifier = divination_failure
				remove_character_modifier = divination_crit_failure
			}
		}
	}
}

# HF.23014 - HF.23015

# Pick a Pagan religious branch when having a headless reformed pagan religion
character_event = {
	id = HF.23016
	desc = EVTDESCHF23016
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # on_adulthood, pagan_branch_decision, 670 (on_reform_religion)

	religion_group = pagan_group

	trigger = {
		has_religion_feature = religion_no_leader

		NOR = {
			trait = pagan_branch_1
			trait = pagan_branch_2
			trait = pagan_branch_3
			trait = pagan_branch_4
		}
	}

	option = {
		name = EVTOPTAHF23016

		trigger = {
			NOT = { has_religion_feature = religion_dogmatic }
		}

		add_trait = pagan_branch_1

		ai_chance = {
			factor = 5

			mult_modifier = {
				factor = 0.1
				has_religion_feature = religion_jizya
			}
		}
	}

	option = {
		name = EVTOPTBHF23016

		add_trait = pagan_branch_2

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5

				OR = {
					trait = scholar
					trait = theologian
					trait = mystic
					trait = zealous
					has_focus = focus_scholarship
					has_focus = focus_theology
					has_education_learning_trigger = yes
				}
			}

			mult_modifier = {
				factor = 0.5

				OR = {
					trait = lustful
					trait = hedonist
					trait = gluttonous
					trait = drunkard
					has_focus = focus_seduction
					has_focus = focus_carousing
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23016

		add_trait = pagan_branch_3

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				OR = {
					trait = duelist
					trait = hunter
					trait = strategist
					trait = zealous
					has_focus = focus_war
					has_focus = focus_hunting
					has_education_martial_trigger = yes
				}
			}

			mult_modifier = {
				factor = 0.5

				OR = {
					trait = craven
					trait = paranoid
					trait = shy
				}
			}
		}
	}

	option = {
		name = EVTOPTDHF23016

		add_trait = pagan_branch_4

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5

				OR = {
					any_child = {
						is_adult = no
						count >= 3
					}

					has_focus = focus_family
					has_focus = focus_carousing
					has_education_diplomacy_trigger = yes
				}
			}
		}
	}

	after = {
		clr_character_flag = flag_picking_branch
	}
}

# Switch pagan religious branch
character_event = {
	id = HF.23017
	desc = EVTDESCHF23017
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23017

		trigger = {
			NOT = { trait = pagan_branch_1 }
		}

		trigger_switch = {
			on_trigger = trait

			pagan_branch_2 = { remove_trait = pagan_branch_2 }
			pagan_branch_3 = { remove_trait = pagan_branch_3 }
			pagan_branch_4 = { remove_trait = pagan_branch_4 }
		}

		add_trait = pagan_branch_1
	}

	option = {
		name = EVTOPTBHF23017

		trigger = {
			NOT = { trait = pagan_branch_2 }
		}

		trigger_switch = {
			on_trigger = trait

			pagan_branch_1 = { remove_trait = pagan_branch_1 }
			pagan_branch_3 = { remove_trait = pagan_branch_3 }
			pagan_branch_4 = { remove_trait = pagan_branch_4 }
		}

		add_trait = pagan_branch_2
	}

	option = {
		name = EVTOPTCHF23017

		trigger = {
			NOT = { trait = pagan_branch_3 }
		}

		trigger_switch = {
			on_trigger = trait

			pagan_branch_1 = { remove_trait = pagan_branch_1 }
			pagan_branch_2 = { remove_trait = pagan_branch_2 }
			pagan_branch_4 = { remove_trait = pagan_branch_4 }
		}

		add_trait = pagan_branch_3
	}

	option = {
		name = EVTOPTDHF23017

		trigger = {
			NOT = { trait = pagan_branch_4 }
		}

		trigger_switch = {
			on_trigger = trait

			pagan_branch_1 = { remove_trait = pagan_branch_1 }
			pagan_branch_2 = { remove_trait = pagan_branch_2 }
			pagan_branch_3 = { remove_trait = pagan_branch_3 }
		}

		add_trait = pagan_branch_4
	}

	after = {
		clr_character_flag = flag_picking_branch
	}
}

#######################
# Dralha's Children
#######################
# Notification event
narrative_event = {
	id = HF.23018
	title = d_dralhas_children
	desc = EVTDESCHF23018
	picture = GFX_evt_throne_room_indo_aryan_group

	is_triggered_only = yes
	hide_from = yes

	option = {
		name = {
			text = EVTOPTA_HO_100
			trigger = { religion = bon_pagan_reformed }
		}
		name = {
			text = EVTOPTB_HO_100
			trigger = {
				religion_group = indian_group
				NOT = { religion = bon_pagan_reformed }
			}
		}
		name = {
			text = EVTOPTC_HO_100
			trigger = {
				NOR = {
					religion_group = indian_group
					religion = bon_pagan_reformed
				}
			}
		}
	}
}

#######################
# Zodiac Signs - Hellenic Flavor
#######################
# on_birth event assigns traits on hellenic child.
character_event = {
	id = HF.23019

	is_triggered_only = yes # on_birth
	hide_window = yes

	trigger = {
		OR = {
			religion_openly_hellenic_or_reformed_trigger = yes
			has_religion_feature = religion_astrology
		}
	}

	immediate = {
		add_western_zodiac_trait_effect = yes # Updated effect
	}
}

# on_adolescence: chance for child to be either inclined to abandon the sign or embrace it.
# Follows an event for the Guardian to give his opinion on the matter.

# Child: hidden event for delay
character_event = {
	id = HF.23020

	is_triggered_only = yes # on_adolescence
	hide_window = yes

	trigger = {
		has_any_astrology_trait_trigger = yes
	}

	immediate = {
		character_event = {
			id = HF.23021
			days = 40
			random = 120
		}
	}
}

# Astrology: The child thinks about his sign
character_event = {
	id = HF.23021
	desc = EVTDESCAHF23021
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23021

		set_character_flag = flag_child_embracing_zodiac

		ai_chance = {
			factor = 50

			mult_modifier = {
				factor = 0.5
				trait = cynical
			}

			mult_modifier = {
				factor = 0.5
				trait = haughty
			}

			mult_modifier = {
				factor = 0.5
				trait = brooding
			}

			mult_modifier = {
				factor = 0.5
				trait = willful
			}
		}
	}

	option = {
		name = EVTOPTBHF23021

		set_character_flag = flag_child_forsaking_zodiac

		tooltip = {
			trigger_switch = {
				on_trigger = trait

				zodiac_aquarius = { remove_trait = zodiac_aquarius }
				zodiac_aries = { remove_trait = zodiac_aries }
				zodiac_cancer = { remove_trait = zodiac_cancer }
				zodiac_capricorn = { remove_trait = zodiac_capricorn }
				zodiac_gemini = { remove_trait = zodiac_gemini }
				zodiac_leo = { remove_trait = zodiac_leo }
				zodiac_libra = { remove_trait = zodiac_libra }
				zodiac_pisces = { remove_trait = zodiac_pisces }
				zodiac_sagittarius = { remove_trait = zodiac_sagittarius }
				zodiac_scorpio = { remove_trait = zodiac_scorpio }
				zodiac_taurus = { remove_trait = zodiac_taurus }
				zodiac_virgo = { remove_trait = zodiac_virgo }
			}
		}

		ai_chance = {
			factor = 50

			mult_modifier = {
				factor = 0.5
				trait = zealous
			}

			mult_modifier = {
				factor = 0.5
				trait = timid
			}

			mult_modifier = {
				factor = 0.5
				trait = idolizer
			}

			mult_modifier = {
				factor = 0.5
				trait = indolent
			}
		}
	}

	after = {
		hidden_effect = {
			guardian = {
				character_event = {
					id = HF.23022
					days = 40
					random = 120
				}
			}
		}
	}
}

# Guardian: is the child doing well?
character_event = {
	id = HF.23022
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23022
		trigger = {
			FROM = { has_character_flag = flag_child_embracing_zodiac }
		}
	}
	desc = {
		text = EVTDESCBHF23022
		trigger = {
			FROM = { has_character_flag = flag_child_forsaking_zodiac }
		}
	}

	is_triggered_only = yes

	option = { # Do not care
		name = EVTOPTAHF23022

		trigger = {
			NOT = { has_religion_feature = religion_astrology }
			religion_openly_hellenic_or_reformed_trigger = no
		}

		FROM = {
			show_scope_change = no

			if = {
				limit = { has_character_flag = flag_child_forsaking_zodiac }

				trigger_switch = {
					on_trigger = trait

					zodiac_aquarius = { remove_trait = zodiac_aquarius }
					zodiac_aries = { remove_trait = zodiac_aries }
					zodiac_cancer = { remove_trait = zodiac_cancer }
					zodiac_capricorn = { remove_trait = zodiac_capricorn }
					zodiac_gemini = { remove_trait = zodiac_gemini }
					zodiac_leo = { remove_trait = zodiac_leo }
					zodiac_libra = { remove_trait = zodiac_libra }
					zodiac_pisces = { remove_trait = zodiac_pisces }
					zodiac_sagittarius = { remove_trait = zodiac_sagittarius }
					zodiac_scorpio = { remove_trait = zodiac_scorpio }
					zodiac_taurus = { remove_trait = zodiac_taurus }
					zodiac_virgo = { remove_trait = zodiac_virgo }
				}
			}
		}

		ai_chance = { factor = 100 }
	}

	option = { # The child should forsake the sign
		name = { # Child was abandoning the sign already
			text = EVTOPTBHF23008_A
			trigger = {
				FROM = { has_character_flag = flag_child_forsaking_zodiac }
			}
		}
		name = { # Child was not abandoning the sign
			text = EVTOPTBHF23008_B
			trigger = {
				FROM = { has_character_flag = flag_child_embracing_zodiac }
			}
		}

		trigger = {
			OR = {
				religion_openly_hellenic_or_reformed_trigger = yes
				has_religion_feature = religion_astrology
			}
		}

		FROM = {
			show_scope_change = no

			if = {
				limit = { has_character_flag = flag_child_embracing_zodiac }
				tiered_piety_negative_effect = yes
			}

			character_event = { id = HF.23023 }

			trigger_switch = {
				on_trigger = trait

				zodiac_aquarius = { remove_trait = zodiac_aquarius }
				zodiac_aries = { remove_trait = zodiac_aries }
				zodiac_cancer = { remove_trait = zodiac_cancer }
				zodiac_capricorn = { remove_trait = zodiac_capricorn }
				zodiac_gemini = { remove_trait = zodiac_gemini }
				zodiac_leo = { remove_trait = zodiac_leo }
				zodiac_libra = { remove_trait = zodiac_libra }
				zodiac_pisces = { remove_trait = zodiac_pisces }
				zodiac_sagittarius = { remove_trait = zodiac_sagittarius }
				zodiac_scorpio = { remove_trait = zodiac_scorpio }
				zodiac_taurus = { remove_trait = zodiac_taurus }
				zodiac_virgo = { remove_trait = zodiac_virgo }
			}
		}

		ai_chance = {
			factor = 20

			mult_modifier = {
				factor = 0.5
				trait = zealous
			}

			mult_modifier = {
				factor = 0.5
				trait = scholar
			}

			mult_modifier = {
				factor = 0.5
				trait = mystic
			}
		}
	}

	option = { # The child should embrace the sign
		name = { # Child was abandoning the sign already
			text = EVTOPTCHF23008_A
			trigger = {
				FROM = { has_character_flag = flag_child_forsaking_zodiac }
			}
		}
		name = { # Child was not abandoning the sign
			text = EVTOPTCHF23008_B
			trigger = {
				FROM = { has_character_flag = flag_child_embracing_zodiac }
			}
		}

		trigger = {
			OR = {
				religion_openly_hellenic_or_reformed_trigger = yes
				has_religion_feature = religion_astrology
			}
		}

		FROM = {
			character_event = { id = HF.23024 }
		}

		ai_chance = {
			factor = 80

			mult_modifier = {
				factor = 0.5
				trait = cynical
			}

			mult_modifier = {
				factor = 0.5
				trait = hedonist
			}

			mult_modifier = {
				factor = 0.5
				trait = socializer
			}
		}
	}
}

# Astrology: The child has been persuaded to forsake the sign
character_event = {
	id = HF.23023
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23023
		trigger = { has_character_flag = flag_child_embracing_zodiac }
	}
	desc = {
		text = EVTDESCBHF23023
		trigger = { has_character_flag = flag_child_forsaking_zodiac }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23023

		clr_character_flag = flag_child_embracing_zodiac
		clr_character_flag = flag_child_forsaking_zodiac
		set_character_flag = flag_child_forsaken_zodiac
	}
}

# Astrology: The child has been persuaded to embrace the sign
character_event = {
	id = HF.23024
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23024
		trigger = { has_character_flag = flag_child_embracing_zodiac }
	}
	desc = {
		text = EVTDESCBHF23024
		trigger = { has_character_flag = flag_child_forsaking_zodiac }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23024

		clr_character_flag = flag_child_embracing_zodiac
		clr_character_flag = flag_child_forsaking_zodiac
	}
}

# Astrology: Adult character without his sign gains it by decision
character_event = {
	id = HFP.23925
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23025
		trigger = { trait = zodiac_aquarius }
	}
	desc = {
		text = EVTDESCBHF23025
		trigger = { trait = zodiac_aries }
	}
	desc = {
		text = EVTDESCCHF23025
		trigger = { trait = zodiac_cancer }
	}
	desc = {
		text = EVTDESCDHF23025
		trigger = { trait = zodiac_capricorn }
	}
	desc = {
		text = EVTDESCEHF23025
		trigger = { trait = zodiac_gemini }
	}
	desc = {
		text = EVTDESCFHF23025
		trigger = { trait = zodiac_leo }
	}
	desc = {
		text = EVTDESCGHF23025
		trigger = { trait = zodiac_libra }
	}
	desc = {
		text = EVTDESCHHF23025
		trigger = { trait = zodiac_pisces }
	}
	desc = {
		text = EVTDESCIHF23025
		trigger = { trait = zodiac_sagittarius }
	}
	desc = {
		text = EVTDESCLHF23025
		trigger = { trait = zodiac_scorpio }
	}
	desc = {
		text = EVTDESCMHF23025
		trigger = { trait = zodiac_taurus }
	}
	desc = {
		text = EVTDESCNHF23025
		trigger = { trait = zodiac_virgo }
	}

	is_triggered_only = yes # determine_zodiac_sign_decision, HF_religious_decisions.txt

	option = {
		name = EVTOPTAHF23025

		tooltip = { # Trait has already been added, just show it in the tooltip for the player
			trigger_switch = {
				on_trigger = trait

				zodiac_aquarius	   = { add_trait = zodiac_aquarius }
				zodiac_aries	   = { add_trait = zodiac_aries }
				zodiac_cancer	   = { add_trait = zodiac_cancer }
				zodiac_capricorn   = { add_trait = zodiac_capricorn }
				zodiac_gemini	   = { add_trait = zodiac_gemini }
				zodiac_leo		   = { add_trait = zodiac_leo }
				zodiac_libra	   = { add_trait = zodiac_libra }
				zodiac_pisces	   = { add_trait = zodiac_pisces }
				zodiac_sagittarius = { add_trait = zodiac_sagittarius }
				zodiac_scorpio	   = { add_trait = zodiac_scorpio }
				zodiac_taurus	   = { add_trait = zodiac_taurus }
				zodiac_virgo	   = { add_trait = zodiac_virgo }
			}
		}
	}
}

#######################################################################

############## Delving into the Classics - Possibly starting a Hellenic cult

#######################################################################
character_event = {
	id = HF.23026
	desc = EVTDESCAHF23026
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # delve_into_classics_decision, HF_religious_decisions.txt

	option = { # Interest in religion
		name = EVTOPTAHF23026

		custom_tooltip = {
			text = tooltipt_HF23026_A
			set_character_flag = flag_studying_classics_religion
		}

		ai_chance = { factor = 100 } # Already unlikely to happen for the AI, so pick the one meaningful choice
	}

	option = { # Interest in war
		name = EVTOPTBHF23026

		custom_tooltip = {
			text = tooltipt_HF23026_B
			set_character_flag = flag_studying_military_war
		}

		ai_chance = { factor = 0 }
	}

	option = { # Interest in government
		name = EVTOPTCHF23026

		custom_tooltip = {
			text = tooltipt_HF23026_C
			set_character_flag = flag_studying_classics_government
		}

		ai_chance = { factor = 0 }
	}

	option = { # Interest in orations
		name = EVTOPTDHF23026

		custom_tooltip = {
			text = tooltipt_HF23026_D
			set_character_flag = flag_studying_classics_orations
		}

		ai_chance = { factor = 0 }
	}

	after = { # Determine outcome based on choice and learning
		hidden_effect = {
			random_list = {
				10 = { # Failure
					trigger = {
						NOT = { has_character_flag = flag_studying_classics_religion } # Conversion never fails
					}

					mult_modifier = {
						factor = 1.5
						learning < 2
					}

					mult_modifier = {
						factor = 1.5
						learning < 4
					}

					mult_modifier = {
						factor = 1.5
						learning < 6
					}

					mult_modifier = {
						factor = 1.25
						learning < 8
					}

					mult_modifier = {
						factor = 0.85
						learning >= 10
					}

					mult_modifier = {
						factor = 0.85
						learning >= 12
					}

					mult_modifier = {
						factor = 0.75
						learning >= 14
					}

					mult_modifier = {
						factor = 0.75
						learning >= 16
					}

					mult_modifier = {
						factor = 0.75
						learning >= 18
					}

					mult_modifier = {
						factor = 0.5
						learning >= 20
					}

					mult_modifier = {
						factor = 0.5
						learning >= 24
					}

					mult_modifier = {
						factor = 0.25
						learning >= 26
					}

					mult_modifier = {
						factor = 2
						trait = slow
					}

					mult_modifier = {
						factor = 3
						trait = imbecile
					}

					mult_modifier = {
						factor = 3
						trait = inbred
					}

					mult_modifier = {
						factor = 2
						trait = dull
					}

					character_event = { id = HF.23027 days = 100 random = 100 }
				}

				20 = { # Success studying religion
					trigger = { has_character_flag = flag_studying_classics_religion }
					character_event = { id = HF.23028 days = 100 random = 100 }
				}

				20 = { # Success studying war
					trigger = { has_character_flag = flag_studying_military_war }
					character_event = { id = HF.23029 days = 100 random = 100 }
				}

				20 = { # Success studying government
					trigger = { has_character_flag = flag_studying_classics_government }
					character_event = { id = HF.23030 days = 100 random = 100 }
				}

				20 = { # Success studying orations
					trigger = { has_character_flag = flag_studying_classics_orations }
					character_event = { id = HF.23031 days = 100 random = 100 }
				}
			}

			clr_character_flag = flag_studying_classics_religion
			clr_character_flag = flag_studying_military_war
			clr_character_flag = flag_studying_classics_government
			clr_character_flag = flag_studying_classics_orations
		}
	}
}

# Study ended in failure
character_event = {
	id = HF.23027
	desc = EVTDESCAHF23027
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23027
	}
}

# Chance to secretly become hellenic
character_event = {
	id = HF.23028
	desc = EVTDESCAHF23028
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23028

		trigger = {
			religion_openly_hellenic_or_reformed_trigger = no
			religion_secretly_hellenic_or_reformed_trigger = no
		}

		if = {
			limit = { trait = zealous }
			remove_trait = zealous
		}

		set_secret_religion = hellenic_pagan

		ai_chance = { factor = 2 }
	}

	option = {
		name = EVTOPTCHF23028

		trigger = {
			OR = {
				religion_openly_hellenic_or_reformed_trigger = yes
				religion_secretly_hellenic_or_reformed_trigger = yes
			}
		}

		tiered_piety_reward_effect = yes

		ai_chance = { factor = 0 }
	}

	option = {
		name = EVTOPTBHF23028

		ai_chance = { factor = 98 }
	}
}

# Studied military
character_event = {
	id = HF.23029
	desc = EVTDESCAHF23029
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23029

		add_character_modifier = {
			name = caesars_insight
			duration = -1
		}
	}
}

# Studied statecraft
character_event = {
	id = HF.23030
	desc = EVTDESCAHF23030
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23030

		add_character_modifier = {
			name = justinians_insight
			duration = -1
		}
	}
}

# Studied orations
character_event = {
	id = HF.23031
	desc = EVTDESCAHF23031
	picture = GFX_evt_library
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23031

		add_character_modifier = {
			name = ciceros_insight
			duration = -1
		}
	}
}

# Astrology: Notification event without tooltip
character_event = {
	id = HF.23032
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23025
		trigger = { trait = zodiac_aquarius }
	}
	desc = {
		text = EVTDESCBHF23025
		trigger = { trait = zodiac_aries }
	}
	desc = {
		text = EVTDESCCHF23025
		trigger = { trait = zodiac_cancer }
	}
	desc = {
		text = EVTDESCDHF23025
		trigger = { trait = zodiac_capricorn }
	}
	desc = {
		text = EVTDESCEHF23025
		trigger = { trait = zodiac_gemini }
	}
	desc = {
		text = EVTDESCFHF23025
		trigger = { trait = zodiac_leo }
	}
	desc = {
		text = EVTDESCGHF23025
		trigger = { trait = zodiac_libra }
	}
	desc = {
		text = EVTDESCHHF23025
		trigger = { trait = zodiac_pisces }
	}
	desc = {
		text = EVTDESCIHF23025
		trigger = { trait = zodiac_sagittarius }
	}
	desc = {
		text = EVTDESCLHF23025
		trigger = { trait = zodiac_scorpio }
	}
	desc = {
		text = EVTDESCMHF23025
		trigger = { trait = zodiac_taurus }
	}
	desc = {
		text = EVTDESCNHF23025
		trigger = { trait = zodiac_virgo }
	}

	is_triggered_only = yes # 670, on_reform_religion

	ai = no

	option = {
		name = EVTOPTAHF23025
	}
}

# on_conversion: Converted to a Pagan Religion with branches from a religion without
character_event = {
	id = HF.23033
	desc = EVTDESCHF23033
	picture = GFX_evt_pagan
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # on_character_convert_religion

	religion_group = pagan_group

	trigger = {
		is_adult = yes
		has_religion_feature = religion_no_leader

		NOR = {
			trait = pagan_branch_1
			trait = pagan_branch_2
			trait = pagan_branch_3
			trait = pagan_branch_4
			has_character_modifier = picked_pagan_branch_cooldown
		}
	}

	immediate = {
		add_character_modifier = {
			name = picked_pagan_branch_cooldown
			years = 5
			hidden = yes
		}
	}

	option = {
		name = EVTOPTAHF23016

		trigger = {
			NOT = { has_religion_feature = religion_dogmatic }
		}

		add_trait = pagan_branch_1

		ai_chance = {
			factor = 5

			mult_modifier = {
				factor = 0.1
				has_religion_feature = religion_jizya
			}
		}
	}

	option = {
		name = EVTOPTBHF23016

		add_trait = pagan_branch_2

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5

				OR = {
					trait = scholar
					trait = theologian
					trait = mystic
					trait = zealous
					has_focus = focus_scholarship
					has_focus = focus_theology
					has_education_learning_trigger = yes
				}
			}

			mult_modifier = {
				factor = 0.5

				OR = {
					trait = lustful
					trait = hedonist
					trait = gluttonous
					trait = drunkard
					has_focus = focus_seduction
					has_focus = focus_carousing
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23016

		add_trait = pagan_branch_3

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5

				OR = {
					trait = duelist
					trait = hunter
					trait = strategist
					trait = zealous
					has_focus = focus_war
					has_focus = focus_hunting
					has_education_martial_trigger = yes
				}
			}

			mult_modifier = {
				factor = 0.5

				OR = {
					trait = craven
					trait = paranoid
					trait = shy
				}
			}
		}
	}

	option = {
		name = EVTOPTDHF23016

		add_trait = pagan_branch_4

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5

				OR = {
					any_child = {
						is_adult = no
						count = 3
					}

					has_focus = focus_family
					has_focus = focus_carousing
					has_education_diplomacy_trigger = yes
				}
			}
		}
	}

	after = {
		clr_character_flag = flag_picking_branch
	}
}

# On Conversion event to clear up gender laws when needed
character_event = {
	id = HF.23034

	is_triggered_only = yes # on_character_convert_religion
	hide_window = yes

	is_patrician = no # Always use agnatic

	trigger = {
		OR = {
			has_religion_feature = religion_patriarchal
			has_religion_feature = religion_equal
			has_religion_feature = religion_feature_bon
			has_religion_feature = religion_matriarchal
		}
	}

	immediate = {
		if = {
			limit = {
				has_religion_feature = religion_matriarchal

				FROM = {
					NOT = { has_religion_feature = religion_matriarchal }
				}
			}

			if = { # Only apply opinion modifiers if important titles change gender succession law
				limit = {
					any_demesne_title = {
						OR = {
							is_primary_holder_title_tier = yes
							higher_real_tier_than = DUKE
						}

						succ_law_title = {
							NOT = { has_law = agnatic_succession }
						}
					}
				}

				if = {
					limit = {
						FROM = {
							has_religion_feature = religion_patriarchal
						}
					}

					any_close_relative = {
						if = {
							limit = { is_female = no }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
								multiplier = 2
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
								multiplier = 2
							}
						}
					}
				}
				else = {
					any_close_relative = {
						if = {
							limit = { is_female = no }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
							}
						}
					}
				}
			}

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = enatic_succession
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}

			recalc_succession = yes
		}
		else_if = {
			limit = {
				has_religion_feature = religion_patriarchal

				FROM = {
					NOT = { has_religion_feature = religion_patriarchal }
				}
			}

			if = { # Only apply opinion modifiers if important titles change gender succession law
				limit = {
					any_demesne_title = {
						OR = {
							is_primary_holder_title_tier = yes
							higher_real_tier_than = DUKE
						}

						NOT = { has_law = agnatic_succession }
					}
				}

				if = {
					limit = {
						FROM = {
							has_religion_feature = religion_matriarchal
						}
					}

					any_close_relative = {
						if = {
							limit = { is_female = yes }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
								multiplier = 2
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
								multiplier = 2
							}
						}
					}
				}
				else = {
					any_close_relative = {
						if = {
							limit = { is_female = yes }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
							}
						}
					}
				}
			}

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = agnatic_succession
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = status_of_women_0
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}

			recalc_succession = yes
		}
		else_if = {
			limit = {
				OR = {
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
				}

				FROM = {
					NOR = {
						has_religion_feature = religion_equal
						has_religion_feature = religion_feature_bon
					}
				}
			}

			if = { # Only apply opinion modifiers if important titles change gender succession law
				limit = {
					any_demesne_title = {
						OR = {
							is_primary_holder_title_tier = yes
							higher_real_tier_than = DUKE
						}

						NOT = { has_law = true_cognatic_succession }
					}
				}

				if = {
					limit = {
						FROM = {
							has_religion_feature = religion_patriarchal
						}
					}

					any_close_relative = {
						if = {
							limit = { is_female = no }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
							}
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							has_religion_feature = religion_matriarchal
						}
					}

					any_close_relative = {
						if = {
							limit = { is_female = yes }

							opinion = {
								name = bad_succ_law_change
								who = ROOT
								years = 100
							}
						}
						else = {
							opinion = {
								name = good_succ_law_change
								who = ROOT
								years = 100
							}
						}
					}
				}
			}

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = true_cognatic_succession
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}

			recalc_succession = yes
		}
	}
}

# On Random Start cleanup for Status of Women
character_event = {
	id = HF.23035

	is_triggered_only = yes # on_startup
	hide_window = yes

	trigger = {
		is_save_game = no
	}

	immediate = {
		if = {
			limit = { has_religion_feature = religion_matriarchal }

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = enatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
		else_if = {
			limit = { has_religion_feature = religion_patriarchal }

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_0
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = agnatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
		else_if = {
			limit = {
				OR = {
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
				}
			}

			any_demesne_title = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = true_cognatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
	}
}

################################################################
#		 		Reformation via Roman Empire 				   #
################################################################

# Burn Rome of all its pesky temple holdings to make it a viable capital again
# Province ping, to ensure event still fires if emperor dies
province_event = {
	id = HF.23100

	is_triggered_only = yes # LoR.20, lor_roman_events.txt
	hide_window = yes

	immediate = {
		e_roman_empire = {
			holder_scope = {
				character_event = { id = HF.23101 }
			}
		}
	}
}

# Does the Emperor wish to burn Rome?
character_event = {
	id = HF.23101
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23101
		trigger = { religion_group = christian }
	}
	desc = {
		text = EVTDESCBHF23101
		trigger = {
			NOT = { religion_group = christian }
			religion_secretly_hellenic_or_reformed_trigger = no
			religion_openly_hellenic_or_reformed_trigger = no
		}
	}
	desc = {
		text = EVTDESCCHF23101
		trigger = {
			OR = {
				religion_secretly_hellenic_or_reformed_trigger = yes
				religion_openly_hellenic_or_reformed_trigger = yes
			}
		}
	}

	is_triggered_only = yes

	trigger = {
		NOT = { religion = catholic } # Would not consider it
	}

	option = { # Burn it all!
		name = {
			text = EVTOPTAHF23101_A
			trigger = { religion_group = christian }
		}
		name = {
			text = EVTOPTAHF23101_B
			trigger = {
				NOT = { religion_group = christian }
				religion_secretly_hellenic_or_reformed_trigger = no
				religion_openly_hellenic_or_reformed_trigger = no
			}
		}
		name = {
			text = EVTOPTAHF23101_C
			trigger = {
				OR = {
					religion_secretly_hellenic_or_reformed_trigger = yes
					religion_openly_hellenic_or_reformed_trigger = yes
				}
			}
		}

		narrative_event = {
			id = HF.23102
			tooltip = tooltip_HF23101_A
		}

		add_trait_fully_silently_cruel_effect = yes

		ai_chance = { factor = 1 }
	}

	option = { # Leave it alone
		name = {
			text = EVTOPTBHF23101_A
			trigger = { religion_group = christian }
		}
		name = {
			text = EVTOPTBHF23101_B
			trigger = {
				NOT = { religion_group = christian }
				religion_secretly_hellenic_or_reformed_trigger = no
				religion_openly_hellenic_or_reformed_trigger = no
			}
		}
		name = {
			text = EVTOPTBHF23101_C
			trigger = {
				OR = {
					religion_secretly_hellenic_or_reformed_trigger = yes
					religion_openly_hellenic_or_reformed_trigger = yes
				}
			}
		}

		ai_chance = {
			factor = 99

			trigger = {
				religion_secretly_hellenic_or_reformed_trigger = no
				religion_openly_hellenic_or_reformed_trigger = no

				NOR = {
					trait = lunatic
					trait = possessed
					trait = cruel
				}
			}

			mult_modifier = {
				factor = 0.1
				NOT = { religion_group = christian }
			}
		}
	}
}

# Rome's temples burn - Emperor's perspective
narrative_event = {
	id = HF.23102
	title = EVTTITLEAHF23102
	picture = GFX_evt_rome_falls
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23102
		trigger = { religion_group = christian }
	}
	desc = {
		text = EVTDESCBHF23102
		trigger = {
			NOT = { religion_group = christian }
			religion_secretly_hellenic_or_reformed_trigger = no
			religion_openly_hellenic_or_reformed_trigger = no
		}
	}
	desc = {
		text = EVTDESCCHF23102
		trigger = {
			OR = {
				religion_secretly_hellenic_or_reformed_trigger = yes
				religion_openly_hellenic_or_reformed_trigger = yes
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = {
			text = EVTOPTAHF23102_A
			trigger = { religion_group = christian }
		}
		name = {
			text = EVTOPTAHF23102_B
			trigger = {
				NOT = { religion_group = christian }
				religion_secretly_hellenic_or_reformed_trigger = no
				religion_openly_hellenic_or_reformed_trigger = no
			}
		}
		name = {
			text = EVTOPTAHF23102_C
			trigger = {
				OR = {
					religion_secretly_hellenic_or_reformed_trigger = yes
					religion_openly_hellenic_or_reformed_trigger = yes
				}
			}
		}

		custom_tooltip = {
			text = tooltip_HF23102_A

			any_vassal = {
				limit = {
					religion_group = christian

					NOR = {
						secret_religion_group = muslim
						secret_religion_group = pagan_group
					}
				}

				opinion = {
					name = blasphemous_pyromaniac
					who = ROOT
					years = 100
				}
			}

			catholic = {
				religion_authority = {
					name = rome_destroyed
					years = 1000
				}
			}

			c_roma = {
				location = {
					if = { # If Rome is Christian, peasant revolt is inevitable
						limit = { religion_group = christian }

						province_event = {
							id = HF.23104
							days = 5
						}
					}
					else = { # If Rome is not Christian, the survivors will turn to the Emperor's religion if he forsakes Christianity later
						set_province_flag = flag_rome_primed_for_conversion
					}

					any_province_holding = {
						limit = { holding_type = temple }
						destroy_settlement = yes
					}
				}
			}

			any_player = {
				limit = {
					is_within_diplo_range = ROOT
					NOT = { character = ROOT }
				}

				narrative_event = { id = HF.23103 } # Notification
			}
		}

		if = {
			limit = { religion_group = christian }
			tiered_piety_negative_effect = yes
		}
		else = {
			tiered_piety_reward_effect = yes
		}
	}
}

# Other players informed of what happened
narrative_event = {
	id = HF.23103
	title = EVTTITLEAHF23102
	picture = GFX_evt_rome_falls
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23102
		trigger = { religion_group = christian }
	}
	desc = {
		text = EVTDESCBHF23102
		trigger = {
			NOT = { religion_group = christian }
			religion_secretly_hellenic_or_reformed_trigger = no
			religion_openly_hellenic_or_reformed_trigger = no
		}
	}
	desc = {
		text = EVTDESCCHF23102
		trigger = {
			OR = {
				religion_secretly_hellenic_or_reformed_trigger = yes
				religion_openly_hellenic_or_reformed_trigger = yes
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = {
			text = EVTOPTAHF23103_A
			trigger = { religion_group = christian }
		}
		name = {
			text = EVTOPTAHF23103_B
			trigger = {
				NOR = {
					religion = FROM
					religion_group = christian
				}
			}
		}
		name = {
			text = EVTOPTAHF23103_C
			trigger = {
				religion = FROM
				NOT = { religion_group = christian }
			}
		}
	}
}

# Christian peasants rise up after the great fire settles
province_event = {
	id = HF.23104
	desc = EVTDESCHF23104
	picture = GFX_evt_riots_byzantine
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	immediate = {
		owner = {
			top_liege = {
				save_event_target_as = roman_emperor
			}

			any_liege = { # Inform the lieges
				character_event = { id = HF.23105 }
			}
		}

		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 32
			add_trait = zealous
			add_trait = scholar
			add_trait = skilled_tactician

			attributes = {
				martial = 7
				learning = 7
			}
		}

		new_character = {
			set_character_flag = roman_christian_revolter

			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = ROMAN_CHRISTIAN_REVOLT
				holder = THIS
			}

			wealth = 300

			while = {
				count = 2
				spawn_religious_army_effect = yes
			}

			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}

				while = {
					count = 2
					spawn_religious_army_effect = yes
				}

				wealth = 150
			}
			else_if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}

				while = {
					count = 5
					spawn_religious_army_effect = yes
				}

				wealth = 250
			}
			else_if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}

				while = {
					count = 8
					spawn_religious_army_effect = yes
				}

				wealth = 350
			}

			# DoW on the province top liege
			war = {
				target = event_target:roman_emperor
				casus_belli = roman_christian_revolt
				thirdparty_title = ROOT # The county...
				tier = DUKE # ... but really the de jure duchy
			}

			opinion = {
				name = opinion_evil_tyrant
				who = event_target:roman_emperor
			}
		}
	}

	option = {
		name = EVTOPTAHF23104
	}
}

# In case Rome is held by a vassal, inform liege
character_event = {
	id = HF.23105
	desc = EVTDESCHF23104
	picture = GFX_evt_rome_falls
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23104
	}
}

# New Emperor of restored Rome thinks about restoring the old religion
character_event = {
	id = HF.23106
	desc = EVTDESCAHF23106
	picture = GFX_evt_holy_emperor
	border = GFX_event_normal_frame_religion

	religion_group = christian
	has_dlc = "Holy Fury"

	trigger = {
		OR = {
			culture = greek
			culture = italian
			culture = roman
		}
	}

	is_triggered_only = yes # LoR.20, lor_roman_events.txt

	option = { # Become a secret hellenic
		name = EVTOPTAHF23106

		custom_tooltip = { text = tooltip_HF23106_A }

		if = {
			limit = {
				religion_openly_hellenic_or_reformed_trigger = no
				religion_secretly_hellenic_or_reformed_trigger = no
			}

			if = {
				limit = { hellenic_pagan = { has_flag = has_been_reformed } }
				set_secret_religion = hellenic_pagan_reformed
			}
			else = {
				set_secret_religion = hellenic_pagan
			}
		}

		character_event = { id = HF.23107 }

		ai_chance = {
			factor = 100

			trigger = {
				OR = {
					religion_secretly_hellenic_or_reformed_trigger = yes
					trait = lunatic
					trait = possessed
					trait = mystic
				}
			}
		}
	}

	option = { # Do nothing
		name = EVTOPTBHF23106

		ai_chance = {
			factor = 100

			trigger = {
				religion_secretly_hellenic_or_reformed_trigger = no

				NOR = {
					trait = lunatic
					trait = possessed
					trait = mystic
				}
			}
		}
	}
}

# How does the Emperor restore Hellenism?
character_event = {
	id = HF.23107
	desc = EVTDESCAHF23107
	picture = GFX_evt_victory_arch_byzantine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # No time to wait, we must act now
		name = EVTOPTAHF23107

		custom_tooltip = { text = tooltip_HF23107_A }

		if = {
			limit = { hellenic_pagan = { has_flag = has_been_reformed } }

			# Workaround for automatic usurption of theocratic characters
			hellenic_pagan_reformed = {
				save_event_target_as = target_religion
			}

			convert_religion_failsafe_effect = yes

			hidden_effect = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_reformed_community
						owned_by = PREV
					}

					religion = hellenic_pagan_reformed
					remove_province_modifier = secret_hellenic_pagan_reformed_community
				}
			}
		}
		else = {
			# Workaround for automatic usurption of theocratic characters
			hellenic_pagan = {
				save_event_target_as = target_religion
			}

			convert_religion_failsafe_effect = yes

			hidden_effect = {
				any_demesne_province = {
					limit = {
						has_province_modifier = secret_hellenic_pagan_community
						owned_by = PREV
					}

					religion = hellenic_pagan
					remove_province_modifier = secret_hellenic_pagan_community
				}
			}
		}

		give_nickname = nick_the_apostate

		narrative_event = {
			id = HF.23112
			days = 27
		}

		any_courtier_or_vassal = {
			letter_event = {
				id = HF.23108
				days = 7
			}
		}

		any_player = {
			limit = {
				is_within_diplo_range = ROOT
				NOT = { character = ROOT }
			}

			narrative_event = {
				id = HF.23112
				days = 27
			}
		}

		if = {
			limit = {
				NOR = {
					trait = lunatic
					trait = possessed
					hellenic_pagan = { has_flag = has_been_reformed }
				}
			}

			random = {
				chance = 15
				add_trait_lunatic_effect = yes
			}
		}
	}

	option = { # I must build support first. - Chain will end
		name = EVTOPTBHF23107

	#	trigger = { # If secret cults are off, only open option available
	#		has_game_rule = {
	#			name = secret_cults
	#			value = default
	#		}
	#	}

		if = {
			limit = { hellenic_pagan = { has_flag = has_been_reformed } }
			set_secret_religion = hellenic_pagan_reformed
		}
		else = {
			set_secret_religion = hellenic_pagan
		}

	#	hidden_effect = {
	#		set_society_grandmaster = yes # Set character as Grand Master
	#		# Give the Emperor a start-up capital to induct members
	#		add_society_currency_massive_effect = yes
	#		add_society_currency_massive_effect = yes
	#	}

		ai_chance = { factor = 0 } # Too stupid to be reasonably expected to ever pull it off
	}
}

# Vassals receive ultimatum
letter_event = {
	id = HF.23108
	desc = EVTDESCAHF23108
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = { # Do not convert
		name = EVTOPTAHF23108

		if = {
			limit = {
				OR = {
					religion_group = christian
					religion_group = muslim
					religion_group = jewish_group
				}
			}

			opinion = {
				name = insane_heathen
				who = FROM
				years = 30
			}
		}

		if = {
			limit = { higher_real_tier_than = BARON }
			FROM = { letter_event = { id = HF.23109 } }
		}

		ai_chance = {
			factor = 90

			trigger = {
				OR = {
					is_ruler = yes
					is_adult = yes
					NOT = { is_close_relative = FROM }
					has_character_flag = ai_flag_refuse_conversion
				}
			}

			mult_modifier = {
				factor = 0.1

				OR = {
					secret_religion = FROM
					religion = FROM
					is_lover = FROM
					is_friend = FROM
				}
			}

			mult_modifier = {
				factor = 0.1

				is_close_relative = FROM
				is_ruler = no

				opinion = {
					who = FROM
					value >= 20
				}
			}
		}
	}

	option = { # Convert
		name = {
			text = EVTOPTBHF23107_A
			trigger = {
				OR = {
					religion = FROM
					secret_religion = FROM
				}
			}
		}
		name = {
			text = EVTOPTBHF23107_B
			trigger = {
				NOR = {
					religion = FROM
					secret_religion = FROM
				}
			}
		}

		trigger = {
			OR = {
				religion = FROM
				secret_religion = FROM
				NOT = { trait = zealous }
			}
		}

		# Workaround for automatic usurption of theocratic characters
		FROM = {
			religion_scope = {
				save_event_target_as = target_religion
			}
		}

		convert_religion_failsafe_effect = yes

		hidden_effect = {
			if = {
				limit = {
					society_member_of = secret_religious_cult
					secret_religion = FROM
				}

				if = {
					limit = { secret_religion = hellenic_pagan }

					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_community
							owned_by = PREV
						}

						religion = hellenic_pagan
						remove_province_modifier = secret_hellenic_pagan_community
					}
				}
				else = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_reformed_community
							owned_by = PREV
						}

						religion = hellenic_pagan_reformed
						remove_province_modifier = secret_hellenic_pagan_reformed_community
					}
				}
			}

			if = {
				limit = { higher_real_tier_than = BARON }

				FROM = { letter_event = { id = HF.23110 } }

				any_courtier_or_vassal = {
					limit = { is_theocracy = no }
					letter_event = { id = HF.23111 } # Keep going until the bottom
				}
			}
		}

		ai_chance = {
			factor = 5

			trigger = {
				OR = {
					is_lover = FROM
					is_friend = FROM
					is_theocracy = no
				}

				NOT = { has_character_flag = ai_flag_refuse_conversion }
			}
		}
	}
}

# Vassal will not convert
letter_event = {
	id = HF.23109
	desc = EVTDESCAHF23109
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes
	notification = yes

	ai = no

	option = { # Do not convert
		name = UNFORTUNATE
	}
}

# Vassal will convert
letter_event = {
	id = HF.23110
	desc = EVTDESCAHF23110
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes
	notification = yes

	ai = no

	option = { # Convert
		name = EXCELLENT
	}
}

# Vassals of Vassals automatically convert alongside their immediate liege (unless player or theocracies)
letter_event = {
	id = HF.23111
	desc = EVTDESCAHF23111
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = { # Convert
		name = EVTOPTAHF23111

		# Workaround for automatic usurption of theocratic characters
		FROM = {
			religion_scope = {
				save_event_target_as = target_religion
			}
		}

		convert_religion_failsafe_effect = yes

		hidden_effect = {
			if = {
				limit = {
					society_member_of = secret_religious_cult
					secret_religion = FROM
				}

				if = {
					limit = { secret_religion = hellenic_pagan }

					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_community
							owned_by = PREV
						}

						religion = hellenic_pagan
						remove_province_modifier = secret_hellenic_pagan_community
					}
				}
				else = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_reformed_community
							owned_by = PREV
						}

						religion = hellenic_pagan_reformed
						remove_province_modifier = secret_hellenic_pagan_reformed_community
					}
				}
			}

			if = {
				limit = { higher_real_tier_than = BARON }

				any_courtier_or_vassal = {
					limit = { is_theocracy = no }
					letter_event = { id = HF.23111 } # Keep going until the bottom
				}
			}
		}

		ai_chance = {
			factor = 100

			trigger = {
				is_theocracy = no
				NOT = { has_character_flag = ai_flag_refuse_conversion }
			}
		}
	}

	option = { # Do not convert
		name = EVTOPTBHF23111

		ai_chance = {
			factor = 1

			trigger = {
				OR = {
					is_theocracy = yes
					has_character_flag = ai_flag_refuse_conversion
				}
			}
		}
	}
}

# The Roman Empire turns hellenic
narrative_event = {
	id = HF.23112
	title = EVTTITLEHF23112
	desc = EVTDESCAHF23112
	sound = pagan_reformation
	picture = GFX_evt_rome_restored_byzantine
	border = GFX_event_narrative_frame_religion

	is_triggered_only = yes

	option = { # Restorer
		name = EVTOPTAHF23112

		trigger = { character = FROM }

		prestige = -1000

		if = {
			limit = { piety < 500 }
			piety = 750
		}

		c_roma = {
			show_scope_change = no

			location = {
				show_scope_change = no

				if = {
					limit = { has_province_flag = flag_rome_primed_for_conversion }
					religion = FROM
				}
			}
		}

		# Facilitate restoration for the AI by making it take over all owned holy sites
		if = {
			limit = {
				c_roma = {
					location = {
						top_liege = { character = FROM }

						any_province_holding = {
							is_holy_site = FROM
							holding_type = temple

							holder_scope = {
								trigger_if = {
									limit = { religion = FROM }
									character = FROM
								}
							}
						}
					}
				}
			}

			custom_tooltip = {
				text = tooltip_rome_church_seized

				c_roma = {
					location = {
						random_province_holding = {
							limit = {
								is_holy_site = FROM
								holding_type = temple

								holder_scope = {
									trigger_if = {
										limit = { religion = FROM }
										character = FROM
									}
								}
							}

							save_event_target_as = scoped_rome_temple
						}
					}
				}

				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no

					attributes = {
						diplomacy = 2
						learning = 8
						stewardship = 2
						intrigue = 2
						martial = 2
					}
				}

				new_character = {
					grant_title = event_target:scoped_rome_temple
				}
			}
		}

		if = {
			limit = {
				c_thessalonike = {
					location = {
						top_liege = { character = FROM }

						any_province_holding = {
							is_holy_site = FROM
							holding_type = temple

							holder_scope = {
								trigger_if = {
									limit = { religion = FROM }
									character = FROM
								}
							}
						}
					}
				}
			}

			custom_tooltip = {
				text = tooltip_thessalonike_church_seized

				c_thessalonike = {
					location = {
						random_province_holding = {
							limit = {
								is_holy_site = FROM
								holding_type = temple

								holder_scope = {
									trigger_if = {
										limit = { religion = FROM }
										character = FROM
									}
								}
							}

							save_event_target_as = scoped_thessalonike_temple
						}
					}
				}

				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no

					attributes = {
						diplomacy = 2
						learning = 8
						stewardship = 2
						intrigue = 2
						martial = 2
					}
				}

				new_character = {
					grant_title = event_target:scoped_thessalonike_temple
				}
			}
		}

		if = {
			limit = {
				c_atheniai = {
					location = {
						top_liege = { character = FROM }

						any_province_holding = {
							is_holy_site = FROM
							holding_type = temple

							holder_scope = {
								trigger_if = {
									limit = { religion = FROM }
									character = FROM
								}
							}
						}
					}
				}
			}

			custom_tooltip = {
				text = tooltip_atheniai_church_seized

				c_atheniai = {
					location = {
						random_province_holding = {
							limit = {
								holding_type = temple
								is_holy_site = FROM
								holder_scope = {
									trigger_if = {
											limit = { religion = FROM }
											character = FROM
										}
								}
							}

							save_event_target_as = scoped_atheniai_temple
						}
					}
				}

				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no

					attributes = {
						diplomacy = 2
						learning = 8
						stewardship = 2
						intrigue = 2
						martial = 2
					}
				}

				new_character = {
					grant_title = event_target:scoped_atheniai_temple
				}
			}
		}

		if = {
			limit = {
				c_siracusa = {
					location = {
						top_liege = { character = FROM }

						any_province_holding = {
							is_holy_site = FROM
							holding_type = temple

							holder_scope = {
								trigger_if = {
									limit = { religion = FROM }
									character = FROM
								}
							}
						}
					}
				}
			}

			custom_tooltip = {
				text = tooltip_siracusa_church_seized

				c_siracusa = {
					location = {
						random_province_holding = {
							limit = {
								holding_type = temple
								is_holy_site = FROM
								holder_scope = {
									trigger_if = {
										limit = { religion = FROM }
										character = FROM
									}
								}
							}

							save_event_target_as = scoped_siracusa_temple
						}
					}
				}

				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no

					attributes = {
						diplomacy = 2
						learning = 8
						stewardship = 2
						intrigue = 2
						martial = 2
					}
				}

				new_character = {
					grant_title = event_target:scoped_siracusa_temple
				}
			}
		}

		if = {
			limit = {
				c_alexandria = {
					location = {
						top_liege = { character = FROM }

						any_province_holding = {
							is_holy_site = FROM
							holding_type = temple

							holder_scope = {
								trigger_if = {
									limit = { religion = FROM }
									character = FROM
								}
							}
						}
					}
				}
			}

			custom_tooltip = {
				text = tooltip_alexandria_church_seized

				c_alexandria = {
					location = {
						random_province_holding = {
							limit = {
								is_holy_site = FROM
								holding_type = temple

								holder_scope = {
									trigger_if = {
										limit = { religion = FROM }
										character = FROM
									}
								}
							}

							save_event_target_as = scoped_alexandria_temple
						}
					}
				}

				create_random_priest = {
					random_traits = yes
					dynasty = random
					female = no

					attributes = {
						diplomacy = 2
						learning = 8
						stewardship = 2
						intrigue = 2
						martial = 2
					}
				}

				new_character = {
					grant_title = event_target:scoped_alexandria_temple
				}
			}
		}

		# Set up great rebellion
		save_event_target_as = scoped_hellenic_emperor

		random_vassal = {
			limit = {
				higher_real_tier_than = COUNT
				is_landed = yes
				prisoner = no

				OR = {
					is_feudal = yes
					is_merchant_republic = yes
				}

				OR = {
					religion_group = christian
					religion_group = muslim
					religion_group = jewish_group
				}
			}

			preferred_limit = {
				is_powerful_vassal = yes
				ai = no
				trait = zealous
				religion = orthodox
			}

			preferred_limit = {
				is_powerful_vassal = yes
				ai = no
				religion = orthodox
			}

			preferred_limit = {
				is_powerful_vassal = yes
				ai = no
				religion_group = christian
			}

			preferred_limit = {
				is_powerful_vassal = yes
				ai = no
			}

			preferred_limit = {
				is_powerful_vassal = yes
				religion = orthodox
				trait = zealous
			}

			preferred_limit = {
				is_powerful_vassal = yes
				religion = orthodox
			}

			preferred_limit = {
				is_powerful_vassal = yes
				religion_group = christian
			}

			preferred_limit = {
				is_powerful_vassal = yes
			}

			character_event = {
				id = HF.23113
				days = 12
			}
		}
	}

	option = {
		name = { # Convert Vassals
			text = EVTOPTBHF23112
			trigger = { religion_openly_hellenic_or_reformed_trigger = yes }
		}
		name = { # Abrahamics
			text = EVTOPTCHF23112
			trigger = {
				religion_openly_hellenic_or_reformed_trigger = no

				OR = {
					religion_group = christian
					religion_group = muslim
					religion_group = jewish_group
				}
			}
		}
		name = { # Everyone else
			text = EVTOPTDHF23112
			trigger = {
				religion_openly_hellenic_or_reformed_trigger = no

				NOR = {
					religion_group = christian
					religion_group = muslim
					religion_group = jewish_group
				}
			}
		}

		trigger = {
			NOT = { character = FROM }
		}
	}
}

# Random Abrahamic ruler starts a rebellion against the Hellenic Emperor
character_event = {
	id = HF.23113
	desc = EVTDESCHF23113
	picture = GFX_evt_bad_news
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		vassal_of = event_target:scoped_hellenic_emperor

		OR = {
			religion_group = christian
			religion_group = muslim
			religion_group = jewish_group
		}
	}

	fail_trigger_effect = {
		event_target:scoped_hellenic_emperor = {
			random_vassal = {
				limit = {
					higher_real_tier_than = COUNT
					is_landed = yes

					OR = {
						is_feudal = yes
						is_merchant_republic = yes
					}

					OR = {
						religion_group = christian
						religion_group = muslim
						religion_group = jewish_group
					}
				}

				character_event = { id = HF.23113 }
			}
		}
	}


	option = {
		name = EVTOPTAHF23113

		set_character_flag = flag_abrahamic_revolter

		custom_tooltip = {
			text = tooltip_HF23113_A

			start_faction = { faction = faction_abrahamic_revolters }

			event_target:scoped_hellenic_emperor = {
				any_vassal = {
					limit = {
						higher_real_tier_than = BARON

						OR = {
							religion_group = christian
							religion_group = muslim
							religion_group = jewish_group
						}

						is_theocracy = no
						prisoner = no
						NOT = { character = ROOT }
					}

					letter_event = { id = HF.23114 } # Call to Arms
				}
			}

			character_event = {
				id = HF.23115 # War actually starts
				days = 4
			}
		}
	}

	option = { # Player refuses to start a war
		name = EVTOPTBHF23113

		ai_chance = { factor = 0 }
	}
}

# Other Vassals join the cause
letter_event = {
	id = HF.23114
	desc = EVTDESCHF23114
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		vassal_of = event_target:scoped_hellenic_emperor

		OR = {
			religion_group = christian
			religion_group = muslim
			religion_group = jewish_group
		}
	}

	option = { # Join Independence war
		name = EVTOPTAHF23114

		join_faction = {
			faction = faction_abrahamic_revolters
			faction_leader = FROM
		}

		ai_chance = {
			factor = 95

			mult_modifier = {
				factor = 0.5
				NOT = { religion_group = FROM }
			}

			mult_modifier = {
				factor = 0.5
				trait = cynical
			}

			mult_modifier = {
				factor = 0.5
				trait = craven
			}

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}
		}
	}

	option = { # Refuse
		name = EVTOPTBHF23114

		ai_chance = { factor = 5 }
	}
}

# The True Believers have gathered, now time to actually start the war
character_event = {
	id = HF.23115
	desc = EVTDESCHF23115
	picture = GFX_evt_riots_byzantine
	border = GFX_event_normal_frame_war

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		vassal_of = event_target:scoped_hellenic_emperor

		OR = {
			religion_group = christian
			religion_group = muslim
			religion_group = jewish_group
		}
	}

	option = {
		name = EVTOPTAHF23115

		set_character_flag = ai_flag_refuse_conversion

		event_target:scoped_hellenic_emperor = {
			character_event = { id = HF.23116 } # Notification to Emperor

			any_player = {
				limit = {
					vassal_of = PREV
					NOT = { character = PREV }
				}

				character_event = { id = HF.23116 } # Notification to other vassals
			}
		}

		hidden_effect = {
			set_defacto_liege = top_liege

			any_faction_backer = {
				faction = faction_abrahamic_revolters

				opinion = {
					name = opinion_charge_traitor
					who = event_target:scoped_hellenic_emperor
					years = 20
				}
			}
		}

		war = {
			target = liege
			casus_belli = abrahamic_antihellenic_revolt
			faction = faction_abrahamic_revolters
		}

		prestige = 500
		piety = 200
	}
}

# Notify players of the revolt
character_event = {
	id = HF.23116
	desc = EVTDESCHF23116
	picture = GFX_evt_riots_byzantine
	border = GFX_event_normal_frame_war

	is_triggered_only = yes
	hide_new = yes

	option = {
		name = {
			text = EVTOPTAHF23116
			trigger = { character = event_target:scoped_hellenic_emperor }
		}
		name = {
			text = EVTOPTBHF23116
			trigger = { NOT = { character = event_target:scoped_hellenic_emperor } }
		}
	}
}

# The Hellenic Emperor won, ensuring the rebirth of the faith
narrative_event = {
	id = HF.23117
	title = EVTTITLEHF23117
	desc = EVTDESCHF23117
	picture = GFX_evt_hellenic_temple
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23117

		trigger = { religion_openly_hellenic_or_reformed_trigger = yes }

		if = {
			limit = { character = FROMFROM } # The reformer

			custom_tooltip = {
				text = tooltip_peasants_become_hellenes

				any_demesne_province = {
					limit = {
						is_occupied = no
						owned_by = PREV
					}

					random = {
						chance = 50
						religion = FROMFROM
					}
				}

				any_courtier = {
					limit = { is_ruler = no }
					religion = FROMFROM
				}

				any_vassal = {
					limit = {
						NOT = { religion = FROMFROM }
						is_theocracy = no
					}

					character_event = { id = HF.23118 } # Second chance to convert
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23117

		trigger = { religion_openly_hellenic_or_reformed_trigger = no }
	}
}

# Vassals get a second chance to convert after the war
character_event = {
	id = HF.23118
	desc = EVTDESCAHF23118
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	prisoner = no
	only_capable = yes

	trigger = {
		is_inaccessible_trigger = no
	}

	option = { # Convert
		name = EVTOPTAHF23118

		custom_tooltip = {
			text = tooltip_HF23118_A

			# Workaround for automatic usurption of theocratic characters
			FROM = {
				religion_scope = {
					save_event_target_as = target_religion
				}
			}

			convert_religion_failsafe_effect = yes
			clr_character_flag = ai_flag_refuse_conversion

			if = {
				limit = {
					society_member_of = secret_religious_cult
					secret_religion = FROM
				}

				if = {
					limit = { secret_religion = hellenic_pagan }

					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_community
							owned_by = PREV
						}

						religion = hellenic_pagan
						remove_province_modifier = secret_hellenic_pagan_community
					}
				}
				else = {
					any_demesne_province = {
						limit = {
							has_province_modifier = secret_hellenic_pagan_reformed_community
							owned_by = PREV
						}

						religion = hellenic_pagan_reformed
						remove_province_modifier = secret_hellenic_pagan_reformed_community
					}
				}
			}

			if = {
				limit = { higher_tier_than = BARON }

				any_courtier_or_vassal = {
					limit = { is_theocracy = no }
					letter_event = { id = HF.23111 } # Keep going until the bottom
				}
			}
		}

		ai_chance = {
			factor = 50

			trigger = {
				is_theocracy = no

				NOR = {
					has_character_flag = ai_flag_refuse_conversion
					trait = zealous
					trait = stubborn
				}
			}

			mult_modifier = {
				factor = 0.25

				opinion = {
					who = FROM
					value < -30
				}
			}

			mult_modifier = {
				factor = 0.1
				trait = zealous
			}
		}
	}

	option = { # Do not Convert
		name = EVTOPTBHF23118

		ai_chance = {
			factor = 50

			mult_modifier = {
				factor = 0.25

				opinion = {
					who = FROM
					value >= -30
				}
			}

			mult_modifier = {
				factor = 0.1
				trait = cynical
			}
		}
	}
}

# Roman Renaissance: Christian moralizers
character_event = {
	id = HF.23119
	picture = GFX_evt_christian_exodus
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23119
		trigger = { religion_openly_hellenic_or_reformed_trigger = yes }
	}
	desc = {
		text = EVTDESCBHF23119
		trigger = {
			NOT = { religion_group = christian }
			religion_openly_hellenic_or_reformed_trigger = no
		}
	}
	desc = {
		text = EVTDESCCHF23119
		trigger = { religion_group = christian }
	}

	is_triggered_only = yes

	option = { # Issue celebrations to facilitate cultural shift
		name = {
			text = EVTOPTAHF23119_A
			trigger = { religion_openly_hellenic_or_reformed_trigger = yes }
		}
		name = {
			text = EVTOPTAHF23119_B
			trigger = {
				NOT = { religion_group = christian }
				religion_openly_hellenic_or_reformed_trigger = no
			}
		}
		name = {
			text = EVTOPTAHF23119_C
			trigger = { religion_group = christian }
		}

		custom_tooltip = {
			text = tooltip_HF23119_A

			any_realm_province = {
				limit = {
					distance = {
						where = c_roma
						distance < 300
					}

					held_under_PREV = yes
				}

				random = {
					chance = 25

					if = {
						limit = { culture_group = latin }
						culture = roman
					}
				}

				random = {
					chance = 25

					if = {
						limit = {
							culture = roman
							ROOT = { religion_openly_hellenic_or_reformed_trigger = yes }
						}

						religion = ROOT
					}
				}
			}

			c_roma = {
				location = {
					province_event = {
						id = HF.23121 # Embracing debauchery causes the Bacchants to reappear
						days = 300
						random = 300
					}
				}
			}
		}

		scaled_wealth = {
			value = -0.5
			min = -150
			max = -300
		}

		if = {
			limit = { religion_group = christian }
			tiered_piety_negative_effect = yes
		}
	}

	option = { # Apologize to the priests
		name = {
			text = EVTOPTBHF23119_A
			trigger = { religion_openly_hellenic_or_reformed_trigger = yes }
		}
		name = {
			text = EVTOPTBHF23119_B
			trigger = {
				NOR = {
					religion_openly_hellenic_or_reformed_trigger = yes
					religion_group = christian
				}
			}
		}
		name = {
			text = EVTOPTBHF23119_C
			trigger = {
				religion_group = christian
			}
		}

		if = {
			limit = { religion_group = christian }
			tiered_piety_reward_effect = yes
		}
	}
}

#######################
# Myrmidons - Hellenic Holy Order
#######################
# Notification event
narrative_event = {
	id = HF.23120
	title = d_myrmidons
	desc = EVTDESCHF23120
	picture = GFX_evt_hellenic_temple

	is_triggered_only = yes
	hide_from = yes

	option = {
		name = {
			text = EVTOPTA_HO_100
			trigger = { religion = hellenic_pagan_reformed }
		}
		name = {
			text = EVTOPTB_HO_100
			trigger = {
				religion_group = pagan_group
				NOT = { religion = hellenic_pagan_reformed }
			}
		}
		name = {
			text = EVTOPTC_HO_100
			trigger = {
				NOT = { religion_group = pagan_group }
			}
		}
	}
}

#######################
# The Rise of the Bacchants
#######################

# Rome: Province event to spread the secret cult (fired either after a victorious Hellenic Civil War or after delving in the classics)
province_event = {
	id = HF.23121

	is_triggered_only = yes
	hide_window = yes

	has_dlc = "Mystics"

	trigger = {
		NOR = {
			has_game_rule = {
				name = devil_worshipers
				value = none
			}

			# Not if somebody else did it in the meantime
			is_society_rank_full = {
				society = the_bacchants
				rank = 4
			}
		}
	}

	immediate = {
		set_global_flag = flag_restored_bacchants

		# Setup the Grand Magus
		create_character = {
			random_traits = yes
			dynasty = random
			religion = FROM
			culture = roman
			female = 50
			age = 26
		}

		new_character = {
			add_trait = hedonist
			join_society = the_bacchants
			set_society_grandmaster = yes
			add_society_currency_massive_effect = yes
			add_society_currency_massive_effect = yes

			if = {
				limit = { hellenic_pagan = { has_flag = has_been_reformed } }
				religion = hellenic_pagan_reformed
			}
			else = {
				religion = hellenic_pagan
			}
		}

		# Setup the Followers
		while = {
			count = 5

			random_playable_ruler = {
				limit = {
					has_bacchants_prerequisites = yes
					is_adult = yes
					ai = yes
					controls_religion = no
				}

				preferred_limit = {
					trait = hedonist
					culture = roman
					religion_openly_hellenic_or_reformed_trigger = yes
					lower_real_tier_than = KING
				}

				preferred_limit = {
					trait = hedonist
					religion_openly_hellenic_or_reformed_trigger = yes
					lower_real_tier_than = KING
				}

				preferred_limit = {
					trait = hedonist
					religion_openly_hellenic_or_reformed_trigger = yes
				}

				preferred_limit = {
					religion_openly_hellenic_or_reformed_trigger = yes
				}

				preferred_limit = {
					religion_secretly_hellenic_or_reformed_trigger = yes
				}

				join_society = the_bacchants
				add_society_currency_medium_effect = yes
			}
		}

		any_player = {
			limit = {
				OR = {
					religion_openly_hellenic_or_reformed_trigger = yes
					is_within_diplo_range = FROM
				}
			}

			narrative_event = { id = HF.23122 }
		}
	}
}

# Players notified
narrative_event = {
	id = HF.23122
	title = EVTTITLEHF23122
	desc = EVTDESCHF23122
	picture = GFX_evt_bacchants_initiation

	is_triggered_only = yes
	hide_from = yes
	hide_new = yes

	option = {
		name = {
			text = EVTOPTAHF23122
			trigger = { society_member_of = the_bacchants }
		}
		name = {
			text = EVTOPTBHF23122
			trigger = {
				NOT = { society_member_of = the_bacchants }
			}
		}
	}
}

# Players notified
narrative_event = {
	id = HF.23123
	title = EVTTITLEHF23123
	desc = EVTDESCHF23123
	picture = GFX_evt_library

	is_triggered_only = yes # create_stoics, HF_religious_decisions.txt
	hide_from = yes
	hide_new = yes

	ai = no

	option = {
		name = EVTOPTAHF23123

		trigger = {
			OR = {
				society_member_of = monastic_order_stoics
				religion_openly_hellenic_or_reformed_trigger = yes
				religion_secretly_hellenic_or_reformed_trigger = yes
				can_join_society = monastic_order_stoics
			}
		}

		if = {
			limit = {
				NOT = { society_member_of = monastic_order_stoics }
				can_join_society = monastic_order_stoics
			}

			join_society = monastic_order_stoics
		}
	}

	option = {
		name = EVTOPTBHF23123

		trigger = {
			NOT = { society_member_of = monastic_order_stoics }
			religion_openly_hellenic_or_reformed_trigger = no
			religion_secretly_hellenic_or_reformed_trigger = no
		}
	}
}

# POWER: Culture Convert County
# Notification for ruler who performs the power
character_event = {
	id = HF.23124
	picture = GFX_evt_hippodrome_byzantine
	desc = EVTDESCHF23124
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes # stoic_order_culture_convert_county, HF_religious_decisions.txt
	notification = yes

	ai = no

	option = {
		name = EXCELLENT
	}
}

# Notification event for county owner if different from user
character_event = {
	id = HF.23125
	picture = GFX_evt_hippodrome_byzantine
	desc = EVTDESCHF23125
	border = GFX_event_normal_frame_diplomacy

	is_triggered_only = yes # stoic_order_culture_convert_county, HF_religious_decisions.txt

	ai = no

	option = {
		name = I_SEE
	}
}

####################################################################################################

### Hellenic Dedicated Temples
## Ruler decides whom to dedicate the temple to
# First determine which kind of god you are interested in
character_event = {
	id = HF.23200
	desc = EVTDESCHF23200
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # The Three brothers
		name = EVTOPTAHF23200

		character_event = {
			id = HF.23201
			tooltip = EVTOPTAHF23200_TT
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.25

				has_education_diplomacy_trigger = no
				has_lifestyle_diplomacy_trigger = no

				NOR = {
					trait = proud
					trait = ambitious
					trait = lunatic
					trait = stubborn
					trait = envious
				}
			}

		}
	}

	option = { # The Gods of War
		name = EVTOPTBHF23200

		character_event = {
			id = HF.23202
			tooltip = EVTOPTBHF23200_TT
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.25

				has_education_martial_trigger = no
				has_lifestyle_martial_trigger = no

				NOR = {
					trait = wroth
					trait = brave
				}
			}
		}
	}

	option = { # The Goddesses of Prosperity
		name = EVTOPTCHF23200

		character_event = {
			id = HF.23203
			tooltip = EVTOPTCHF23200_TT
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.25

				has_benevolent_trait_trigger = no
				has_education_stewardship_trigger = no
				has_lifestyle_stewardship_trigger = no
			}
		}
	}

	option = { # The Heavenly Twins
		name = EVTOPTDHF23200

		character_event = {
			id = HF.23204
			tooltip = EVTOPTDHF23200_TT
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.25

				is_pious_trigger = no
				has_pleasant_trait_trigger = no
				has_education_learning_trigger = no
				has_lifestyle_learning_trigger = no

				NOR = {
					trait = celibate
					trait = scholar
				}
			}
		}
	}
}

# The Three Brothers
character_event = {
	id = HF.23201
	desc = EVTDESCHF23201
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # Zeus
		name = EVTOPTAHF23201

		wealth = -250
		piety = -200

		add_character_modifier = {
			name = dedicated_to_zeus
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_zeus
			add_building = tp_shrine_zeus
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = lustful
			}
		}
	}

	option = { # Poseidon
		name = EVTOPTBHF23201


		wealth = -250
		piety = -200

		add_character_modifier = {
			name = dedicated_to_poseidon
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_poseidon
			add_building = tp_shrine_poseidon
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = wroth
			}
		}
	}

	option = { # Hades
		name = EVTOPTCHF23201


		wealth = -250
		piety = -200

		add_character_modifier = {
			name = dedicated_to_hades
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_hades
			add_building = tp_shrine_hades
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = greedy
			}
		}
	}

	option = {
		name = EVTOPT_TEMPLE_BACK_TO_SELECTION

		character_event = {
			id = HF.23200
			tooltip = EVTOPT_TEMPLE_BACK_TO_SELECTION_TT
		}
	}
}

# The Gods of War
character_event = {
	id = HF.23202
	desc = EVTDESCHF23202
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # Athena
		name = EVTOPTAHF23202

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_athena
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_athena
			add_building = tp_shrine_athena
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = patient
			}
		}
	}

	option = { # Ares
		name = EVTOPTBHF23202

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_ares
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_ares
			add_building = tp_shrine_ares
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = wroth
			}
		}
	}

	option = { # Ephaestus
		name = EVTOPTCHF23202

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_ephaestus
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_ephaestus
			add_building = tp_shrine_ephaestus
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = envious
			}
		}
	}

	option = {
		name = EVTOPT_TEMPLE_BACK_TO_SELECTION

		character_event = {
			id = HF.23200
			tooltip = EVTOPT_TEMPLE_BACK_TO_SELECTION_TT
		}
	}
}

# The Goddesses of Prosperity
character_event = {
	id = HF.23203
	desc = EVTDESCHF23203
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # Hestia
		name = EVTOPTAHF23203

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_hestia
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_hestia
			add_building = tp_shrine_hestia
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = kind
			}
		}
	}

	option = { # Demeter
		name = EVTOPTBHF23203

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_demeter
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_demeter
			add_building = tp_shrine_demeter
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = charitable
			}
		}
	}

	option = { # Aphrodite
		name = EVTOPTCHF23203

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_aphrodite
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_aphrodite
			add_building = tp_shrine_aphrodite
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = lustful
			}
		}
	}

	option = {
		name = EVTOPT_TEMPLE_BACK_TO_SELECTION

		character_event = {
			id = HF.23200
			tooltip = EVTOPT_TEMPLE_BACK_TO_SELECTION_TT
		}
	}
}

# The Heavenly Twins
character_event = {
	id = HF.23204
	desc = EVTDESCHF23204
	picture = GFX_evt_hellenic_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = { # Apollo
		name = EVTOPTAHF23204

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_apollo
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_apollo
			add_building = tp_shrine_apollo
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = kind
			}
		}
	}

	option = { # Arthemis
		name = EVTOPTBHF23204

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_arthemis
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_arthemis
			add_building = tp_shrine_arthemis
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = charitable
			}
		}
	}

	option = { # Hermes
		name = EVTOPTDHF23203

		if = {
			limit = { ai = no }
			wealth = -250
		}

		piety = -200

		add_character_modifier = {
			name = dedicated_to_hermes
			years = 10
			stacking = yes # In case a player invests enough money to dedicate multiple temples within a lifetime
		}

		event_target:scoped_temple_barony = {
			show_scope_change = no

			set_title_flag = flag_dedicated_to_hermes
			add_building = tp_shrine_hermes
		}

		clr_character_flag = flag_dedicating_temple

		add_character_modifier = {
			name = recently_dedicated_temple_cooldown
			days = 1250
			hidden = yes
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = deceitful
			}
		}
	}

	option = {
		name = EVTOPT_TEMPLE_BACK_TO_SELECTION

		character_event = {
			id = HF.23200
			tooltip = EVTOPT_TEMPLE_BACK_TO_SELECTION_TT
		}
	}
}

# on_startup: Hidden event on AltStart applying the Cosmopolitan/Dogmatic effects on customized religions
character_event = {
	id = HF.23205

	is_triggered_only = yes # on_startup
	hide_window = yes

	trigger = {
		owns = event_target:pulse_province
		is_save_game = no
	}

	immediate = {
		random_playable_ruler = {
			limit = { religion = catholic }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = orthodox }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = miaphysite }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = nestorian }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = sunni }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = shiite }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = ibadi }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = jewish }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = samaritan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = karaite }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = hindu }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = buddhist }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = jain }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = taoist }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = zoroastrian }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = mazdaki }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = manichaean }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = khurmazta }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = bon_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = aztec_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = norse_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = zun_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = slavic_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = baltic_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = west_african_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = tengri_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = finnish_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}

		random_playable_ruler = {
			limit = { religion = hellenic_pagan }

			if = {
				limit = { has_religion_feature = religion_cosmopolitan }
				apply_cosmopolian_on_start_effect = yes
			}
			else_if = {
				limit = { has_religion_feature = religion_dogmatic }
				apply_dogmatic_on_start_effect = yes
			}
		}
	}
}

##################################################################################################

### Synergic Doctrines flavor

## Special raider events (traits gained by having Daring + Seafaring)

# on_looting_settlement: Gaining Thralls
character_event = {
	id = HF.23207
	desc = EVTDESCHF23207
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	has_dlc = "Holy Fury"

	trigger = {
		this_is_sea_raider_trigger = yes

		FROM = {
			is_capital = yes # Do not reiterate the event after taking the capital holding
			is_tribal = no
			is_nomadic = no
		}
	}

	# Sacrifice to improve MA
	# Sell for money
	# Put to use (stacking capital building modifier/increasing revolt risk)

	option = {
		name = EVTOPTAHF23207

		trigger = {
			OR = {
				religion_openly_aztec_or_reformed_trigger = yes
				has_religion_feature = religion_ritual_sacrifice
			}

			FROM = {
				location = {
					NOT = { religion = ROOT } # Only if province is of some other religion
				}
			}
		}

		FROM = {
			holder_scope = {
				character_event = { id = HF.23208 } # Notify owner
			}
		}

		add_blood_splatter_effect = yes

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = {
						ROOT = {
							show_scope_change = no

							piety = 150

							religion_authority = {
								name = great_sacrifice_positive
								years = 150
							}

							hidden_effect = {
								change_variable = {
									which = burned_hearts_points
									value = 2
								}

								bloodthirsty_tiered_traits_effect = yes
							}
						}
					}

					4 = {
						ROOT = {
							show_scope_change = no


							piety = 100

							religion_authority = {
								name = great_sacrifice_positive
								years = 100
							}

							hidden_effect = {
								change_variable = {
									which = burned_hearts_points
									value = 1
								}

								bloodthirsty_tiered_traits_effect = yes
							}
						}
					}

					2 = {
						ROOT = {
							show_scope_change = no

							piety = 50

							religion_authority = {
								name = great_sacrifice_positive
								years = 50
							}

							hidden_effect = {
								bloodthirsty_tiered_traits_effect = yes
							}
						}
					}

					fallback = {
						ROOT = {
							show_scope_change = no

							piety = 25

							religion_authority = {
								name = great_sacrifice_positive
								years = 25
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23207

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = { ROOT = { show_scope_change = no wealth = 300 } }
					4 = { ROOT = { show_scope_change = no wealth = 200 } }
					2 = { ROOT = { show_scope_change = no wealth = 100 } }
					fallback = { ROOT = { show_scope_change = no wealth = 50 } }
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23207

		trigger = { higher_real_tier_than = BARON }

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = { ROOT = { show_scope_change = no capital_scope = { show_scope_change = no add_lots_thralls_capital_effect = yes } } }
					3 = { ROOT = { show_scope_change = no capital_scope = { show_scope_change = no add_some_thralls_capital_effect = yes } } }
					fallback = { ROOT = { show_scope_change = no capital_scope = { show_scope_change = no add_few_thralls_capital_effect = yes } } }
				}
			}
		}
	}
}

# Owner of province is notified of great sacrifice
character_event = {
	id = HF.23208
	desc = EVTDESCHF23208
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { FROM = { is_female = no } }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23208

		trigger = {
			NOT = { religion = FROM }
		}

		FROMFROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = {
						ROOT = {
							show_scope_change = no

							religion_authority = {
								name = great_sacrifice_negative
								years = 150
							}
						}
					}

					4 = {
						ROOT = {
							show_scope_change = no

							religion_authority = {
								name = great_sacrifice_negative
								years = 100
							}
						}
					}

					2 = {
						ROOT = {
							show_scope_change = no

							religion_authority = {
								name = great_sacrifice_negative
								years = 50
							}
						}
					}

					fallback = {
						ROOT = {
							show_scope_change = no

							religion_authority = {
								name = great_sacrifice_negative
								years = 25
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23208

		trigger = { religion = FROM }
	}
}

# on_looting_settlement: Rounded up cattle
character_event = {
	id = HF.23209
	desc = EVTDESCHF23209
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes # on_loot_settlement

	has_dlc = "Holy Fury"

	trigger = {
		this_is_sea_raider_trigger = yes

		FROM = {
			is_capital = yes # Do not reiterate the event after taking the capital holding
			is_tribal = no
			is_nomadic = no
		}
	}

	# Sacrifice to the gods
	# Sell for money
	# Share with troops

	option = {
		name = EVTOPTAHF23209

		add_blood_splatter_effect = yes

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = { ROOT = { show_scope_change = no piety = 100 } }
					4 = { ROOT = { show_scope_change = no piety = 75 } }
					2 = { ROOT = { show_scope_change = no piety = 50 } }
					fallback = { ROOT = { show_scope_change = no piety = 25 } }
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23209

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = { ROOT = { show_scope_change = no wealth = 100 } }
					4 = { ROOT = { show_scope_change = no wealth = 75 } }
					2 = { ROOT = { show_scope_change = no wealth = 50 } }
					fallback = { ROOT = { show_scope_change = no wealth = 25 } }
				}
			}
		}
	}

	option = {
		name = EVTOPTCHF23209

		FROM = {
			show_scope_change = no

			location = {
				show_scope_change = no

				trigger_switch = {
					on_trigger = num_of_settlements

					6 = {
						ROOT = {
							show_scope_change = no

							prestige = 150

							add_character_modifier = {
								name = pillagers_morale
								years = 10
								stacking = yes
							}
						}
					}

					4 = {
						ROOT = {
							show_scope_change = no

							prestige = 100

							add_character_modifier = {
								name = pillagers_morale
								years = 5
								stacking = yes
							}
						}
					}

					2 = {
						ROOT = {
							show_scope_change = no

							prestige = 75

							add_character_modifier = {
								name = pillagers_morale
								years = 5
								stacking = yes
							}
						}
					}

					fallback = {
						ROOT = {
							show_scope_change = no

							prestige = 50

							add_character_modifier = {
								name = pillagers_morale
								years = 5
								stacking = yes
							}
						}
					}
				}
			}
		}
	}
}

# on_looted_settlement: Destroying large city as a Ravager/Seaking
character_event = {
	id = HF.23210
	desc = EVTDESCHF23210
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes # on_loot_settlement

	has_dlc = "Holy Fury"

	trigger = {
		OR = {
			trait = ravager
			trait = sea_king
			trait = sea_queen
		}

		FROM = {
			is_capital = yes # Do not reiterate the event after taking the capital holding
			is_tribal = no
			is_nomadic = no

			location = {
				is_coastal = yes # Coastal provinces are what the Seaking should be terrorizing
				num_of_settlements >= 5 # Only fires for big cities

				ROOT = {
					# Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to
					any_realm_province = {
						is_coastal = yes
						can_naval_path_to = PREVPREV
						TECH_NAVAL >= 1
						held_under_PREV = yes

						OR = {
							has_building = tb_shipyard_1
							has_building = ca_shipyard_1
							has_building = tp_shipyard_1
							has_building = ct_shipyard_1
						}
					}
				}
			}
		}
	}

	# Burn it all to the ground
	# Steal weapons and tools
	# Scare villagers into telling tales of your fearsome army (Prestige)
	# Nothing

	option = { # Destroy
		name = EVTOPTAHF23210

		add_blood_splatter_effect = yes

		random = {
			chance = 5

			mult_modifier = {
				factor = 5
				trait = kind
			}

			add_trait_partially_cruel_effect = yes
		}

		if = {
			limit = { trait = ravager }

			custom_tooltip = {
				text = TOOLTIP_EVTOPTAHF23210


				FROM = {
					while = {
						count = 2
						destroy_random_building = THIS
					}

					add_holding_modifier = {
						name = recently_burnt_the_land
						months = 7
					}
				}
			}
		}
		else_if = {
			limit = {
				OR = {
					trait = sea_king
					trait = sea_queen
				}
			}

			custom_tooltip = {
				text = TOOLTIP_EVTOPTAHF23210

				FROM = {
					while = {
						count = 5
						destroy_random_building = THIS
					}

					add_holding_modifier = {
						name = recently_burnt_the_land
						months = 20
					}
				}
			}
		}

		hidden_effect = {
			change_variable = {
				which = viking_raids # Exp bump
				value = 5
			}

			if = {
				limit = {
					FROM = {
						num_of_buildings == 0
					}
				}

				FROM = {
					location = {
						province_event = {
							id = HF.23211 # Inform owner that his holding has been destroyed
							days = 1
						}
					}

					destroy_settlement = THIS
				}
			}
		}
	}

	option = { # Steal
		name = EVTOPTBHF23210

		if = {
			limit = { trait = ravager }

			wealth = 100

			if = {
				limit = {
					FROM = {
						location = {
							has_higher_tech_than = ROOT
						}
					}
				}

				military_techpoints = 25
			}
		}
		else_if = {
			limit = {
				OR = {
					trait = sea_king
					trait = sea_queen
				}
			}

			wealth = 200

			if = {
				limit = {
					FROM = {
						location = {
							has_higher_tech_than = ROOT
						}
					}
				}

				military_techpoints = 50
			}
		}
	}

	option = { # Scare
		name = EVTOPTCHF23210

		if = {
			limit = { trait = ravager }
			prestige = 150
		}
		else_if = {
			limit = {
				OR = {
					trait = sea_king
					trait = sea_queen
				}
			}
			prestige = 300
		}

		hidden_effect = {
			change_variable = {
				which = viking_raids # Exp bump
				value = 4
			}
		}
	}

	option = { # Nothing
		name = EVTOPTDHF23210

		ai_chance = { factor = 0 }
	}
}

# Owner of province is notified of destruction of settlement
province_event = {
	id = HF.23211
	desc = EVTDESCHF23211
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { FROM = { is_female = no } }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23211

		owner = {
			show_scope_change = no

			opinion = {
				name = blasphemous_pyromaniac
				who = FROM
				years = 20
			}
		}
	}
}


# on_looted_settlement: Bloodline gained at 200 viking_raids variable
narrative_event = {
	id = HF.23212
	title = EVTTITLE23212
	border = GFX_event_narrative_frame_war
	sound = bloodline_added

	desc = {
		text = EVTDESCAHF23212
		trigger = {
			religion_openly_norse_or_reformed_trigger = yes
			is_female = no
			is_alternate_start = no
		}
	}
	desc = {
		text = EVTDESCBHF23212
		trigger = {
			religion_openly_norse_or_reformed_trigger = yes
			is_female = yes
			is_alternate_start = no
		}
	}
	desc = {
		text = EVTDESCCHF23212
		trigger = {
			OR = {
				is_alternate_start = yes
				religion_openly_norse_or_reformed_trigger = no
			}
		}
	}

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes # on_loot_settlement

	has_dlc = "Holy Fury"

	trigger = {
		check_variable = {
			which = viking_raids
			value >= 200
		}

		OR = {
			trait = sea_king
			trait = sea_queen
		}

		NOT = {
			any_owned_bloodline = {
				OR = {
					has_bloodline_flag = bloodline_historical_norse # Not already has a Viking bloodline
					has_bloodline_flag = more_raiders_bloodline # Not already has a this bloodline
				}

				bloodline_is_active_for = PREV
			}
		}
	}

	option = {
		name = EVTOPTAHF23212

		add_blood_splatter_effect = yes # Dramatic effect

		hidden_effect = {
			if = {
				limit = { this_has_super_cool_nickname_trigger = no }

				random_list = {
					20 = {
						trigger = { practical_age >= 50 }
						give_nickname = nick_the_white_raven
					}

					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_salt_snake
					}

					20 = {
						trigger = { is_female = yes }
						give_nickname = nick_the_salt_viper
					}

					20 = {
						trigger = {
							is_female = yes
							is_attractive_trigger = yes
						}

						give_nickname = nick_the_siren
					}

					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_wyrm
					}

					20 = {
						trigger = {
							is_female = yes
							is_unattractive_trigger = yes
						}

						give_nickname = nick_the_fury
					}

					20 = {
						trigger = { is_female = no }
						give_nickname = nick_the_sea_devil
					}

					10 = { give_nickname = nick_the_stormforged }
					10 = { give_nickname = nick_the_tempest_of_capital }
				}
			}
		}

		if = {
			limit = { is_female = no }

			create_bloodline = { type = sea_king_bloodline }
			set_bloodline_founder_religion_flag_effect = yes

			# Randomize names to avoid too much repetition
			if = {
				limit = { religion_openly_norse_or_reformed_trigger = yes }

				new_bloodline = {
					set_description = bloodline_desc_sea_king_bloodline_viking

					random_list = {
						25 = { set_name = bloodline_sea_king_viking_random_a }
						25 = { set_name = bloodline_sea_king_viking_random_b }
						25 = { set_name = bloodline_sea_king_viking_random_c }
						25 = { set_name = bloodline_sea_king_viking_random_d }
					}
				}
			}
			else = {
				new_bloodline = {
					set_description = bloodline_desc_sea_king_bloodline_pirate

					random_list = {
						25 = { set_name = bloodline_sea_king_pirate_random_a }
						25 = { set_name = bloodline_sea_king_pirate_random_b }
						25 = { set_name = bloodline_sea_king_pirate_random_c }
						25 = { set_name = bloodline_sea_king_pirate_random_d }
					}
				}
			}
		}
		else = {
			create_bloodline = { type = seaqueen_bloodline }
			set_bloodline_founder_religion_flag_effect = yes

			# Randomize names to avoid too much repetition
			if = {
				limit = { religion_openly_norse_or_reformed_trigger = yes }

				new_bloodline = {
					set_description = bloodline_desc_sea_king_bloodline_viking

					random_list = {
						25 = { set_name = bloodline_seaqueen_viking_random_a }
						25 = { set_name = bloodline_seaqueen_viking_random_b }
						25 = { set_name = bloodline_seaqueen_viking_random_c }
						25 = { set_name = bloodline_seaqueen_viking_random_d }
					}
				}
			}
			else = {
				new_bloodline = {
					set_description = bloodline_desc_sea_king_bloodline_pirate

					random_list = {
						25 = { set_name = bloodline_seaqueen_pirate_random_a }
						25 = { set_name = bloodline_seaqueen_pirate_random_b }
						25 = { set_name = bloodline_seaqueen_pirate_random_c }
						25 = { set_name = bloodline_seaqueen_pirate_random_d }
					}
				}
			}
		}

		hidden_effect = {
			if = {
				limit = {
					NOR = {
						trait = african_tattoo_1
						trait = african_tattoo_2
						trait = african_tattoo_3
						trait = african_tattoo_4
						trait = african_tattoo_5
						trait = african_tattoo_6
						trait = african_tattoo_7
						trait = african_tattoo_8
						trait = slavic_tattoo_1
						trait = slavic_tattoo_2
						trait = slavic_tattoo_3
						trait = slavic_tattoo_4
						trait = slavic_tattoo_5
						trait = slavic_tattoo_6
						trait = norse_tattoo_1
						trait = norse_tattoo_2
						trait = norse_tattoo_3
						trait = norse_tattoo_4
						trait = norse_tattoo_5
						trait = norse_tattoo_6
					}
				}

				add_trait = norse_tattoo_4
			}
		}

		any_player = {
			limit = {
				is_within_diplo_range = ROOT
				NOT = { character = ROOT }
			}

			narrative_event = { id = HF.23213 }
		}
	}
}

# Other players are notified
narrative_event = {
	id = HF.23213
	title = EVTTITLE23213
	desc = EVTDESCHF23213
	border = GFX_event_narrative_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { FROM = { is_female = no } }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23213

		trigger = {
			OR = {
				religion_openly_norse_or_reformed_trigger = yes

				AND = {
					has_religion_feature = religion_adventuring
					has_religion_feature = religion_seafaring
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23213

		trigger = {
			religion_openly_norse_or_reformed_trigger = no

			NAND = {
				has_religion_feature = religion_adventuring
				has_religion_feature = religion_seafaring
			}
		}
	}
}

# on_loot_settlement: Stumbling on small mercenary band
character_event = {
	id = HF.23214
	desc = EVTDESCAHF23214
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes # on_loot_settlement

	has_dlc = "Holy Fury"

	trigger = {
		this_is_sea_raider_trigger = yes
		is_landed = yes

		# Don't let another band spawn when the previous is still employed
		NOR = {
			has_earmarked_regiments = pirate_mercenaries_perm
			has_earmarked_regiments = pirate_mercenaries
		}

		FROM = {
			is_capital = yes # Do not reiterate the event after taking the capital holding
			is_tribal = no
			is_nomadic = no

			location = {
				num_of_settlements >= 4 # Only fires for medium to big cities
				is_coastal  = yes # Coastal provinces are what the Seaking should be terrorizing

				# Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to
				ROOT = {
					any_realm_province = {
						is_coastal = yes
						can_naval_path_to = PREVPREV
						TECH_NAVAL >= 1
						held_under_PREV = yes

						OR = {
							has_building = tb_shipyard_1
							has_building = ca_shipyard_1
							has_building = tp_shipyard_1
							has_building = ct_shipyard_1
						}
					}
				}
			}
		}
	}

	immediate = {
		FROM = {
			location = { save_event_target_as = scoped_spawning_point }
			owner = { save_event_target_as = scoped_province_owner }
		}

		# Decide mercenary leader's sex
		random_list = {
			70 = {
				trigger = {
					event_target:scoped_province_owner = {
						NOT = { has_religion_feature = religion_matriarchal }
					}
				}

				create_random_soldier = {
					random_traits = yes
					dynasty = random
					culture = event_target:scoped_spawning_point
					religion = event_target:scoped_spawning_point
					female = no

					attributes = {
						diplomacy = 2
						learning = 2
						stewardship = 2
						intrigue = 2
						martial = 8
					}
				}
			}

			30 = {
				trigger = {
					event_target:scoped_province_owner = {
						OR = {
							has_law = status_of_women_4
							has_religion_feature = religion_matriarchal
							has_religion_feature = religion_equal
							has_religion_feature = religion_feature_bon
							has_gender_equal_game_rule_trigger = yes
						}
					}
				}

				create_random_soldier = {
					random_traits = yes
					dynasty = random
					culture = event_target:scoped_spawning_point
					religion = event_target:scoped_spawning_point
					female = yes

					attributes = {
						diplomacy = 2
						learning = 2
						stewardship = 2
						intrigue = 2
						martial = 8
					}
				}
			}
		}

		new_character = {
			diplomatic_immunity = yes # Temporary
			add_trait = adventurer
			save_event_target_as = scoped_pirate_mercenary
			set_character_flag = flag_special_event_character # Prevent the character from being kicked out
			move_character = event_target:scoped_province_owner

			random = {
				chance = 1
				add_trait = homosexual
			}
		}
	}

	# Seduce leader
	# Fight leader for supremacy
	# Sway with money
	# Let them go

	option = { # Seduce
		name = EVTOPTAHF23214

		trigger = {
			event_target:scoped_pirate_mercenary = {
				root_attraction_trigger = yes
			}

			NOT = { trait = celibate }
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23214

			event_target:scoped_pirate_mercenary = {
				move_character = ROOT
			}

			random_list = {
				70 = {
					trigger = {
						event_target:scoped_pirate_mercenary = {
							attracted_to_root_trigger = yes
						}
					}

					mult_modifier = {
						factor = 1.5
						has_attractive_trait_trigger = yes
					}

					mult_modifier = {
						factor = 1.5
						is_strong_trigger = yes
					}

					mult_modifier = {
						factor = 0.5
						has_unattractive_trait_trigger = yes
					}

					mult_modifier = {
						factor = 0.5
						is_weak_trigger = yes
					}

					mult_modifier = {
						factor = 1.5
						trait = master_seducer
					}

					mult_modifier = {
						factor = 1.5
						trait = master_seductress
					}

					mult_modifier = {
						factor = 1.25
						trait = lustful
					}

					mult_modifier = {
						factor = 0.75
						trait = chaste
					}

					mult_modifier = {
						factor = 0.75
						trait = shy
					}

					mult_modifier = {
						factor = 0.75
						trait = slow
					}

					mult_modifier = {
						factor = 0.5
						trait = imbecile
					}

					mult_modifier = {
						factor = 0.75
						practical_age >= 40
					}

					mult_modifier = {
						factor = 0.5
						practical_age >= 50
					}

					character_event = { id = HF.23215 } # Success!
				}

				30 = {
					trigger = {
						trigger_if = {
							limit = {
								event_target:scoped_pirate_mercenary = {
									attracted_to_root_trigger = yes
								}
							}

							OR = {
								is_attractive_trigger = no
								practical_age >= 40
							}
						}
					}

					character_event = { id = HF.23216 } # Failure!
				}
			}
		}

		ai_chance = { factor = 20 }
	}

	option = { # Duel
		name = EVTOPTCHF23214
		tooltip_info = combat_rating

		trigger = { combat_rating >= 15 }

		custom_tooltip = {
			text = TOOLTIP_EVTOPTCHF23214

			# REQUIRED event targets for setting up duel evaluation!
			save_event_target_as = combatant_1 # The person issuing the duel...
			set_character_flag = flag_pirate_fighting_mercenary_leader # Needed for follow-up event in case of victory
			set_character_flag = flag_duel_no_draws # Prevents duel from ending in a draw

			event_target:scoped_pirate_mercenary = {
				set_character_flag = flag_duel_no_backsies # Make the challenged party unable to decline the duel
				set_character_flag = flag_duel_no_draws # Prevents duel from ending in a draw
				save_event_target_as = combatant_2 # The target of the duel...
				character_event = { id = HFP.10095 }
			}
		}

		pacifists_lose_piety_effect = yes

		add_character_modifier = {
			name = recent_duel_timer
			years = 1
			hidden = yes
		}

		ai_chance = {
			factor = 20

			trigger = {
				NOT = { trait = craven }
			}
		}
	}

	option = { # Pay
		name = EVTOPTDHF23214

		custom_tooltip = {
			text = TOOLTIP_EVTOPTDHF23214

			event_target:scoped_pirate_mercenary = {
				show_scope_change = no

				diplomatic_immunity = no
				move_character = ROOT
			}
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1
				min = -150
				max = -250
			}
		}

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			leader = event_target:scoped_pirate_mercenary
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries
			cannot_inherit = yes
			is_looter = yes
			can_toggle_looting = no
		}

		character_event = {
			id = HF.23217 # Disband
			days = 350
			random = 50
		}

		ai_chance = { factor = 20 }
	}

	option = { # Let the thugs go
		name = EVTOPTEHF23214

		custom_tooltip = {
			text = TOOLTIP_EVTOPTEHF23214

			event_target:scoped_pirate_mercenary = {
				death = { death_reason = death_missing }
			}
		}

		ai_chance = { factor = 0 }
	}
}

# Pirate was able to seduce mercenary
character_event = {
	id = HF.23215
	border = GFX_event_normal_frame_war

	desc = {
		text = EVTDESCAHF23215
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	desc = {
		text = EVTDESCBHF23215
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	# Kill mercenary in his sleep, take over (troops do not disband)
	# Declare love (troops do not disband)
	# Get troops for free (troops are timed)

	option = { # Kill and take over
		name = EVTOPTAHF23215
		tooltip_info = deceitful

		trigger = { trait = deceitful }

		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23215 }

		add_trait_partially_silently_cruel_effect = yes
		tiered_piety_negative_effect = yes

		event_target:scoped_pirate_mercenary = {
			show_scope_change = no

			hidden_effect = { diplomatic_immunity = no }

			death = {
				death_reason = death_murder
				killer = ROOT
			}
		}

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			leader = event_target:scoped_pirate_mercenary
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries_perm
			cannot_inherit = yes
			is_looter = yes
		}

		ai_chance = { factor = 20 }
	}

	option = { # Become lover
		name = EVTOPTBHF23215
		tooltip_info = lustful

		trigger = {
			trait = lustful
			num_of_lovers < 3
		}

		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23215 }

		add_trait_partially_silently_kind_effect = yes
		add_lover = event_target:scoped_pirate_mercenary
		tiered_prestige_negative_effect = yes

		hidden_effect = {
			event_target:scoped_pirate_mercenary = {
				diplomatic_immunity = no
			}
		}

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			leader = event_target:scoped_pirate_mercenary
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries_perm
			cannot_inherit = yes
			is_looter = yes
		}

		ai_chance = { factor = 20 }
	}

	option = { # Hire
		name = EVTOPTCHF23215

		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23215 }

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			leader = event_target:scoped_pirate_mercenary
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries
			cannot_inherit = yes
			is_looter = yes
			can_toggle_looting = no
		}

		hidden_effect = {
			event_target:scoped_pirate_mercenary = {
				diplomatic_immunity = no
			}
		}

		character_event = {
			id = HF.23217 # Disband
			days = 350
			random = 50
		}

		ai_chance = { factor = 60 }
	}
}

# Failed to Seduce, the captain offers band at increased cost
character_event = {
	id = HF.23216
	desc = EVTDESCAHF23216
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	option = { # Pay
		name = EVTOPTAHF23216

		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23216 }

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -2
				min = -250
				max = -450
			}
		}

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			leader = event_target:scoped_pirate_mercenary
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries
			cannot_inherit = yes
			is_looter = yes
			can_toggle_looting = no
		}

		hidden_effect = {
			event_target:scoped_pirate_mercenary = {
				diplomatic_immunity = no
			}
		}

		character_event = {
			id = HF.23217 # Disband
			days = 350
			random = 50
		}
	}

	option = { # Let the thugs go
		name = EVTOPTBHF23216

		custom_tooltip = {
			text = TOOLTIP_EVTOPTDHB23216

			hidden_effect = {
				event_target:scoped_pirate_mercenary = {
					death = { death_reason = death_missing }
				}
			}
		}

		ai_chance = { factor = 0 }
	}
}

# Mercenaries disband after a year
character_event = {
	id = HF.23217
	desc = EVTDESCAHF23217
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	trigger = {
		has_earmarked_regiments = pirate_mercenaries
	}

	option = { # Pay
		name = EVTOPTAHF23217

		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23217 }

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.5
				min = -150
				max = -350
			}
		}

		repeat_event = {
			id = HF.23217 # Repeat event until you disband them
			days = 150
			random = 150
		}

		ai_chance = { factor = 20 }
	}

	option = { # Disband
		name = EVTOPTBHF23217

		custom_tooltip = {
			text = TOOLTIP_EVTOPTBHF23217

			hidden_effect = {
				disband_event_forces = pirate_mercenaries
				event_target:scoped_pirate_mercenary = { death = { death_reason = death_missing } }
			}
		}

		ai_chance = { factor = 80 }
	}
}

# Pirate was able to kill mercenary leader in duel
character_event = {
	id = HF.23218
	desc = EVTDESCAHF23218
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23218

		spawn_unit = {
			province = event_target:scoped_spawning_point
			home = event_target:scoped_spawning_point
			owner = ROOT
			match_character = ROOT
			match_mult = 0.25
			match_min = 150
			match_max = 1000
			attrition = 1.0
			earmark = pirate_mercenaries_perm
			cannot_inherit = yes
			is_looter = yes
		}
	}
}

# on_loot_province: Chance to sneak inside city
character_event = {
	id = HF.23219
	border = GFX_event_normal_frame_war

	desc = {
		text = EVTDESCAHF23219
		trigger = { FROM = { holding_type = castle } }
	}
	desc = {
		text = EVTDESCBHF23219
		trigger = { FROM = { holding_type = city } }
	}
	desc = {
		text = EVTDESCCHF23219
		trigger = { FROM = { holding_type = temple } }
	}

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes # on_loot_province

	has_dlc = "Holy Fury"

	trigger = {
		this_is_sea_raider_trigger = yes
		is_landed = yes
		at_location = FROM

		siege = {
			is_attacker = yes
		}

		FROM = {
			OR = {
				holding_type = castle
				holding_type = city
				holding_type = temple
			}

			num_of_settlements >= 4 # Only fires for medium or big cities
			NOT = { has_province_modifier = recent_pirate_infiltration_cooldown }

			location = {
				# Avoid the event firing for raiders who raided on land all the way to the port of a sea they do not have access to
				ROOT = {
					any_realm_province = {
						is_coastal = yes
						can_naval_path_to = PREVPREV
						TECH_NAVAL >= 1
						held_under_PREV = yes

						OR = {
							has_building = tb_shipyard_1
							has_building = ca_shipyard_1
							has_building = tp_shipyard_1
							has_building = ct_shipyard_1
						}
					}
				}
			}
		}
	}

	immediate = {
		FROM = {
			add_province_modifier = {
				name = recent_pirate_infiltration_cooldown
				years = 10
				hidden = yes
			}
		}
	}

	# Full frontal assault with longships
	# Dress as priest/priestess (temple only)
	# Seduce guards (castle only)
	# Spread on the countryside to pillage farms (city only)

	# Nothing (continue regular blockade)

	option = { # Full assault - combat_rating-based
		name = EVTOPTAHF23219

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23219

			random_list = {
				60 = {
					good_soldier_outcome_score = yes
					character_event = { id = HF.23220 } # Success
				}

				40 = {
					bad_soldier_outcome_score = yes
					character_event = { id = HF.23221 } # Failure
				}
			}
		}
	}

	option = { # Sneak inside temple while dressed as priest
		name = EVTOPTBHF23219

		trigger = {
			FROM = { holding_type = temple }

			# Check doctrines
			OR = {
				trigger_if = {
					limit = { is_female = yes }
					FROM = { owner = { religion_allows_female_temple_holders = yes } }
				}
				trigger_else = {
					FROM = { owner = { religion_allows_male_temple_holders = yes } }
				}

				FROM = {
					owner = {
						OR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_feature_bon

							AND = {
								religion_group = pagan_group
								is_reformed_religion = no

								# Random World Checks
								NOR = {
									has_religion_feature = religion_patriarchal
									has_religion_feature = religion_matriarchal
								}
							}
						}
					}
				}
			}
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTBHF23219

			random_list = { # Outcome based on intrigue and a bit of learning
				60 = {
					is_good_intrigue_character_score = yes

					mult_modifier = {
						factor = 1.25
						learning >= 10
					}

					mult_modifier = {
						factor = 1.25
						learning >= 12
					}

					mult_modifier = {
						factor = 1.25
						learning >= 14
					}

					mult_modifier = {
						factor = 1.25
						learning >= 16
					}

					character_event = { id = HF.23222 } # Success
				}

				40 = {
					is_bad_intrigue_character_score = yes
					character_event = { id = HF.23223 } # Failure
				}
			}
		}
	}

	option = { # Dress up and seduce guards of castle
		name = EVTOPTCHF23219

		trigger = {
			FROM = { holding_type = castle }

			# Check doctrines
			OR = {
				trigger_if = {
					limit = { is_female = yes }
					FROM = { owner = { NOT = { has_religion_feature = religion_matriarchal } } }
				}
				trigger_else = {
					FROM = { owner = { has_religion_feature = religion_matriarchal } }
				}

				FROM = {
					owner = {
						OR = {
							has_religion_feature = religion_equal
							has_religion_feature = religion_feature_bon
						}
					}
				}
			}
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTCHF23219

			random_list = { # Outcome based on intrigue and attraction score
				60 = {
					is_good_intrigue_character_score = yes

					mult_modifier = {
						factor = 1.75

						is_attractive_trigger = yes
						practical_age < 30
					}

					mult_modifier = {
						factor = 1.5

						is_attractive_trigger = yes
						practical_age >= 30
						practical_age < 40
					}

					character_event = { id = HF.23224 } # Success
				}

				40 = {
					is_bad_intrigue_character_score = yes

					mult_modifier = {
						factor = 1.75
						is_unattractive_trigger = yes
					}

					mult_modifier = {
						factor = 1.25
						practical_age >= 40
					}

					mult_modifier = {
						factor = 1.5
						practical_age >= 50
					}

					character_event = { id = HF.23225 } # Failure
				}
			}
		}
	}

	option = { # Spread through the Countryside
		name = EVTOPTDHF23219

		trigger = {
			FROM = { holding_type = city }
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTDHF23219

			random_list = { # Less risky than the above options, but with lesser reward
				75 = {
					good_soldier_outcome_score = yes
					character_event = { id = HF.23226 } # Success
				}

				25 = {
					bad_soldier_outcome_score = yes
					character_event = { id = HF.23227 } # Failure
				}
			}
		}
	}

	option = { # Wait
		name = EVTOPTEHF23219

		custom_tooltip = { text = TOOLTIP_EVTOPTEHF23219 }
	}
}

# Success: Full assault
character_event = {
	id = HF.23220
	desc = EVTDESCAHF23220
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.05
			troops = -0.015

			enemy = {
				morale = -0.05
				troops = -0.15
			}
		}
	}

	option = {
		name = EVTOPTAHF23220

		tooltip = {
			siege = {
				show_scope_change = no

				morale = 0.05
				troops = -0.015

				enemy = {
					show_scope_change = no

					morale = -0.05
					troops = -0.15
				}
			}
		}
	}
}

# Failure: Full assault
character_event = {
	id = HF.23221
	desc = EVTDESCAHF23221
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.25
			troops = -0.15

			enemy = {
				morale = 0.15
				troops = -0.015
			}
		}
	}

	option = {
		name = EVTOPTAHF23221

		tooltip = { # Just a tooltip, apply the effect before, to avoid cheating
			siege = {
				show_scope_change = no

				morale = -0.25
				troops = -0.15

				enemy = {
					show_scope_change = no

					morale = 0.15
					troops = -0.015
				}
			}
		}
	}
}

# Success: Infiltrated Temple
character_event = {
	id = HF.23222
	desc = EVTDESCAHF23222
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	# Steal wealth from temple
	# Desecrate temple

	immediate = {
		siege = {
			show_scope_change = no
			morale = 0.05

			enemy = {
				show_scope_change = no
				morale = -0.05
			}
		}
	}

	option = {
		name = EVTOPTAHF23222

		scaled_wealth = {
			value = 1
			min = 50
			max = 150
		}

		tooltip = {
			siege = {
				show_scope_change = no
				morale = 0.05

				enemy = {
					show_scope_change = no
					morale = -0.05
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23222

		trigger = {
			# Only available if temple is not of same religion
			FROMFROM = {
				owner = {
					NOT = { religion = ROOT }
				}
			}
		}

		piety = 75

		tooltip = {
			siege = {
				show_scope_change = no
				morale = 0.05

				enemy = {
					show_scope_change = no
					morale = -0.05
				}
			}
		}
	}
}

# Failure: Infiltrated Temple
character_event = {
	id = HF.23223
	desc = EVTDESCAHF23223
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.25

			enemy = {
				morale = 0.15
			}
		}
	}

	option = {
		name = EVTOPTAHF23223

		tiered_prestige_negative_effect = yes

		tooltip = {
			siege = {
				show_scope_change = no
				morale = -0.25

				enemy = {
					show_scope_change = no
					morale = 0.15
				}
			}
		}
	}
}

# Success: Infiltrated Castle
character_event = {
	id = HF.23224
	desc = EVTDESCAHF23224
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.15

			enemy = {
				troops = -0.25
			}
		}
	}

	option = {
		name = EVTOPTAHF23224

		tiered_prestige_negative_effect = yes

		tooltip = {
			siege = {
				show_scope_change = no
				morale = 0.15

				enemy = {
					show_scope_change = no
					troops = -0.25
				}
			}
		}
	}
}

# Failure: Infiltrated Castle
character_event = {
	id = HF.23225
	desc = EVTDESCAHF23225
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.15

			enemy = {
				morale = 0.25
			}
		}
	}

	option = {
		name = EVTOPTAHF23225

		tiered_prestige_negative_effect = yes

		tooltip = {
			siege = {
				show_scope_change = no
				morale = -0.15

				enemy = {
					show_scope_change = no
					morale = 0.25
				}
			}
		}

		random = {
			chance = 25
			add_trait_wounded_effect = yes
		}
	}
}

# Success: Spread through Countryside
character_event = {
	id = HF.23226
	desc = EVTDESCAHF23226
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = 0.05

			enemy = {
				troops = -0.05
			}
		}
	}

	option = {
		name = EVTOPTAHF23226

		tiered_prestige_reward_effect = yes

		tooltip = {
			siege = {
				show_scope_change = no
				morale = 0.05

				enemy = {
					show_scope_change = no
					troops = -0.05
				}
			}
		}
	}
}

# Failure: Spread through Countryside
character_event = {
	id = HF.23227
	desc = EVTDESCAHF23227
	border = GFX_event_normal_frame_war

	picture = {
		picture = GFX_evt_vikings_arriving_oldgods
		trigger = { is_female = no }
	}
	picture = {
		picture = GFX_evt_norse_tempest
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	immediate = {
		siege = {
			morale = -0.05

			enemy = {
				morale = 0.05
			}
		}
	}

	option = {
		name = EVTOPTAHF23227

		tiered_prestige_negative_effect = yes

		tooltip = {
			siege = {
				show_scope_change = no
				morale = -0.05

				enemy = {
					show_scope_change = no
					morale = 0.05
				}
			}
		}
	}
}

# HF.23228-HF.23399 Left empty... for now

##############################################################################################
##############################################################################################

## Flavor Doctrine events: Astrology + Haruspicy causes Religious Head to interpret the stars 10-yearly (or your Court Chaplain if No Rel Head exists)

# Main event for religious head (it is localized, because the religious head might be Temporal)
narrative_event = {
	id = HF.23400
	title = EVTTITLEAHF23400
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23400
		trigger = { has_character_flag = flag_astrology_very_good_omen }
	}
	desc = {
		text = EVTDESCBHF23400
		trigger = { has_character_flag = flag_astrology_good_omen }
	}
	desc = {
		text = EVTDESCCHF23400
		trigger = { has_character_flag = flag_astrology_ambiguous_omen }
	}
	desc = {
		text = EVTDESCDHF23400
		trigger = { has_character_flag = flag_astrology_bad_omen }
	}
	desc = {
		text = EVTDESCEHF23400
		trigger = { has_character_flag = flag_astrology_very_bad_omen }
	}

	is_triggered_only = yes # on_decade_pulse

	trigger = {
		controls_religion = yes

		trigger_if = {
			limit = { religion = hellenic_pagan_reformed } # Part of their features
			is_alternate_start = no
		}
		trigger_else = {
			has_religion_feature = religion_astrology

			OR = {
				has_religion_feature = religion_haruspicy
				has_religion_feature = religion_feature_celtic
			}
		}

		NOR = {
			has_character_modifier = astrology_very_good_omen
			has_character_modifier = astrology_good_omen
			has_character_modifier = astrology_ambiguous_omen
			has_character_modifier = astrology_bad_omen
			has_character_modifier = astrology_very_bad_omen
		}
	}

	immediate = {
		random_list = {
			5 = {
				mult_modifier = { factor = 1.15 piety >= 50 }
				mult_modifier = { factor = 1.15 piety >= 100 }
				mult_modifier = { factor = 1.15 piety >= 150 }
				mult_modifier = { factor = 1.15 piety >= 200 }
				mult_modifier = { factor = 1.15 piety >= 250 }
				mult_modifier = { factor = 1.15 piety >= 350 }
				mult_modifier = { factor = 1.25 piety >= 500 }

				set_character_flag = flag_astrology_very_good_omen
			}

			10 = { set_character_flag = flag_astrology_good_omen }
			20 = { set_character_flag = flag_astrology_ambiguous_omen }
			10 = { set_character_flag = flag_astrology_bad_omen }
			 5 = { set_character_flag = flag_astrology_very_bad_omen }
		}
	}

	# Reinterpret bad omen using high learning/Boost ambiguous or good omen with high learning
	# Spread the news
	# Ignore the omen

	option = { # Reinterpet less favorable omen to prevent bad modifier
		name = EVTOPTAHF23400
		tooltip_info = learning

		trigger = {
			learning >= 15
			NOT = { has_character_flag = flag_astrology_very_good_omen }
		}

		custom_tooltip = { text = TOOLTIP_EVTOPTAHF23400 }

		trigger_switch = {
			on_trigger = has_character_flag

			flag_astrology_good_omen = {
				clr_character_flag = flag_astrology_good_omen

				add_character_modifier = {
					name = astrology_very_good_omen
					years = 2
				}
			}

			flag_astrology_ambiguous_omen = {
				clr_character_flag = flag_astrology_ambiguous_omen

				add_character_modifier = {
					name = astrology_good_omen
					years = 2
				}
			}

			flag_astrology_bad_omen = {
				clr_character_flag = flag_astrology_bad_omen

				add_character_modifier = {
					name = astrology_ambiguous_omen
					years = 2
				}
			}

			flag_astrology_very_bad_omen = {
				clr_character_flag = flag_astrology_very_bad_omen

				add_character_modifier = {
					name = astrology_bad_omen
					years = 2
				}
			}
		}

		hidden_effect = {
			change_variable = {
				which = haruspicy_testing_fate
				value = 1
			}

			random = {
				chance = 1

				mult_modifier = {
					factor = 5
					trait = ambitious
				}

				mult_modifier = {
					factor = 1.5
					trait = proud
				}

				testing_fate_variable_character_score = yes

				character_event = {
					id = HF.23402 # The gods did not appreciate your hubris
					days = 25
					random = 25
				}
			}

			any_independent_ruler = {
				limit = {
					religion = ROOT
					higher_real_tier_than = COUNT
				}

				narrative_event = { id = HF.23401 }
			}
		}

		ai_chance = { factor = 25 }
	}

	option = { # Spread the news
		name = EVTOPTBHF23400

		custom_tooltip = { text = TOOLTIP_EVTOPTBHF23400 }

		trigger_switch = {
			on_trigger = has_character_flag

			flag_astrology_very_good_omen = {
				add_character_modifier = {
					name = astrology_very_good_omen
					years = 2
				}

				religion_authority = {
					name = haruspicy_very_good_omen
					years = 50
				}

				clr_character_flag = flag_astrology_very_good_omen
			}

			flag_astrology_good_omen = {
				add_character_modifier = {
					name = astrology_good_omen
					years = 2
				}

				clr_character_flag = flag_astrology_good_omen
			}

			flag_astrology_ambiguous_omen = {
				add_character_modifier = {
					name = astrology_ambiguous_omen
					years = 2
				}

				clr_character_flag = flag_astrology_ambiguous_omen
			}

			flag_astrology_bad_omen = {
				add_character_modifier = {
					name = astrology_bad_omen
					years = 2
				}

				clr_character_flag = flag_astrology_bad_omen
			}

			flag_astrology_very_bad_omen = {
				add_character_modifier = {
					name = astrology_very_bad_omen
					years = 2
				}

				religion_authority = {
					name = haruspicy_very_bad_omen
					years = 50
				}

				clr_character_flag = flag_astrology_very_bad_omen
			}
		}

		hidden_effect = {
			any_independent_ruler = {
				limit = {
					religion = ROOT
					higher_real_tier_than = COUNT
				}

				narrative_event = { id = HF.23401 }
			}
		}

		ai_chance = {
			factor = 50

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}

			mult_modifier = {
				factor = 1.5
				trait = craven
			}
		}
	}

	option = { # Ignore the omen
		name = EVTOPTCHF23400

		custom_tooltip = { text = TOOLTIP_EVTOPTCHF23400 }

		random = {
			chance = 15
			add_trait_partially_cynical_effect = yes
		}

		tiered_piety_negative_effect = yes

		hidden_effect = {
			change_variable = {
				which = haruspicy_testing_fate
				value = 2
			}

			random = {
				chance = 1

				mult_modifier = {
					factor = 5
					trait = cynical
				}

				testing_fate_variable_character_score = yes

				character_event = {
					id = HF.23402 # The gods did not appreciate your cynicism
					days = 25
					random = 25
				}
			}

			clr_character_flag = flag_astrology_very_good_omen
			clr_character_flag = flag_astrology_good_omen
			clr_character_flag = flag_astrology_ambiguous_omen
			clr_character_flag = flag_astrology_bad_omen
			clr_character_flag = flag_astrology_very_bad_omen
		}

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 5
				trait = cynical
			}
		}
	}
}

# Main event for the rulers
narrative_event = {
	id = HF.23401
	title = EVTTITLEAHF23401
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23401
		trigger = { FROM = { has_character_modifier = astrology_very_good_omen } }
	}
	desc = {
		text = EVTDESCBHF23401
		trigger = { FROM = { has_character_modifier = astrology_good_omen } }
	}
	desc = {
		text = EVTDESCCHF23401
		trigger = { FROM = { has_character_modifier = astrology_ambiguous_omen } }
	}
	desc = {
		text = EVTDESCDHF23401
		trigger = { FROM = { has_character_modifier = astrology_bad_omen } }
	}
	desc = {
		text = EVTDESCEHF23401
		trigger = { FROM = { has_character_modifier = astrology_very_bad_omen } }
	}

	is_triggered_only = yes

	# Accept response
	# Make great offering to improve modifier

	option = { # Make great offering to improve modifier
		name = EVTOPTAHF23401

		tiered_piety_reward_effect = yes

		trigger = {
			FROM = {
				OR = {
					has_character_modifier = astrology_ambiguous_omen
					has_character_modifier = astrology_bad_omen
					has_character_modifier = astrology_very_bad_omen
				}
			}
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.5
				min = -150
				max = -400
			}
		}

		if = {
			limit = { FROM = { has_character_modifier = astrology_ambiguous_omen } }

			add_character_modifier = {
				name = astrology_good_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_bad_omen } }

			add_character_modifier = {
				name = astrology_ambiguous_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_very_bad_omen } }

			add_character_modifier = {
				name = astrology_bad_omen
				years = 2
			}
		}

		ai_chance = { factor = 10 }
	}

	option = { # Accept response
		name = {
			text = EVTOPTBHF23401_A
			trigger = { FROM = { has_character_modifier = astrology_very_good_omen } }
		}
		name = {
			text = EVTOPTBHF23401_B
			trigger = { FROM = { has_character_modifier = astrology_good_omen } }
		}
		name = {
			text = EVTOPTBHF23401_C
			trigger = { FROM = { has_character_modifier = astrology_ambiguous_omen } }
		}
		name = {
			text = EVTOPTBHF23401_D
			trigger = { FROM = { has_character_modifier = astrology_bad_omen } }
		}
		name = {
			text = EVTOPTBHF23401_E
			trigger = { FROM = { has_character_modifier = astrology_very_bad_omen } }
		}

		if = {
			limit = { FROM = { has_character_modifier = astrology_very_good_omen } }

			add_character_modifier = {
				name = astrology_very_good_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_good_omen } }

			add_character_modifier = {
				name = astrology_good_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_ambiguous_omen } }

			add_character_modifier = {
				name = astrology_ambiguous_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_bad_omen } }

			add_character_modifier = {
				name = astrology_bad_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_modifier = astrology_very_bad_omen } }

			add_character_modifier = {
				name = astrology_very_bad_omen
				years = 2
			}
		}

		ai_chance = { factor = 100 }
	}
}

# Tempted fate once too often - religious head dies
character_event = {
	id = HF.23402
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23402
		trigger = { has_character_flag = tempted_faith_1 }
	}
	desc = {
		text = EVTDESCBHF23402
		trigger = { has_character_flag = tempted_faith_2 }
	}
	desc = {
		text = EVTDESCCHF23402
		trigger = { has_character_flag = tempted_faith_3 }
	}
	desc = {
		text = EVTDESCDHF23402
		trigger = { has_character_flag = tempted_faith_4 }
	}
	desc = {
		text = EVTDESCEHF23402
		trigger = { has_character_flag = tempted_faith_5 }
	}

	is_triggered_only = yes

	immediate = {
		random_list = {
			1 = { set_character_flag = tempted_faith_1 }
			1 = { set_character_flag = tempted_faith_2 }
			1 = { set_character_flag = tempted_faith_3 }
			1 = { set_character_flag = tempted_faith_4 }
			1 = { set_character_flag = tempted_faith_5 }
		}
	}

	option = {
		name = EVTOPTAHF23402

		religion_authority = {
			name = haruspicy_tempted_faith
			years = 50
		}

		hidden_effect = {
			any_player = {
				limit = {
					religion = ROOT
					NOT = { character = ROOT }
				}

				if = {
					limit = { ROOT = { has_character_flag = tempted_faith_1 } }
					set_character_flag = tempted_faith_1
				}
				else_if = {
					limit = { ROOT = { has_character_flag = tempted_faith_2 } }
					set_character_flag = tempted_faith_2
				}
				else_if = {
					limit = { ROOT = { has_character_flag = tempted_faith_3 } }
					set_character_flag = tempted_faith_3
				}
				else_if = {
					limit = { ROOT = { has_character_flag = tempted_faith_4 } }
					set_character_flag = tempted_faith_4
				}
				else_if = {
					limit = { ROOT = { has_character_flag = tempted_faith_5 } }
					set_character_flag = tempted_faith_5
				}

				character_event = {
					id = HF.23403
					days = 5
					random = 5
				}
			}
		}

		death = { death_reason = death_accident }
	}
}

# Players of same religion are notified
character_event = {
	id = HF.23403
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23403
		trigger = { has_character_flag = tempted_faith_1 }
	}
	desc = {
		text = EVTDESCBHF23403
		trigger = { has_character_flag = tempted_faith_2 }
	}
	desc = {
		text = EVTDESCCHF23403
		trigger = { has_character_flag = tempted_faith_3 }
	}
	desc = {
		text = EVTDESCDHF23403
		trigger = { has_character_flag = tempted_faith_4 }
	}
	desc = {
		text = EVTDESCEHF23403
		trigger = { has_character_flag = tempted_faith_5 }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23403

		tooltip = { # Only applied once on the religious head's event
			religion_authority = {
				name = haruspicy_tempted_faith
				years = 50
			}
		}

		clr_character_flag = tempted_faith_1
		clr_character_flag = tempted_faith_2
		clr_character_flag = tempted_faith_3
		clr_character_flag = tempted_faith_4
		clr_character_flag = tempted_faith_5
	}
}

# Main event for Court Chaplain of Kings and above (only if no religious head exists)
narrative_event = {
	id = HF.23404
	title = EVTTITLEAHF23404
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23404
		trigger = { has_character_flag = flag_astrology_good_omen }
	}
	desc = {
		text = EVTDESCBHF23404
		trigger = { has_character_flag = flag_astrology_ambiguous_omen }
	}
	desc = {
		text = EVTDESCCHF23404
		trigger = { has_character_flag = flag_astrology_bad_omen }
	}

	is_triggered_only = yes # on_decade_pulse, random_events

	trigger = {
		has_job_title = job_spiritual

		liege = {
			higher_real_tier_than = DUKE
			religion = ROOT
		}

		trigger_if = {
			limit = { religion = hellenic_pagan_reformed } # Part of their features

			has_religion_feature = religion_no_leader
			is_alternate_start = no
		}
		trigger_else = {
			OR = {
				has_religion_feature = religion_haruspicy
				has_religion_feature = religion_feature_celtic
			}

			has_religion_feature = religion_astrology
			has_religion_feature = religion_no_leader
		}

		NOR = {
			has_character_modifier = astrology_good_omen
			has_character_modifier = astrology_ambiguous_omen
			has_character_modifier = astrology_bad_omen
		}
	}

	immediate = {
		random_list = {
			10 = {
				mult_modifier = { factor = 1.15 piety >= 50 }
				mult_modifier = { factor = 1.15 piety >= 100 }
				mult_modifier = { factor = 1.15 piety >= 150 }
				mult_modifier = { factor = 1.15 piety >= 200 }
				mult_modifier = { factor = 1.15 piety >= 250 }
				mult_modifier = { factor = 1.15 piety >= 350 }
				mult_modifier = { factor = 1.25 piety >= 500 }

				set_character_flag = flag_astrology_good_omen
			}

			10 = { set_character_flag = flag_astrology_ambiguous_omen }
			10 = { set_character_flag = flag_astrology_bad_omen }
		}
	}

	# Tell liege
	option = {
		name = EVTOPTAHF23404

		liege = {
			show_scope_change = no

			tooltip = {
				if = {
					limit = { ROOT = { has_character_flag = flag_astrology_good_omen } }

					add_character_modifier = {
						name = astrology_good_omen
						years = 2
					}
				}
				else_if = {
					limit = { ROOT = { has_character_flag = flag_astrology_ambiguous_omen } }

					add_character_modifier = {
						name = astrology_ambiguous_omen
						years = 2
					}
				}
				else_if = {
					limit = { ROOT = { has_character_flag = flag_astrology_bad_omen } }

					add_character_modifier = {
						name = astrology_bad_omen
						years = 2
					}
				}
			}

			narrative_event = { id = HF.23405 }
		}
	}
}

# Main event for the rulers (from Chaplain)
narrative_event = {
	id = HF.23405
	title = EVTTITLEAHF23405
	picture = GFX_evt_comet
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23405
		trigger = { FROM = { has_character_flag = flag_astrology_good_omen } }
	}
	desc = {
		text = EVTDESCBHF23405
		trigger = { FROM = { has_character_flag = flag_astrology_ambiguous_omen } }
	}
	desc = {
		text = EVTDESCCHF23405
		trigger = { FROM = { has_character_flag = flag_astrology_bad_omen } }
	}

	is_triggered_only = yes

	# Accept response
	# Make great offering to improve modifier

	option = { # Make great offering to improve modifier
		name = EVTOPTAHF23405

		tiered_piety_reward_effect = yes

		trigger = {
			FROM = {
				OR = {
					has_character_flag = flag_astrology_ambiguous_omen
					has_character_flag = flag_astrology_bad_omen
				}
			}
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.5
				min = -150
				max = -400
			}
		}

		if = {
			limit = { FROM = { has_character_flag = flag_astrology_ambiguous_omen } }

			add_character_modifier = {
				name = astrology_good_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_flag = flag_astrology_bad_omen } }

			add_character_modifier = {
				name = astrology_ambiguous_omen
				years = 2
			}
		}

		ai_chance = { factor = 10 }
	}

	option = { # Accept response
		name = I_SEE

		if = {
			limit = { FROM = { has_character_flag = flag_astrology_good_omen } }

			add_character_modifier = {
				name = astrology_good_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_flag = flag_astrology_ambiguous_omen } }

			add_character_modifier = {
				name = astrology_ambiguous_omen
				years = 2
			}
		}
		else_if = {
			limit = { FROM = { has_character_flag = flag_astrology_bad_omen } }

			add_character_modifier = {
				name = astrology_bad_omen
				years = 2
			}
		}

		ai_chance = { factor = 100 }
	}

	option = { # Ignore the omen
		name = EVTOPTCHF23405

		random = {
			chance = 15
			add_trait_partially_cynical_effect = yes
		}

		tiered_piety_negative_effect = yes

		hidden_effect = {
			change_variable = {
				which = haruspicy_testing_fate
				value = 1
			}

			random = {
				chance = 1

				mult_modifier = {
					factor = 5
					trait = cynical
				}

				testing_fate_variable_character_score = yes

				character_event = {
					id = HF.23406 # The gods did not appreciate your cynicism
					days = 25
					random = 25
				}
			}
		}

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 5
				trait = cynical
			}
		}
	}

	after = {
		FROM = {
			clr_character_flag = flag_astrology_good_omen
			clr_character_flag = flag_astrology_ambiguous_omen
			clr_character_flag = flag_astrology_bad_omen
		}
	}
}

# Tempted fate once too often. Ruler dies
character_event = {
	id = HF.23406
	desc = EVTDESCAHF23406
	desc = EVTDESCBHF23406
	desc = EVTDESCCHF23406
	# desc = EVTDESCDHF23406 # Loc missing
	desc = EVTDESCEHF23406
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = {
		if = {
			limit = { multiplayer = yes }
			death = { death_reason = death_accident }
		}
	}

	option = {
		name = EVTOPTAHF23406

		if = {
			limit = { multiplayer = no }
			death = { death_reason = death_accident }
		}
		else = {
			tooltip = {
				death = { death_reason = death_accident }
			}
		}
	}
}

###############################################################################
###############################################################################
## Haruspicy + Bloodthirsty Gods allows to read your fortune when killing a notable prisoner

# on_death: Hidden ping from the prisoner
character_event = {
	id = HF.23410

	is_triggered_only = yes # on_death
	hide_window = yes

	trigger = {
		higher_real_tier_than = COUNT

		OR = {
			death_execution_trigger = yes
			death_sacrificed_trigger = yes
		}

		killer = {
			is_playable = yes
			is_landed = yes
			is_incapable = no

			OR = {
				has_religion_feature = religion_ritual_sacrifice
				religion_openly_aztec_or_reformed_trigger = yes
			}

			OR = {
				has_religion_feature = religion_haruspicy
				has_religion_feature = religion_feature_celtic
				religion_openly_hellenic_or_reformed_trigger = yes
			}

			NOR = { # Shouldn't already have one of the main effects
				has_character_modifier = cannibal_haruspicy_sacrifice
				has_character_modifier = martial_haruspicy_sacrifice
				has_character_modifier = intrigue_def_haruspicy_sacrifice
				has_character_modifier = intrigue_att_haruspicy_sacrifice
				has_character_modifier = stewardship_haruspicy_sacrifice
				has_character_modifier = negative_haruspicy_sacrifice
			}
		}
	}

	immediate = {
		killer = {
			character_event = { id = HF.23411 }
		}
	}
}

# Executioner offered chance of reading his future
character_event = {
	id = HF.23411
	title = EVTTITLEAHF23411
	desc = EVTDESCAHF23411
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	# Cannibal eats his remains to gain strength
	# Mystic knows how to do it
	# Regular option
	# Do nothing

	option = { # Cannibal eats his remains to gain strength
		name = EVTOPTAHF23411
		tooltip_info = cannibal

		trigger = {
			trait = cannibal
			FROM = { NOT = { death_reason = death_execution_eaten } } # Nothing left to eat
		}

		tiered_piety_negative_effect = yes

		hidden_effect = {
			random_list = {
				25 = { character_event = { id = HF.23412 } } # Add modifier

				25 = {
					trigger = {
						NOT = { has_character_modifier = blessing_of_health }
					}

					character_event = { id = HF.23413 } # Add health modifier
				}

				25 = {
					trigger = {
						OR = {
							is_ill = yes
							has_character_flag = developing_illness
						}
					}

					character_event = { id = HF.23414 } # Remove sickness
				}

				1 = {
					trigger = {
						NOT = { trait = lunatic }
					}

					character_event = { id = HF.23415 } # Add insanity
				}
			}
		}

		ai_chance = {
			factor = 20

			mult_modifier = {
				factor = 0.5
				piety < 100
			}
		}
	}

	option = { # Mystic knows how to do it
		name = EVTOPTBHF23411
		tooltip_info = mystic

		trigger = { trait = mystic }

		tiered_piety_negative_effect = yes

		hidden_effect = {
			random_list = {
				5 = {
					trigger = {
						piety >= 100
						learning >= 15
						NOT = { has_religion_feature = religion_peaceful } # Incompatible with Bloodthirsty anyway, but, just in case...
					}

					character_event = { id = HF.23422 } # Bonus action for Mystics - chance to increase MA
				}

				25 = { character_event = { id = HF.23416 } } # Add martial modifier
				25 = { character_event = { id = HF.23417 } } # Add intrigue def modifier
				25 = { character_event = { id = HF.23418 } } # Add intrigue att modifier
				25 = { character_event = { id = HF.23419 } } # Add stewardship modifier

				10 = {
					mult_modifier = { factor = 0.9 learning >= 10 }
					mult_modifier = { factor = 0.9 learning >= 12 }
					mult_modifier = { factor = 0.9 learning >= 14 }
					mult_modifier = { factor = 0.9 learning >= 16 }
					mult_modifier = { factor = 0.9 learning >= 18 }
					mult_modifier = { factor = 0.9 learning >= 20 }
					mult_modifier = { factor = 0.8 learning >= 25 }
					mult_modifier = { factor = 0.8 piety >=  50 }
					mult_modifier = { factor = 0.8 piety >= 100 }
					mult_modifier = { factor = 0.8 piety >= 150 }
					mult_modifier = { factor = 0.8 piety >= 200 }
					mult_modifier = { factor = 0.8 piety >= 250 }
					mult_modifier = { factor = 0.8 piety >= 300 }

					character_event = { id = HF.23420 } # Inconclusive results
				}

				5 = {
					mult_modifier = { factor = 0.9 learning >= 10 }
					mult_modifier = { factor = 0.9 learning >= 12 }
					mult_modifier = { factor = 0.9 learning >= 14 }
					mult_modifier = { factor = 0.9 learning >= 16 }
					mult_modifier = { factor = 0.9 learning >= 18 }
					mult_modifier = { factor = 0.9 learning >= 20 }
					mult_modifier = { factor = 0.8 learning >= 25 }
					mult_modifier = { factor = 0.8 piety >=  50 }
					mult_modifier = { factor = 0.8 piety >= 100 }
					mult_modifier = { factor = 0.8 piety >= 150 }
					mult_modifier = { factor = 0.8 piety >= 200 }
					mult_modifier = { factor = 0.8 piety >= 250 }
					mult_modifier = { factor = 0.8 piety >= 300 }

					character_event = { id = HF.23421 } # Negative results
				}
			}
		}

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 0.5
				piety < 100
			}
		}
	}

	option = { # Regular option - Same list as above, worse chances
		name = EVTOPTCHF23411

		tiered_piety_negative_effect = yes

		hidden_effect = {
			random_list = {
				15 = { character_event = { id = HF.23416 } } # Add martial modifier
				15 = { character_event = { id = HF.23417 } } # Add intrigue def modifier
				15 = { character_event = { id = HF.23418 } } # Add intrigue att modifier
				15 = { character_event = { id = HF.23419 } } # Add stewardship modifier

				20 = {
					mult_modifier = { factor = 0.9 learning >= 10 }
					mult_modifier = { factor = 0.9 learning >= 12 }
					mult_modifier = { factor = 0.9 learning >= 14 }
					mult_modifier = { factor = 0.9 learning >= 16 }
					mult_modifier = { factor = 0.9 learning >= 18 }
					mult_modifier = { factor = 0.9 learning >= 20 }
					mult_modifier = { factor = 0.8 learning >= 25 }
					mult_modifier = { factor = 0.8 piety >=  50 }
					mult_modifier = { factor = 0.8 piety >= 100 }
					mult_modifier = { factor = 0.8 piety >= 150 }
					mult_modifier = { factor = 0.8 piety >= 200 }
					mult_modifier = { factor = 0.8 piety >= 250 }
					mult_modifier = { factor = 0.8 piety >= 300 }

					character_event = { id = HF.23420 } # Inconclusive results
				}

				10 = {
					mult_modifier = { factor = 0.9 learning >= 10 }
					mult_modifier = { factor = 0.9 learning >= 12}
					mult_modifier = { factor = 0.9 learning >= 14 }
					mult_modifier = { factor = 0.9 learning >= 16 }
					mult_modifier = { factor = 0.9 learning >= 18 }
					mult_modifier = { factor = 0.9 learning >= 20 }
					mult_modifier = { factor = 0.8 learning >= 25 }
					mult_modifier = { factor = 0.8 piety >=  50 }
					mult_modifier = { factor = 0.8 piety >= 100 }
					mult_modifier = { factor = 0.8 piety >= 150 }
					mult_modifier = { factor = 0.8 piety >= 250 }
					mult_modifier = { factor = 0.8 piety >= 200 }
					mult_modifier = { factor = 0.8 piety >= 300 }

					character_event = { id = HF.23421 } # Negative results
				}
			}
		}

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 0.5
				piety < 100
			}
		}
	}

	option = { # Do nothing
		name = EVTOPTDHF23411

		ai_chance = { factor = 40 }
	}
}

# Cannibal reinvigored from enemy's flesh
character_event = {
	id = HF.23412
	desc = EVTDESCAHF23412
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23412

		add_character_modifier = {
			name = cannibal_haruspicy_sacrifice
			years = 5
		}
	}
}

# Cannibal feels healthier
character_event = {
	id = HF.23413
	desc = EVTDESCAHF23413
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23413

		add_character_modifier = {
			name = blessing_of_health
			years = 5
		}
	}
}

# Cannibal's illness has been cured
character_event = {
	id = HF.23414
	desc = EVTDESCAHF23414
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23414

		remove_disease_trait_effect = yes
		clr_character_flag = developing_illness
	}
}

# Cannibal has gone insane
character_event = {
	id = HF.23415
	desc = EVTDESCAHF23415
	picture = GFX_evt_lunatic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23415

		add_trait = lunatic
	}
}

# Martial bonus from bloodied haruspicy
character_event = {
	id = HF.23416
	desc = EVTDESCAHF23416
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23416

		add_character_modifier = {
			name = martial_haruspicy_sacrifice
			years = 4
		}
	}
}

# Plot def bonus from bloodied haruspicy
character_event = {
	id = HF.23417
	desc = EVTDESCAHF23417
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23417

		add_character_modifier = {
			name = intrigue_def_haruspicy_sacrifice
			years = 4
		}
	}
}

# Plot att bonus from bloodied haruspicy
character_event = {
	id = HF.23418
	desc = EVTDESCAHF23418
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23418

		add_character_modifier = {
			name = intrigue_att_haruspicy_sacrifice
			years = 4
		}
	}
}

# Stewardship bonus from bloodied haruspicy
character_event = {
	id = HF.23419
	desc = EVTDESCAHF23419
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23419

		add_character_modifier = {
			name = stewardship_haruspicy_sacrifice
			years = 4
		}
	}
}

# Inconclusive results from bloodied haruspicy
character_event = {
	id = HF.23420
	desc = EVTDESCAHF23420
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23420
	}
}

# Negative results from bloodied haruspicy
character_event = {
	id = HF.23421
	desc = EVTDESCAHF23421
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23421

		add_character_modifier = {
			name = negative_haruspicy_sacrifice
			years = 4
		}
	}
}

# Mystic managed to increase MA of his religion
character_event = {
	id = HF.23422
	desc = EVTDESCAHF23422
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23422

		tiered_piety_reward_effect = yes

		religion_authority = {
			name = blood_haruspicy_positive
			years = 50
		}

		add_character_modifier = {
			name = religious_blood_haruspicy_sacrifice
			years = 4
		}
	}
}

############################################################################
### Bloodthirsty Gods/Aztecs
## Sacrifying prisoners increases burned_hearts_points variable, unlocking tiered traits. It's like Viking traits, but for psychos.
# Hidden on death event for the sacrifical victims
character_event = {
	id = HF.23430

	is_triggered_only = yes # on_death
	hide_window = yes

	has_dlc = "Holy Fury"

	trigger = {
		death_sacrificed_trigger = yes

		killer = {
			is_playable = yes
			is_landed = yes
			is_incapable = no

			OR = {
				has_religion_feature = religion_ritual_sacrifice
				religion_openly_aztec_or_reformed_trigger = yes
			}
		}
	}

	immediate = {
		killer = {
			# Bonus points first

			# The gods appreciate your sacrifice
			if = {
				limit = {
					ROOT = {
						is_child_of = PREV
						is_adult = no
					}
				}

				change_variable = {
					which = burned_hearts_points
					value = 1
				}

				# And a divine child is even better
				if = {
					limit = {
						religion = PREV

						OR = {
							has_religion_feature = religion_holy_family
							has_religion_feature = religion_feature_zun
						}
					}

					change_variable = {
						which = burned_hearts_points
						value = 1
					}
				}
			}

			# A foreign religious head is also quite good
			if = {
				limit = {
					ROOT = {
						controls_religion = yes
						NOT = { religion = PREV }
					}
				}

				change_variable = {
					which = burned_hearts_points
					value = 2
				}
			}

			if = { # A foreign emperor is also well accepted
				limit = {
					ROOT = {
						higher_real_tier_than = KING
						NOT = { religion = PREV }
					}
				}

				change_variable = {
					which = burned_hearts_points
					value = 2
				}
			}

			# Finally, a third point is added regardless in the following scripted effect,
			# which will also trigger the events below, when the proper score is reached
			bloodthirsty_tiered_traits_effect = yes
		}
	}
}

# Gained the Haemophiliac trait
character_event = {
	id = HF.23431
	desc = EVTDESCAHF23431
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes # bloodthirsty_tiered_traits_effect

	trigger = {
		OR = {
			has_religion_feature = religion_ritual_sacrifice
			religion_openly_aztec_or_reformed_trigger = yes
		}

		NOT = { trait = bloodthirsty_gods_1 }
	}

	immediate = {
		add_blood_splatter_effect = yes
		add_trait = bloodthirsty_gods_1
	}

	option = {
		name = EVTOPTAHF23431

		tooltip = {
			add_trait = bloodthirsty_gods_1
		}

		random = {
			chance = 25
			add_trait_partially_cruel_effect = yes
		}

		random = {
			chance = 25
			remove_trait_cynical_effect = yes
		}
	}
}

# Gained the Haemophant trait
character_event = {
	id = HF.23432
	desc = EVTDESCAHF23432
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes # bloodthirsty_tiered_traits_effect

	trigger = {
		OR = {
			has_religion_feature = religion_ritual_sacrifice
			religion_openly_aztec_or_reformed_trigger = yes
		}

		NOR = {
			trait = bloodthirsty_gods_2
			trait = bloodthirsty_gods_3
		}
	}

	immediate = {
		add_blood_splatter_effect = yes
		add_trait = bloodthirsty_gods_2
	}

	option = {
		name = EVTOPTAHF23432

		if = {
			limit = { trait = bloodthirsty_gods_1 }
			remove_trait = bloodthirsty_gods_1
		}

		add_trait = bloodthirsty_gods_2

		random = {
			chance = 25
			add_trait_partially_cruel_effect = yes
		}
		random = {
			chance = 50
			remove_trait_cynical_effect = yes
		}
	}
}

# Gained the Haemoarch trait
character_event = {
	id = HF.23433
	desc = EVTDESCAHF23433
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes # bloodthirsty_tiered_traits_effect

	trigger = {
		OR = {
			has_religion_feature = religion_ritual_sacrifice
			religion_openly_aztec_or_reformed_trigger = yes
		}

		NOT = { trait = bloodthirsty_gods_3 }
	}

	immediate = {
		add_blood_splatter_effect = yes
		add_trait = bloodthirsty_gods_3
	}

	option = {
		name = EVTOPTAHF23433

		if = {
			limit = { trait = bloodthirsty_gods_1 }
			remove_trait = bloodthirsty_gods_1
		}

		if = {
			limit = { trait = bloodthirsty_gods_2 }
			remove_trait = bloodthirsty_gods_2
		}

		tooltip = {
			add_trait = bloodthirsty_gods_3
		}

		random = {
			chance = 75
			add_trait_cruel_effect = yes
		}

		remove_trait_silently_kind_effect = yes
		remove_trait_silently_cynical_effect = yes
	}
}

# Gained the Bloodthirsty Bloodline
narrative_event = {
	id = HF.23434
	title = EVTTITLE23434
	desc = EVTDESCAHF23434
	border = GFX_event_narrative_frame_religion
	sound = bloodline_added

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes # bloodthirsty_tiered_traits_effect

	trigger = {
		OR = {
			has_religion_feature = religion_ritual_sacrifice
			religion_openly_aztec_or_reformed_trigger = yes
		}

		NOT = {
			any_owned_bloodline = { # Not already has a Bloodthirsty bloodline
				has_bloodline_flag = bloodline_created_bloodthirsty
				bloodline_is_active_for = PREV
			}
		}
	}

	immediate = {
		add_blood_splatter_effect = yes

		if = {
			limit = {
				ai = no
				is_ironman = yes
			}

			set_character_flag = achievement_bloody_line
		}
	}

	option = {
		name = EVTOPTAHF23434

		hidden_effect = {
			if = {
				limit = { this_has_super_cool_nickname_trigger = no }

				random_list = {
					20 = { give_nickname = nick_the_red_storm }
					20 = { give_nickname = nick_the_scarlet_hands }
					20 = { give_nickname = nick_the_blood_monger }
					20 = { give_nickname = nick_the_black_skull }
					20 = { give_nickname = nick_the_heart_eater }
					20 = { give_nickname = nick_the_slaughterer }
					20 = { give_nickname = nick_the_soul_flayer }
					20 = { give_nickname = nick_the_spirit_stalker }
					10 = { give_nickname = nick_the_crimson_reaper }
					10 = { give_nickname = nick_the_dreaded }
					 5 = { give_nickname = nick_the_chest_buster }
				}
			}
		}

		if = {
			limit = { is_female = no }
			create_bloodline = { type = bloodthirsty_male_bloodline }
		}
		else = {
			create_bloodline = { type = bloodthirsty_female_bloodline }
		}

		new_bloodline = {
			set_description = bloodline_desc_bloodthirsty_gods_bloodline

			# Randomize names to avoid too much repetition
			random_list = {
				20 = { set_name = bloodline_bloodthirsty_name_random_a }
				20 = { set_name = bloodline_bloodthirsty_name_random_b }
				20 = { set_name = bloodline_bloodthirsty_name_random_c }
				20 = { set_name = bloodline_bloodthirsty_name_random_d }
				20 = { set_name = bloodline_bloodthirsty_name_random_e }
				20 = { set_name = bloodline_bloodthirsty_name_random_f }
			}
		}

		any_player = {
			limit = {
				is_within_diplo_range = ROOT
				NOT = { character = ROOT }
			}

			narrative_event = { id = HF.23435 }
		}
	}
}

# Inform players
narrative_event = {
	id = HF.23435
	title = EVTTITLE23435
	border = GFX_event_narrative_frame_religion

	desc = {
		text = EVTDESCAHF23435
		trigger = {
			OR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
				religion_openly_aztec_or_reformed_trigger = yes
			}
		}
	}
	desc = {
		text = EVTDESCBHF23435
		trigger = {
			NOR = {
				religion = FROM
				has_religion_feature = religion_ritual_sacrifice
				religion_openly_aztec_or_reformed_trigger = yes
			}
		}
	}

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = {
			FROM = {
				religion_openly_aztec_or_reformed_trigger = yes
			}
		}
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = {
			FROM = {
				religion_openly_aztec_or_reformed_trigger = no
			}
		}
	}

	is_triggered_only = yes

	option = {
		name = {
			text = EVTOPTAHF23435
			trigger = {
				OR = {
					religion = FROM
					has_religion_feature = religion_ritual_sacrifice
					religion_openly_aztec_or_reformed_trigger = yes
				}
			}
		}
		name = {
			text = EVTOPTBHF23435
			trigger = {
				NOR = {
					religion = FROM
					has_religion_feature = religion_ritual_sacrifice
					religion_openly_aztec_or_reformed_trigger = yes
				}
			}
		}
	}
}

######################################################################################################
######################################################################################################
## Bloodthirsty Gods: The Blood Festival - Available from trait tier 1 and above

# First event, send invitations to all vassals
character_event = {
	id = HF.23440
	desc = EVTDESCAHF23440
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # bloodthirsty_games_decision

	option = {
		name = EVTOPTAHF23440

		set_character_flag = flag_preparing_blood_games # Used for on_death notifications

		any_vassal = {
			limit = {
				higher_real_tier_than = BARON
				religion = ROOT
				block_general_event_trigger = no
				NOT = { has_any_opinion_modifier = opinion_blood_games_guest } # Not already tangled in some other blood games from a previous liege
			}

			letter_event = { id = HF.23441 }
		}

		character_event = {
			id = HF.23443 # Pick your champion
			days = 5
		}
	}

	option = { # Hold it in your Amphitheater
		name = EVTOPTBHF23440
		tooltip_info_custom = EVTOPTBHF23440_tt

		trigger = { has_wonder = wonder_amphitheater }

		set_character_flag = flag_preparing_blood_games # Used for on_death notifications.
		prestige = 200

		any_vassal = {
			limit = {
				higher_real_tier_than = BARON
				religion = ROOT
				block_general_event_trigger = no
				NOT = { has_any_opinion_modifier = opinion_blood_games_guest } # Not already tangled in some other blood games from a previous liege
			}

			letter_event = { id = HF.23441 }
		}

		character_event = {
			id = HF.23443 # Pick your champion
			days = 5
		}
	}
}

# Vassal receives invitation
letter_event = {
	id = HF.23441
	desc = EVTDESCAHF23441
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23441

		hidden_effect = {
			opinion = {
				name = opinion_blood_games_guest
				who = FROM
				months = 4
			}

			FROM = {
				opinion = {
					name = opinion_blood_games_host
					who = ROOT
					months = 4
				}

				character_event = {
					id = HF.23442 # Notify
					days = 2
					random = 3
				}
			}
		}

		character_event = {
			id = HF.23443 # Pick your champion
			days = 5
		}

		ai_chance = {
			factor = 90

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}

			mult_modifier = {
				factor = 1.5
				trait = bloodthirsty_gods_1
			}

			mult_modifier = {
				factor = 2
				trait = bloodthirsty_gods_2
			}

			mult_modifier = {
				factor = 3
				trait = bloodthirsty_gods_3
			}
		}
	}

	option = {
		name = EVTOPTBHF23441

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 5
				trait = cynical
			}

			mult_modifier = {
				factor = 3
				trait = craven
			}
		}
	}
}

# Notify liege of positive response
character_event = {
	id = HF.23442
	desc = EVTDESCAHF23442
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	notification = yes

	ai = no
	has_character_flag = flag_preparing_blood_games # Cleared on conversion

	option = {
		name = GOOD
	}
}

# Pick a champion - rulers cannot fight themselves
character_event = {
	id = HF.23443
	desc = EVTDESCAHF23443
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes
	hide_from = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		# Clear any potential champion that might still be lingering
		clear_persistent_event_target = my_blood_contender

		random_courtier = { # Pick a prisoner
			limit = {
				prisoner = yes
				is_adult = yes
				is_incapable = no

				# Sex laws check
				trigger_if = {
					limit = { is_female = no }
					male_can_hold_minor_title_trigger = yes
				}
				trigger_else = {
					female_can_hold_minor_title_trigger = yes
				}
			}

			# Always try to pick the best possible candidate
			preferred_limit = {
				combat_rating >= 200
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 200

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 200
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 200
			}

			preferred_limit = {
				combat_rating >= 150
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 150

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 150
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 150
			}

			preferred_limit = {
				combat_rating >= 100
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 100

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 100
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 100
			}

			preferred_limit = {
				combat_rating >= 50
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 50

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 50
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 50
			}

			preferred_limit = {
				combat_rating >= 25
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 25

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 25
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 25
			}

			preferred_limit = {
				combat_rating >= 10
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 10

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 10
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 10
			}

			preferred_limit = {
				combat_rating >= 0
				is_ruler = no # Prefer landless prisoners first

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 0

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 0
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = { combat_rating >= 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }

			save_event_target_as = blood_contender_prisoner
		}

		random_courtier = { # Pick a commander
			limit = {
				has_minor_title = title_commander
				is_ruler = no # Cannot risk your own vassals' life

				trigger_if = {
					limit = { is_female = no }
					male_can_hold_minor_title_trigger = yes
				}
				trigger_else = {
					female_can_hold_minor_title_trigger = yes
				}

				NOR = {
					has_character_modifier = elder_long_life_modifier
					character = event_target:blood_contender_prisoner
				}
			}

			preferred_limit = {
				combat_rating >= 200

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 200
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 200
			}

			preferred_limit = {
				combat_rating >= 150

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 150
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 150
			}

			preferred_limit = {
				combat_rating >= 100

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 100
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 100
			}

			preferred_limit = {
				combat_rating >= 50

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 50
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 50
			}

			preferred_limit = {
				combat_rating >= 25

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 25
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 25
			}

			preferred_limit = {
				combat_rating >= 10

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 10
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 10
			}

			preferred_limit = {
				combat_rating >= 0

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 0
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = { combat_rating >= 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }

			save_event_target_as = blood_contender_commander
		}

		random_courtier = { # Pick a random courtier
			limit = {
				is_adult = yes
				religion = ROOT
				is_unimportant_trigger = yes
				is_ruler = no # Cannot risk your own vassals' life
				prisoner = no
				is_incapable = no

				trigger_if = {
					limit = { is_female = no }
					male_can_hold_minor_title_trigger = yes
				}
				trigger_else = {
					female_can_hold_minor_title_trigger = yes
				}

				NOR = {
					has_character_modifier = elder_long_life_modifier
					character = event_target:blood_contender_commander
				}
			}

			preferred_limit = {
				combat_rating >= 200

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 200
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 200
			}

			preferred_limit = {
				combat_rating >= 150

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 150
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 150
			}

			preferred_limit = {
				combat_rating >= 100

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 100
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 100
			}

			preferred_limit = {
				combat_rating >= 50

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 50
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 50
			}

			preferred_limit = {
				combat_rating >= 25

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 25
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 25
			}

			preferred_limit = {
				combat_rating >= 10

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 10
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = {
				combat_rating >= 10
			}

			preferred_limit = {
				combat_rating >= 0

				OR = {
					is_strong_trigger = yes
					is_smart_trigger = yes
					has_education_martial_trigger = yes
					has_lifestyle_martial_trigger = yes
				}
			}

			preferred_limit = {
				combat_rating >= 0
				is_weak_trigger = no
				is_dumb_trigger = no
			}

			preferred_limit = { combat_rating >= 0 }
			preferred_limit = { trait = brave }
			preferred_limit = { NOT = { trait = craven } }

			save_event_target_as = blood_contender_courtier
		}

		if = {
			limit = { # In the event of no available other target...
				NOR = {
					event_target:blood_contender_prisoner = { always = yes }
					event_target:blood_contender_commander = { always = yes }
					event_target:blood_contender_courtier = { always = yes }
				}
			}

			spawn_good_commander_effect = yes # Saved as invited_character
		}
	}

	# A prisoner
	# A commander
	# A courtier
	# A spawned random guy

	option = { # Pick prisoner
		name = EVTOPTAHF23443

		trigger = { event_target:blood_contender_prisoner = { always = yes } }

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23443

			if = {
				limit = {
					event_target:blood_contender_prisoner = {
						is_alive = no # Dies after event fires but before picking the option
					}
				}

				character_event = { id = HF.23466 } # Replace
			}
			else = {
				save_persistent_event_target = {
					name = my_blood_contender
					scope = event_target:blood_contender_prisoner
				}

				event_target:blood_contender_prisoner = {
					if = {
						limit = { is_playable = yes }
						character_event = { id = HF.23444 } # If a ruler prisoner, notify of what is about to happen
					}

					set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement
					set_character_flag = flag_prisoner_waiting_for_blood_games # Check in case he gets free before time

					opinion = {
						name = opinion_blood_games_candidate # Use for clean-up
						who = ROOT
						months = 4
					}
				}

				character_event = { id = HF.23445 } # Pick equipment
			}
		}

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 10 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 20 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 30 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 40 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 50 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 60 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 70 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 80 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 90 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 100 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 120 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 140 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 160 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 180 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_prisoner = { combat_rating >= 200 }
			}

			mult_modifier = {
				factor = 1.5
				event_target:blood_contender_prisoner = { combat_rating >= 250 }
			}
		}
	}

	option = { # Pick commander
		name = EVTOPTBHF23443

		trigger = { event_target:blood_contender_commander = { is_alive = yes } }

		custom_tooltip = {
			text = TOOLTIP_EVTOPTBHF23443

			if = {
				limit = {
					event_target:blood_contender_commander = {
						is_alive = no # Dies after event fires but before picking the option
					}
				}

				character_event = { id = HF.23466 } # Replace
			}
			else = {
				save_persistent_event_target = {
					name = my_blood_contender
					scope = event_target:blood_contender_commander
				}

				event_target:blood_contender_commander = {
					set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement

					opinion = {
						name = opinion_blood_games_candidate # Use for clean-up
						who = ROOT
						months = 4
					}
				}

				character_event = { id = HF.23445 } # Pick equipment
			}
		}

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 10 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 20 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 30 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 40 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 50 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 60 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 70 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 80 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 90 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 100 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 120 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 140 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 160 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 180 }
			}

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_commander = { combat_rating >= 200 }
			}

			mult_modifier = {
				factor = 1.5
				event_target:blood_contender_commander = { combat_rating >= 250 }
			}
		}
	}

	option = { # Pick courtier
		name = EVTOPTCHF23443

		trigger = { event_target:blood_contender_courtier = { is_alive = yes } }

		custom_tooltip = {
			text = TOOLTIP_EVTOPTCHF23443

			if = {
				limit = {
					event_target:blood_contender_courtier = {
						is_alive = no # Dies after event fires but before picking the option
					}
				}

				character_event = { id = HF.23466 } # Replace
			}
			else = {
				save_persistent_event_target = {
					name = my_blood_contender
					scope = event_target:blood_contender_courtier
				}

				event_target:blood_contender_courtier = {
					set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement

					opinion = {
						name = opinion_blood_games_candidate # Use for clean-up
						who = ROOT
						months = 4
					}
				}

				character_event = { id = HF.23445 } # Pick equipment
			}
		}

		ai_chance = {
			factor = 40

			mult_modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 10 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 20 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 30 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 40 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 50 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 60 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 70 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 80 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 90 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 100 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 120 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 140 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 160 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 180 }
			}
			modifier = {
				factor = 1.25
				event_target:blood_contender_courtier = { combat_rating >= 200 }
			}
			modifier = {
				factor = 1.5
				event_target:blood_contender_courtier = { combat_rating >= 250 }
			}
		}
	}

	option = { # Pick spawned guy
		name = EVTOPTDHF23443

		trigger = { event_target:invited_character = { is_alive = yes } }

		custom_tooltip = {
			text = TOOLTIP_EVTOPTDHF23443

			if = {
				limit = {
					event_target:invited_character = {
						is_alive = no # Dies after event fires but before picking the option
					}
				}

				character_event = { id = HF.23466 } # Replace
			}
			else = {
				save_persistent_event_target = {
					name = my_blood_contender
					scope = event_target:invited_character
				}

				event_target:invited_character = {
					set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement

					opinion = {
						name = opinion_blood_games_candidate # Use for clean-up
						who = ROOT
						months = 4
					}
				}

				character_event = { id = HF.23445 } # Pick equipment
			}
		}

		ai_chance = { factor = 60 }
	}
}

# Imprisoned ruler notified that he has been picked
character_event = {
	id = HF.23444
	desc = EVTDESCAHF23444
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes

	ai = no

	option = {
		name = {
			text = EVTOPTAHF23444
			trigger = { trait = brave }
		}
		name = {
			text = EVTOPTBHF23444
			trigger = { NOT = { trait = brave } }
		}
	}
}

# Pick equipment
character_event = {
	id = HF.23445
	desc = EVTDESCAHF23445
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	# Mystic potion
	# Deceitful poison
	# Costly armor
	# Regular equipment

	option = {
		name = EVTOPTAHF23445
		tooltip_info = mystic

		trigger = { trait = mystic }

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = fearless_potion
				months = 3
			}
		}

		ai_chance = { factor = 60 }
	}

	option = {
		name = EVTOPTBHF23445
		tooltip_info = deceitful

		trigger = { trait = deceitful }

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = poisoned_weapons
				months = 3
			}
		}

		ai_chance = { factor = 60 }
	}

	option = {
		name = EVTOPTCHF23445

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -50
				max = -150
			}
		}

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = gladiatorial_equipment
				months = 3
			}
		}

		ai_chance = { factor = 20 }
	}

	option = {
		name = EVTOPTEHF23445
		tooltip_info_custom = EVTOPTEHF23445_tt

		trigger = {
			any_realm_wonder_upgrade = {
				has_wonder_upgrade = upgrade_animal_cages
				is_active = yes
			}
		}

		ai_chance = { factor = 10 }
	}

	option = { # Nothing
		name = EVTOPTDHF23445

		ai_chance = { factor = 30 }
	}

	after = {
		if = {
			limit = { has_character_modifier = bloodthirsty_games_cooldown } # The host

			character_event = {
				id = HF.23452 # Start the tournament
				days = 12
			}
		}
	}
}

# Getting clean-up events out of the way first...
# on_released_from_prison: If your champion is a prisoner and he is released before the tournament starts, you cannot use him
# hidden ping from prisoner
character_event = {
	id = HF.23446

	is_triggered_only = yes # on_released_from_prison
	hide_window = yes

	has_character_flag = flag_prisoner_waiting_for_blood_games

	immediate = {
		clr_character_flag = flag_prisoner_waiting_for_blood_games
		clr_character_flag = flag_blood_contender
		remove_character_modifier = fearless_potion
		remove_character_modifier = poisoned_weapons
		remove_character_modifier = gladiatorial_equipment

		if = {
			limit = {
				FROM = {
					persistent_event_target:my_blood_contender = { character = ROOT }

					# Is either guest or host of blood games, and blood games have not started yet
					OR = {
						has_any_opinion_modifier = opinion_blood_games_guest
						has_character_flag = flag_preparing_blood_games
					}
				}
			}

			remove_opinion = {
				name = opinion_blood_games_candidate
				who = FROM
			}

			FROM = {
				clear_persistent_event_target = my_blood_contender
				character_event = { id = HF.23447 }
			}
		}
	}
}

# Ruler informed that he has no champion
character_event = {
	id = HF.23447
	desc = EVTDESCAHF23447
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = { multiplayer = no } # With the delay, the new contender might not make it in time before the tournament ends
			spawn_good_commander_effect = yes # Saved as invited_character
		}
	}

	option = {
		name = EVTOPTAHF23447

		trigger = {
			multiplayer = no
			event_target:invited_character = { always = yes }
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -50
				max = -150
			}
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23447

			save_persistent_event_target = {
				name = my_blood_contender
				scope = event_target:invited_character
			}

			event_target:invited_character = {
				set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement
			}

			character_event = { id = HF.23461 }
		}

		ai_chance = { factor = 10 }
	}

	option = {
		name = EVTOPTBHF23447

		hidden_effect = {
			event_target:invited_character = {
				death = { death_reason = death_missing }
			}
		}

		ai_chance = { factor = 90 }
	}
}

# on_death: If your champion dies before the tournament starts, you cannot use him
# Hidden ping from dying man
character_event = {
	id = HF.23448

	is_triggered_only = yes # on_death
	hide_window = yes

	has_character_flag = flag_blood_contender

	immediate = {
		random_opinion_modifier_target = {
			limit = {
				persistent_event_target:my_blood_contender = { character = ROOT }

				# Is either guest or host of blood games, and blood games have not started yet
				OR = {
					has_any_opinion_modifier = opinion_blood_games_guest
					has_character_flag = flag_preparing_blood_games
				}
			}

			clear_persistent_event_target = my_blood_contender
			character_event = { id = HF.23449 }
		}
	}
}

# Ruler informed that he has no champion
character_event = {
	id = HF.23449
	desc = EVTDESCAHF23449
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = { multiplayer = no } # With the delay, the new contender might not make it in time before the tournament ends
			spawn_good_commander_effect = yes # Saved as invited_character
		}
	}

	option = {
		name = EVTOPTAHF23449

		trigger = {
			multiplayer = no
			event_target:invited_character = { always = yes }
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23449

			save_persistent_event_target = {
				name = my_blood_contender
				scope = event_target:invited_character
			}

			event_target:invited_character = {
				set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement
			}

			character_event = { id = HF.23461 }
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -50
				max = -150
			}
		}

		ai_chance = { factor = 10 }
	}

	option = {
		name = EVTOPTBHF23449

		ai_chance = { factor = 90 }
	}
}

# Ruler informed that he has no champion
character_event = {
	id = HF.23466
	desc = EVTDESCAHF23466
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	immediate = {
		if = {
			limit = { multiplayer = no } # With the delay, the new contender might not make it in time before the tournament ends
			spawn_good_commander_effect = yes # Saved as invited_character
		}
	}

	option = {
		name = EVTOPTAHF23449

		trigger = {
			multiplayer = no
			event_target:invited_character = { always = yes }
		}

		custom_tooltip = {
			text = TOOLTIP_EVTOPTAHF23449

			save_persistent_event_target = {
				name = my_blood_contender
				scope = event_target:invited_character
			}

			event_target:invited_character = {
				set_character_flag = flag_blood_contender # Check in case he dies before time and you wish to make a last minute replacement
			}

			if = {
				limit = { event_target:invited_character = { is_alive = yes } }
				character_event = { id = HF.23461 }
			}
		}

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -50
				max = -150
			}
		}

		ai_chance = { factor = 10 }
	}

	option = {
		name = EVTOPTBHF23449

		ai_chance = { factor = 90 }
	}

	after = {
		if = {
			limit = { has_character_modifier = bloodthirsty_games_cooldown } # The host

			character_event = {
				id = HF.23452
				days = 12 # Start the tournament
			}
		}
	}
}

# on_death: The Tournament's host dies before the tournament starts
character_event = {
	id = HF.23450

	is_triggered_only = yes # on_death
	hide_window = yes

	has_character_flag = flag_preparing_blood_games

	immediate = {
		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					name = opinion_blood_games_guest
					who = ROOT
				}
			}

			character_event = { id = HF.23451 }
		}
	}
}

# Other guests are notified that the tournament has been canceled
character_event = {
	id = HF.23451
	desc = EVTDESCAHF23451
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes
	hide_new = yes

	option = {
		name = EVTOPTAHF23451

		hidden_effect = {
			reverse_remove_opinion = {
				name = opinion_blood_games_candidate
				who = persistent_event_target:my_blood_contender
			}

			clear_persistent_event_target = my_blood_contender
		}
	}
}

# The Tournament is about to start (liege)
character_event = {
	id = HF.23452
	desc = EVTDESCAHF23452
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes
	hide_new = yes

	has_character_flag = flag_preparing_blood_games # Removed in case of conversion

	option = {
		name = EVTOPTAHF23452

		any_player = {
			limit = {
				has_opinion_modifier = {
					name = opinion_blood_games_guest
					who = ROOT
				}
			}

			character_event = { id = HF.23453 }
		}

		character_event = {
			id = HF.23454 # Actual tournament
			days = 4
		}
	}
}

# Tournament is about to start (guests)
character_event = {
	id = HF.23453
	desc = EVTDESCAHF23453
	picture = GFX_evt_sun_temple
	border = GFX_event_normal_frame_religion
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes
	hide_new = yes

	option = {
		name = EVTOPTAHF23453
	}
}

# Tournament starts (liege)
character_event = {
	id = HF.23454
	desc = EVTDESCAHF23454
	picture = GFX_evt_melee_arabic
	border = GFX_event_normal_frame_religion
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes
	hide_new = yes

	has_character_flag = flag_preparing_blood_games # Removed in case of conversion

	option = {
		name = EVTOPTAHF23454

		hidden_effect = {
			## Determine the winner of the tournament
			# First, pick the five best contenders in the realm
			pick_potential_blood_games_winners_effect = yes
			# Now determine the winner amongst them, semi-randomly
			pick_blood_games_winner_effect = yes
		}
	}
}

# Winner of the tournament
character_event = {
	id = HF.23455
	title = EVTTITLEAHF23455
	desc = EVTDESCAHF23455
	picture = GFX_evt_melee_arabic
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes # pick_blood_games_winner_effect
	hide_new = yes

	immediate = {
		# Sacrifice all the losers to the gods
		FROM = { # Host
			any_realm_character = {
				limit = {
					has_character_flag = flag_blood_contender
					NOT = { character = ROOT }
				}

				if = {
					limit = { is_ruler = yes }
					character_event = { id = HF.23456 } # Send it as an event, as it might be an imprisoned ruler fighting for his life
				}
				else = {
					clr_character_flag = flag_blood_contender

					death = {
						death_reason = death_execution_aztec_sacrifice
						killer = FROM # The host
					}
				}
			}

			character_event = { id = HF.23460 } # Notify liege
		}

		clr_character_flag = flag_prisoner_waiting_for_blood_games
		clr_character_flag = flag_blood_contender

		# Get highest tier
		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes

		# Chance of injury
		random_list = {
			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_legged }
				}

				add_trait = one_legged
			}

			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_handed }
				}

				add_trait = one_handed
			}

			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = disfigured }
				}

				add_trait = disfigured
			}

			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = one_eyed }
				}

				add_trait = one_eyed
			}

			1 = {
				trigger = {
					has_dlc = "Reapers"
					NOT = { trait = mangled }
				}

				add_trait = mangled
			}

			1 = {
				trigger = {
					NOR = {
						has_dlc = "Reapers"
						trait = maimed
					}
				}

				add_trait = maimed
			}

			5 = {
				if = {
					limit = { has_dlc = "Holy Fury" }

					change_variable = {
						which = scarred_variable # Bonus scars
						value = 4
					}
				}

				add_scarred_tiered_effect = yes # Gives regular Scarred trait otherwise
			}

			5 = { add_trait_wounded_effect = yes }

			5 = {
				trigger = { has_dlc = "Holy Fury" }
				add_random_tattoo_effect = yes
			}

			80 = { } # Nothing
		}

		# Give a nickname
		if = {
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
			}

			random_list = {
				10 = { give_nickname = nick_the_skull_crusher }
				10 = { give_nickname = nick_the_quick_foot }
				10 = { give_nickname = nick_the_bleeder }
				10 = { give_nickname = nick_the_sharp_teeth }
				10 = { give_nickname = nick_the_crimson_flurry }
				10 = { give_nickname = nick_the_champion_of_province }
				10 = { give_nickname = nick_the_destroyer }
				10 = { give_nickname = nick_the_bone_gnasher }
				10 = { give_nickname = nick_the_survivor }
				10 = { give_nickname = nick_the_gods_champion }
				10 = { give_nickname = nick_the_exalted_chosen_of_province }
				10 = { give_nickname = nick_the_scarlet_painter }

				10 = {
					trigger = { is_female = no }
					give_nickname = nick_the_red_gladiator
				}

				10 = {
					trigger = { is_female = no }
					give_nickname = nick_the_scarlet_eagle
				}

				10 = {
					trigger = { is_female = yes }
					give_nickname = nick_the_red_gladiatrix
				}

				10 = {
					trigger = { is_female = yes }
					give_nickname = nick_the_crimson_gorgon
				}
			}
		}

		remove_character_modifier = fearless_potion
		remove_character_modifier = poisoned_weapons
		remove_character_modifier = gladiatorial_equipment
	}

	option = {
		name = EVTOPTAHF23455

		prestige = 200

		if = { # Of same religion, the gods blessed you
			limit = { religion = FROM }
			piety = 100
		}

		if = { # Earned your freedom
			limit = { prisoner = yes }
			imprison = no
		}

		add_character_modifier = {
			name = survived_blood_games
			duration = -1
			stacking = yes
		}
	}
}

# Tournament loser is sacrified to the gods
character_event = {
	id = HF.23456
	title = EVTTITLEAHF23455
	desc = EVTDESCAHF23456
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes
	hide_new = yes

	immediate = {
		clr_character_flag = flag_blood_contender

		if = {
			limit = { multiplayer = yes }

			death = {
				death_reason = death_execution_aztec_sacrifice
				killer = FROMFROM # The host
			}
		}
	}

	option = {
		name = EVTOPTAHF23456

		if = {
			limit = { multiplayer = no }

			death = {
				death_reason = death_execution_aztec_sacrifice
				killer = FROMFROM # The host
			}
		}
		else = {
			tooltip = {
				death = {
					death_reason = death_execution_aztec_sacrifice
					killer = FROMFROM # The host
				}
			}
		}
	}
}

# Tournament is over, FROM is the winner (liege)
character_event = {
	id = HF.23460
	title = EVTTITLEAHF23460
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23460 # Your guy won
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROM
			}
		}
	}
	desc = {
		text = EVTDESCBHF23460 # Your guy lost
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROM
				}
			}
		}
	}

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes
	hide_new = yes

	immediate = {
		clr_character_flag = flag_preparing_blood_games

		reverse_remove_opinion = {
			name = opinion_blood_games_candidate
			who = persistent_event_target:my_blood_contender
		}

		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					name = opinion_blood_games_guest
					who = ROOT
				}
			}

			character_event = { id = HF.23457 }

			remove_opinion = {
				name = opinion_blood_games_guest
				who = ROOT
			}

			reverse_remove_opinion = {
				name = opinion_blood_games_host
				who = ROOT
			}
		}
	}

	option = { # My guy won
		name = EVTOPTAHF23460

		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROM
			}
		}

		tiered_piety_reward_effect = yes

		hidden_effect = {
			change_variable = {
				which = burned_hearts_points
				value = 10
			}
		}
	}

	option = { # Another guy won
		name = EVTOPTBHF23460

		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROM
				}
			}
		}
	}

	after = {
		hidden_effect = {
			bloodthirsty_tiered_traits_effect = yes # Get a point regardless of outcome
			clear_persistent_event_target = my_blood_contender
		}
	}
}

# Tournament is over, FROMFROM is the winner (guests)
character_event = {
	id = HF.23457
	title = EVTTITLEAHF23457
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23457 # Your guy won
		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROMFROM
			}
		}
	}
	desc = {
		text = EVTDESCBHF23457 # Your guy lost
		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROMFROM
				}
			}
		}
	}

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes
	hide_new = yes
	show_from_from = yes

	immediate = {
		reverse_remove_opinion = {
			name = opinion_blood_games_candidate
			who = persistent_event_target:my_blood_contender
		}
	}

	option = { # My guy won
		name = EVTOPTAHF23457

		trigger = {
			persistent_event_target:my_blood_contender = {
				character = FROMFROM
			}
		}

		opinion = {
			name = opinion_held_blood_games
			who = FROM
			years = 5
		}

		tiered_piety_reward_effect = yes

		hidden_effect = {
			change_variable = {
				which = burned_hearts_points
				value = 10
			}
		}
	}

	option = { # Another guy won
		name = EVTOPTBHF23457

		trigger = {
			NOT = {
				persistent_event_target:my_blood_contender = {
					character = FROMFROM
				}
			}
		}

		opinion = {
			name = opinion_held_blood_games
			who = FROM
			years = 5
		}
	}

	after = {
		hidden_effect = {
			bloodthirsty_tiered_traits_effect = yes # Get a point regardless of outcome
			clear_persistent_event_target = my_blood_contender
		}
	}
}

# on_conversion cleanup - If the host converts to a religion without the bloodthirsty gods doctrine, the whole thing is off
character_event = {
	id = HF.23458
	desc = EVTDESCAHF23458
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes # on_character_convert_religion
	hide_new = yes

	has_character_flag = flag_preparing_blood_games

	trigger = {
		NOT = { has_religion_feature = religion_ritual_sacrifice }
		religion_openly_aztec_or_reformed_trigger = no
	}

	immediate = {
		clr_character_flag = flag_preparing_blood_games

		any_opinion_modifier_target = {
			limit = {
				has_opinion_modifier = {
					name = opinion_blood_games_guest
					who = ROOT
				}
			}

			character_event = { id = HF.23459 }

			remove_opinion = {
				name = opinion_blood_games_guest
				who = ROOT
			}

			reverse_remove_opinion ={
				name = opinion_blood_games_host
				who = ROOT
			}

			persistent_event_target:my_blood_contender = {
				remove_opinion = {
					name = opinion_blood_games_candidate
					who = PREV
				}
			}

			clear_persistent_event_target = my_blood_contender
		}

		reverse_remove_opinion = {
			name = opinion_blood_games_candidate
			who = persistent_event_target:my_blood_contender
		}

		clear_persistent_event_target = my_blood_contender
	}

	option = {
		name = EVTOPTAHF23458

	}
}

# Notify vassals
character_event = {
	id = HF.23459
	desc = EVTDESCAHF23459
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes
	hide_new = yes

	ai = no

	option = {
		name = {
			text = EVTOPTAHF23459
			trigger = {
				OR = {
					has_religion_feature = religion_ritual_sacrifice
					religion_openly_aztec_or_reformed_trigger = yes
				}
			}
		}
		name = {
			text = EVTOPTBHF23459
			trigger = {
				NOT = { has_religion_feature = religion_ritual_sacrifice }
				religion_openly_aztec_or_reformed_trigger = no
			}
		}
	}
}

# HF.23460 taken by double event

# Pick equipment - Version for spare warrior, same events, but doesn't fire the tournament again.
character_event = {
	id = HF.23461
	desc = EVTDESCAHF23445
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_religion
	portrait = persistent_event_target:my_blood_contender

	is_triggered_only = yes
	hide_new = yes

	trigger = {
		OR = {
			has_character_flag = flag_preparing_blood_games
			has_any_opinion_modifier = opinion_blood_games_guest
		}
	}

	# Mystic potion
	# Deceitful poison
	# Costly armor
	# Regular equipment

	option = {
		name = EVTOPTAHF23445
		tooltip_info = mystic

		trigger = { trait = mystic }

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = fearless_potion
				months = 3
			}
		}

		ai_chance = { factor = 60 }
	}

	option = {
		name = EVTOPTBHF23445
		tooltip_info = deceitful

		trigger = { trait = deceitful }

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = poisoned_weapons
				months = 3
			}
		}

		ai_chance = { factor = 60 }
	}

	option = {
		name = EVTOPTCHF23445

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -0.5
				min = -50
				max = -150
			}
		}

		persistent_event_target:my_blood_contender = {
			show_scope_change = no

			add_character_modifier = {
				name = gladiatorial_equipment
				months = 3
			}
		}

		ai_chance = { factor = 20 }
	}

	option = { # Nothing
		name = EVTOPTDHF23445

		ai_chance = { factor = 30 }
	}
}

######################################################################################################
######################################################################################################
## Bloodthirsty Gods: The Mass Sacrifice - Available from trait tier 2 and above

# Decide how many people are you going to sacrifice
character_event = {
	id = HF.23462
	desc = EVTDESCAHF23462
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes
	hide_new = yes

	option = {
		name = EVTOPTAHF23462

		add_character_modifier = {
			name = bloodthirsty_mass_sacrifice_bonus_3
			years = 10
		}

		religion_authority = {
			name = bloodthirsty_mass_sacrifice
			years = 100
		}

		if = {
			limit = { is_nomadic = yes }
			population = -2000
		}
		else = {
			custom_tooltip = {
				text = TOOLTIP_EVTOPTAHF23462

				any_demesne_province = {
					limit = { owned_by = PREV }

					add_province_modifier = {
						name = bloodthirsty_mass_sacrifice_province_2
						years = 10
						stacking = yes
					}
				}
			}
		}

		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes

		hidden_effect = {
			if = {
				limit = { has_dlc = "Reapers" }

				any_demesne_province = {
					limit = { owned_by = PREV }

					change_variable = {
						which = prosperity_value
						value = -40
					}

					if = {
						limit = {
							check_variable = {
								which = prosperity_value
								value < 0
							}
						}

						set_variable = {
							which = prosperity_value
							value = 0
						}
					}
				}
			}

			if = {
				limit = { this_has_super_cool_nickname_trigger = no }

				random_list = {
					20 = { give_nickname = nick_the_red_storm }
					20 = { give_nickname = nick_the_scarlet_hands }
					20 = { give_nickname = nick_the_blood_monger }
					20 = { give_nickname = nick_the_black_skull }
					20 = { give_nickname = nick_the_heart_eater }
					20 = { give_nickname = nick_the_slaughterer }
					20 = { give_nickname = nick_the_soul_flayer }
					20 = { give_nickname = nick_the_spirit_stalker }
					10 = { give_nickname = nick_the_crimson_reaper }
					10 = { give_nickname = nick_the_dreaded }
					5  = { give_nickname = nick_the_chest_buster }
					70 = { } # Nothing
				}
			}

			change_variable = {
				which = burned_hearts_points
				value = 15
			}
		}

		# Opinion bonus towards vassals of same religion (through event)
		ai_chance = { factor = 10 }
	}

	option = {
		name = EVTOPTBHF23462

		add_character_modifier = {
			name = bloodthirsty_mass_sacrifice_bonus_2
			years = 10
		}

		if = {
			limit = { is_nomadic = yes }
			population = -1000
		}
		else = {
			custom_tooltip = {
				text = TOOLTIP_EVTOPTBHF23462

				any_demesne_province = {
					limit = { owned_by = PREV }

					add_province_modifier = {
						name = bloodthirsty_mass_sacrifice_province_1
						years = 10
						stacking = yes
					}
				}
			}
		}

		add_blood_splatter_effect = yes
		add_blood_splatter_effect = yes

		hidden_effect = {
			if = {
				limit = { has_dlc = "Reapers" }

				any_demesne_province = {
					limit = { owned_by = PREV }

					change_variable = {
						which = prosperity_value
						value = -20
					}

					if = {
						limit = {
							check_variable = {
								which = prosperity_value
								value < 0
							}
						}

						set_variable = {
							which = prosperity_value
							value = 0
						}
					}
				}
			}

			change_variable = {
				which = burned_hearts_points
				value = 10
			}
		}

		ai_chance = { factor = 20 }
	}

	option = {
		name = EVTOPTCHF23462

		add_blood_splatter_effect = yes

		add_character_modifier = {
			name = bloodthirsty_mass_sacrifice_bonus_1
			years = 5
		}

		if = {
			limit = { is_nomadic = yes }
			population = -500
		}
		else = {
			capital_scope = {
				show_scope_change = no

				add_province_modifier = {
					name = bloodthirsty_mass_sacrifice_province_1
					years = 10
					stacking = yes
				}

				hidden_effect = {
					if = {
						limit = { has_dlc = "Reapers" }

						change_variable = {
							which = prosperity_value
							value = -10
						}

						if = {
							limit = {
								check_variable = {
									which = prosperity_value
									value < 0
								}
							}

							set_variable = {
								which = prosperity_value
								value = 0
							}
						}
					}
				}
			}
		}

		hidden_effect = {
			change_variable = {
				which = burned_hearts_points
				value = 5
			}
		}

		ai_chance = { factor = 30 }
	}

	option = { # Nothing
		name = EVTOPTDHF23462

		hidden_effect = {
			remove_character_modifier = bloodthirsty_mass_sacrifice_cooldown
		}

		ai_chance = { factor = 0 }
	}

	after = {
		hidden_effect = {
			if = {
				limit = { has_character_modifier = bloodthirsty_mass_sacrifice_cooldown }

				any_vassal = {
					limit = { is_playable = yes }

					if = {
						limit = { religion = ROOT }
						character_event = { id = HF.23463 }
					}
					else_if = {
						limit = {
							religion_openly_aztec_or_reformed_trigger = no
							NOT = { has_religion_feature = religion_ritual_sacrifice }
						}

						character_event = { id = HF.23464 }
					}
				}

				any_current_enemy = {
					limit = { independent = yes }
					character_event = { id = HF.23465 }
				}

				bloodthirsty_tiered_traits_effect = yes
			}
		}
	}
}

# Bloodthirsty vassals notified
character_event = {
	id = HF.23463
	desc = EVTDESCAHF23463
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23463

		opinion = {
			name = opinion_mass_sacrifice_positive
			who = ROOT
			years = 5
		}
	}
}

# Non-bloodthirsty vassals notified
character_event = {
	id = HF.23464
	desc = EVTDESCAHF23464
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23464

		opinion = {
			name = opinion_mass_sacrifice_negative
			who = ROOT
			years = 5
		}
	}
}

# War enemy notified
character_event = {
	id = HF.23465
	desc = EVTDESCAHF23465
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bishop_aztec
		trigger = { religion_openly_aztec_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_pagan_blood_sacrifice
		trigger = { religion_openly_aztec_or_reformed_trigger = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23465

		trigger = {
			OR = {
				religion_openly_aztec_or_reformed_trigger = yes
				has_religion_feature = religion_ritual_sacrifice
			}
		}

		random = {
			chance = 20
			add_trait_stressed_effect = yes
		}

		add_character_modifier = {
			name = enemy_made_mass_sacrifice
			years = 2
		}
	}

	option = {
		name = EVTOPTBHF23465

		trigger = {
			religion_openly_aztec_or_reformed_trigger = no
			NOT = { has_religion_feature = religion_ritual_sacrifice }
		}
	}
}

# HF.23466 taken

#############################################################################################################
#############################################################################################################

# Building an Irminsul
character_event = {
	id = HF.23470
	title = EVTTITLEHF23470
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23470
		trigger = { religion = norse_pagan }
	}
	desc = {
		text = EVTDESCBHF23470
		trigger = { religion = tengri_pagan }
	}
	desc = {
		text = EVTDESCCHF23470
		trigger = { religion = slavic_pagan }
	}
	desc = {
		text = EVTDESCDHF23470
		trigger = { religion = baltic_pagan }
	}
	desc = {
		text = EVTDESCEHF23470
		trigger = { religion = finnish_pagan }
	}
	desc = {
		text = EVTDESCFHF23470
		trigger = { religion = west_african_pagan }
	}
	desc = {
		text = EVTDESCGHF23470
		trigger = { religion = aztec_pagan }
	}
	desc = {
		text = EVTDESCHHF23470
		trigger = { religion = bon_pagan }
	}
	desc = {
		text = EVTDESCIHF23470
		trigger = { religion = zun_pagan }
	}
	desc = {
		text = EVTDESCLHF23470
		trigger = { religion = hellenic_pagan }
	}

	is_triggered_only = yes # tribal_build_great_pillar, HF_religious_decisions.txt

	option = {
		name = EVTOPTAHF23470

		tiered_prestige_reward_effect = yes

		religion_authority = {
			name = built_great_pillar
			years = 50
		}

		add_character_modifier = {
			name = recently_built_great_pillar
			years = 5
		}

		any_vassal = {
			character_event = { id = HF.23471 }
		}
	}
}

# Vassals notified
character_event = {
	id = HF.23471
	title = EVTTITLEHF23471
	desc = EVTDESCAHF23471
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23471

		trigger = { religion = FROM }

		add_character_modifier = {
			name = recently_built_great_pillar
			years = 1
		}
	}

	option = {
		name = I_SEE

		trigger = {
			NOT = { religion = FROM }
		}
	}
}

# on_startup event giving Irminsul to the Saxon Kingdom on Charlemagne start
character_event = {
	id = HF.23472

	is_triggered_only = yes # on_startup
	hide_window = yes

	religion = norse_pagan # Could be ruler-designed

	trigger = {
		always = no # Not used in Plus
		has_landed_title = k_saxony
		year < 774
		is_save_game = no
		is_alternate_start = no
	}

	immediate = {
		b_paderborn = {
			add_building = tp_great_pillar_norse
			location = { set_province_flag = flag_great_pillar_norse_irminsul }
		}

		religion_authority = {
			name = built_great_pillar
			years = 50
		}
	}
}

# on_siege_over_winner: Destroying a Great Pillar. (ROOT is besieger, FROM is besieged holding)
character_event = {
	id = HF.23473
	title = EVTTITLEHF23473
	desc = EVTDESCAHF23473
	picture = GFX_evt_irminsul_burning

	is_triggered_only = yes # on_siege_over_winner

	has_dlc = "Holy Fury"

	trigger = {
		is_not_unreformed_pagan_trigger = yes

		FROM = {
			holding_type = tribal

			location = {
				trigger_if = {
					limit = { has_province_flag = flag_great_pillar_norse }
					ROOT = { religion_openly_norse_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_tengri }
					ROOT = { religion_openly_tengri_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_slavic }
					ROOT = { religion_openly_slavic_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_baltic }
					ROOT = { religion_openly_baltic_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_finnish }
					ROOT = { religion_openly_finnish_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_west_african }
					ROOT = { religion_openly_west_african_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_aztec }
					ROOT = { religion_openly_aztec_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_bon }
					ROOT = { religion_openly_bon_or_reformed_trigger = no }
				}
				trigger_else_if = {
					limit = { has_province_flag = flag_great_pillar_zun }
					ROOT = { religion_openly_zun_or_reformed_trigger = no }
				}
				trigger_else = {
					has_province_flag = flag_great_pillar_hellenic
					ROOT = { religion_openly_hellenic_or_reformed_trigger = no }
				}
			}

			holder_scope = {
				top_liege = {
					any_war = {
						attacker = { character = ROOT }
					}
				}
			}
		}
	}

	option = { # Destroy it!
		name = EVTOPTAHF23473

		custom_tooltip = { text = tooltip_destroy_great_pillar }

		if = {
			limit = { has_religion_feature = religion_dogmatic }
			tiered_piety_reward_effect = yes
		}
		else_if = {
			limit = { has_religion_feature = religion_cosmopolitan }
			tiered_piety_negative_effect = yes
		}

		hidden_effect = {
			# Remove the flag to destroy the actual building
			FROM = {
				location = {
					trigger_switch = {
						on_trigger = has_province_flag

						flag_great_pillar_norse = {
							clr_province_flag = flag_great_pillar_norse

							norse_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = norse_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_tengri = {
							clr_province_flag = flag_great_pillar_tengri

							tengri_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = tengri_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_slavic = {
							clr_province_flag = flag_great_pillar_slavic

							slavic_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = slavic_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_baltic = {
							clr_province_flag = flag_great_pillar_baltic

							baltic_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = baltic_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_finnish = {
							clr_province_flag = flag_great_pillar_finnish

							finnish_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = finnish_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_west_african = {
							clr_province_flag = flag_great_pillar_west_african

							west_african_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = west_african_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_aztec = {
							clr_province_flag = flag_great_pillar_aztec

							aztec_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = aztec_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_zun = {
							clr_province_flag = flag_great_pillar_zun

							zun_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = zun_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_bon = {
							clr_province_flag = flag_great_pillar_bon

							bon_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = bon_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}

						flag_great_pillar_hellenic = {
							clr_province_flag = flag_great_pillar_hellenic

							hellenic_pagan = {
								religion_authority = {
									name = destroyed_great_pillar
									years = 10
								}
							}

							ROOT_FROM = {
								holder_scope = {
									top_liege = {
										any_realm_character = {
											limit = { religion = hellenic_pagan }
											character_event = { id = HF.23474 }
										}
									}
								}
							}
						}
					}
				}
			}
		}

		ai_chance = {
			factor = 80

			mult_modifier = {
				factor = 0.3
				religion_group = pagan_group
			}

			mult_modifier = {
				factor = 0.4
				trait = sympathy_pagans
			}

			mult_modifier = {
				factor = 0.75
				trait = cynical
			}
		}
	}

	option = { # Leave it be
		name = EVTOPTBHF23473

		if = {
			limit = { NOT = { religion_group = pagan_group } } # Friend of heathens

			tiered_piety_negative_effect = yes

			if = {
				limit = { NOT = { trait = sympathy_pagans } }

				random = {
					chance = 25
					add_trait = sympathy_pagans
				}
			}
		}

		random = {
			chance = 25
			remove_trait_zealous_effect = yes
		}

		ai_chance = {
			factor = 20

			trigger = {
				NOT = { trait = zealous }
			}
		}
	}
}

# Realm Pagans notified of Pillar's destruction
character_event = {
	id = HF.23474
	title = EVTTITLEHF23474
	desc = EVTDESCAHF23474
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23474

		trigger = { religion_group = pagan_group }

		tooltip = { # Already removed in previous event
			religion_authority = {
				name = destroyed_great_pillar
				years = 10
			}
		}

		if = {
			limit = { has_character_modifier = recently_built_great_pillar }
			remove_character_modifier = recently_built_great_pillar
		}

		add_character_modifier = { # Prevents rebuilding one immediately after
			name = recently_destroyed_great_pillar_cooldown
			years = 30
		}

		opinion = {
			name = opinion_sacrilege
			who = FROM
			years = 10
		}
	}

	option = {
		name = EVTOPTBHF23474

		trigger = {
			NOT = { religion_group = pagan_group }
		}
	}
}

# Ruler has destroyed Great Pillar within his own realm
character_event = {
	id = HF.23476
	title = EVTTITLEHF23476
	desc = EVTDESCAHF23476
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23476
	}
}

# Pagan vassals of ruler react
character_event = {
	id = HF.23477
	title = EVTTITLEHF23477
	desc = EVTDESCAHF23477
	picture = GFX_evt_irminsul_burning
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23477

		tooltip = { # Already removed in previous event
			religion_authority = {
				name = destroyed_great_pillar
				years = 10
			}
		}

		if = {
			limit = { has_character_modifier = recently_built_great_pillar }
			remove_character_modifier = recently_built_great_pillar
		}

		add_character_modifier = { # Prevents rebuilding one immediately after
			name = recently_destroyed_great_pillar_cooldown
			years = 30
		}

		opinion = {
			name = opinion_sacrilege
			who = FROMFROM
			years = 10
		}
	}
}

###############################################################

############################################################

# on_new_holder: Check succession/women's status when creating new vassals
# ROOT is the character
# FROM is the title
# FROMFROM is the old holder
character_event = {
	id = HF.23700

	is_triggered_only = yes # on_new_holder
	hide_window = yes

	trigger = {
		trigger_if = {
			limit = { has_religion_feature = religion_patriarchal }
			FROMFROM = { has_religion_feature = religion_patriarchal }
		}
		trigger_else_if = {
			limit = {
				OR = {
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
				}
			}

			FROMFROM = {
				OR = {
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
				}
			}
		}
		trigger_else = {
			has_religion_feature = religion_matriarchal
			FROMFROM = { has_religion_feature = religion_matriarchal }
		}
	}

	immediate = {
		character_event = {
			id = HF.23701
			days = 1
		}
	}
}

character_event = {
	id = HF.23701

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		if = {
			limit = {
				has_religion_feature = religion_matriarchal
				is_patrician = no # Always use agnatic
			}

			FROMFROM = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = enatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
		else_if = {
			limit = { has_religion_feature = religion_patriarchal }

			FROMFROM = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_0
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = agnatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
		else_if = {
			limit = {
				OR = {
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_bon
				}

				is_patrician = no # Always use agnatic
			}

			FROMFROM = {
				set_title_flag = non_manual_law_change # No prestige loss

				add_law = {
					law = status_of_women_4
					cooldown = no
					opinion_effect = no
				}

				add_law = {
					law = true_cognatic_succession
					cooldown = no
					opinion_effect = no
				}

				clr_title_flag = non_manual_law_change # No prestige loss
			}
		}
	}
}

###############################################################

###############################################################

# Doctrine Flavor: Stability
# on_birth: Primary Heir is born, decide what to do with him
# Check if ruler's son and new heir, send delayed event
character_event = {
	id = HF.23750

	is_triggered_only = yes # on_birth
	hide_window = yes

	trigger = {
		liege = {
			is_playable = yes
			is_parent_of = ROOT
			religion = ROOT

			OR = {
				has_religion_feature = religion_stable
				has_religion_feature = religion_feature_slavic
				has_religion_feature = religion_feature_finnish
				has_religion_feature = religion_feature_egyptian
			}
		}
	}

	immediate = {
		save_event_target_as = child_heir

		liege = {
			character_event = {
				id = HF.23751
				days = 100
				random = 70
			}
		}
	}
}

# Parent-liege receives event and decides what to do
character_event = {
	id = HF.23751
	picture = GFX_evt_birth
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23751
		trigger = { event_target:child_heir = { is_ill = yes } }
	}
	desc = {
		text = EVTDESCBHF23751
		trigger = { event_target:child_heir = { is_ill = no } }
	}

	is_triggered_only = yes

	trigger = {
		player_heir = {
			character = event_target:child_heir
		}
	}

	option = {
		name = EVTOPTAHF23751

		trigger = { has_religion_feature = religion_astrology } # Synergy

		custom_tooltip = {
			text = TT_EVTOPTAHF23751

			random_list = {
				15 = {
					mult_modifier = { factor = 1.5 piety >= 150 }
					mult_modifier = { factor = 1.5 piety >= 250 }
					mult_modifier = { factor = 1.5 piety >= 350 }
					mult_modifier = { factor = 1.5 piety >= 450 }
					mult_modifier = { factor = 1.5 piety >= 550 }
					mult_modifier = { factor = 1.5 piety >= 650 }
					mult_modifier = { factor = 1.5 piety >= 750 }
					mult_modifier = { factor = 1.5 piety >= 850 }
					mult_modifier = { factor = 1.5 piety >= 950 }
					mult_modifier = { factor = 1.75 piety >= 1250 }
					mult_modifier = { factor = 2 piety >= 2000 }
					mult_modifier = { factor = 4 piety >= 2000 }
					mult_modifier = { factor = 1.5 learning >= 8 }
					mult_modifier = { factor = 1.5 learning >= 10 }
					mult_modifier = { factor = 1.5 learning >= 12 }
					mult_modifier = { factor = 1.5 learning >= 14 }
					mult_modifier = { factor = 1.5 learning >= 16 }
					mult_modifier = { factor = 1.5 learning >= 18 }
					mult_modifier = { factor = 1.5 learning >= 20 }

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 8 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 10 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 12 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 14 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 16 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 18 }
					}

					mult_modifier = {
						factor = 1.5
						job_spiritual = { learning >= 20 }
					}

					character_event = { id = HF.23752 } # Excellent Response
				}

				60 = {
					character_event = { id = HF.23753 } # Good Response
				}

				20 = {
					character_event = { id = HF.23754 } # Bad Response
				}

				5 = {
					mult_modifier = { factor = 2 piety < -50 }
					mult_modifier = { factor = 2 piety < -100 }
					mult_modifier = { factor = 2 piety < -200 }
					mult_modifier = { factor = 2 piety < -400 }
					mult_modifier = { factor = 2 piety < -600 }

					mult_modifier = {
						factor = 2
						is_devil_worshiper_trigger = yes
					}

					mult_modifier = {
						factor = 2
						has_character_modifier = adulteress
					}

					mult_modifier = {
						factor = 2
						has_character_modifier = incestuous_adulteress
					}

					mult_modifier = {
						factor = 2
						has_character_modifier = adulterer
					}

					mult_modifier = {
						factor = 2
						has_character_modifier = incestuous_adulterer
					}

					mult_modifier = {
						factor = 2
						spouse = { has_character_modifier = adulterer }
					}

					mult_modifier = {
						factor = 2
						spouse = { has_character_modifier = incestuous_adulterer }
					}

					mult_modifier = {
						factor = 2
						spouse = { has_character_modifier = adulteress }
					}

					mult_modifier = {
						factor = 2
						spouse = { has_character_modifier = incestuous_adulteress }
					}

					mult_modifier = {
						factor = 2
						event_target:child_heir = { trait = bastard }
					}

					mult_modifier = {
						factor = 2
						event_target:child_heir = { trait = legit_bastard }
					}

					mult_modifier = {
						factor = 2
						event_target:child_heir = { trait = child_of_consort }
					}

					mult_modifier = {
						factor = 2
						event_target:child_heir = { trait = child_of_consort_male }
					}

					character_event = { id = HF.23755 } # Catastrophic Response
				}
			}
		}
	}

	option = {
		name = EVTOPTBHF23751

		event_target:child_heir = {
			show_scope_change = no

			add_character_modifier = {
				name = child_protected
				years = 16
			}
		}

		trigger_switch = {
			on_trigger = real_tier

			COUNT = { scaled_wealth = { value = -1 min = -50 max = -200 } }
			DUKE = { scaled_wealth = { value = -1 min = -100 max = -400 } }
			KING = { scaled_wealth = { value = -1 min = -175 max = -500 } }
			EMPEROR = { scaled_wealth = { value = -1 min = -300 max = -600 } }
		}
	}

	option = {
		name = EVTOPTCHF23751

		event_target:child_heir = {
			show_scope_change = no

			add_character_modifier = {
				name = child_heavily_guarded
				years = 16
			}
		}

		trigger_switch = {
			on_trigger = real_tier

			COUNT = { scaled_wealth = { value = -1 min = -50 max = -100 } }
			DUKE = { scaled_wealth = { value = -1 min = -100 max = -300 } }
			KING = { scaled_wealth = { value = -1 min = -175 max = -400 } }
			EMPEROR = { scaled_wealth = { value = -1 min = -300 max = -500 } }
		}
	}

	option = {
		name = EVTOPTDHF23751

		tiered_piety_negative_effect = yes
	}
}

## Astronomy+Stability outcomes
# Very Positive
character_event = {
	id = HF.23752
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	portrait = event_target:child_heir

	desc = {
		text = EVTDESCAHF23752
		trigger = { event_target:child_heir = { is_ill = yes } }
	}
	desc = {
		text = EVTDESCBHF23752
		trigger = { event_target:child_heir = { is_ill = no } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23752

		event_target:child_heir = {
			show_scope_change = no

			health = 1.0

			random_list = {
				20 = { change_diplomacy = 2 }
				20 = { change_martial = 2 }
				20 = { change_stewardship = 2 }
				20 = { change_intrigue = 2 }
				20 = { change_learning = 2 }
			}
		}

		any_vassal = {
			show_scope_change = no

			limit = { higher_real_tier_than = BARON }

			opinion = {
				name = opinion_favored_child
				who = event_target:child_heir
				years = 20
			}
		}
	}
}

# Positive
character_event = {
	id = HF.23753
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	portrait = event_target:child_heir

	desc = {
		text = EVTDESCAHF23753
		trigger = { event_target:child_heir = { is_ill = yes } }
	}
	desc = {
		text = EVTDESCBHF23753
		trigger = { event_target:child_heir = { is_ill = no } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23753

		event_target:child_heir = {
			show_scope_change = no

			health = 2.0
		}
	}
}

# Negative
character_event = {
	id = HF.23754
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	portrait = event_target:child_heir

	desc = {
		text = EVTDESCAHF23754
		trigger = { event_target:child_heir = { is_ill = yes } }
	}
	desc = {
		text = EVTDESCBHF23754
		trigger = { event_target:child_heir = { is_ill = no } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23754

		event_target:child_heir = {
			show_scope_change = no

			health = -1.0
		}
	}
}

# Very Negative
character_event = {
	id = HF.23755
	picture = GFX_evt_comet
	border = GFX_event_normal_frame_religion
	portrait = event_target:child_heir

	desc = {
		text = EVTDESCAHF23755
		trigger = { event_target:child_heir = { is_ill = yes } }
	}
	desc = {
		text = EVTDESCBHF23755
		trigger = { event_target:child_heir = { is_ill = no } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23755

		event_target:child_heir = {
			show_scope_change = no

			health = -0.5
		}

		any_vassal = {
			show_scope_change = no

			limit = { higher_real_tier_than = BARON }

			opinion = {
				name = opinion_unfavored_child
				who = event_target:child_heir
				years = 20
			}
		}
	}
}

####################################

## Stability - Attribute Improvement decision (Meliorism)
# First event, pick attribute
character_event = {
	id = HF.23760
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23760
		trigger = { character = event_target:scoped_improvement_target } # Doing self-improvement
	}
	desc = {
		text = EVTDESCBHF23760
		trigger = { is_close_relative = event_target:scoped_improvement_target } # Helping someone else
	}
	desc = {
		text = EVTDESCCHF23760
		trigger = {
			NOR = {
				character = event_target:scoped_improvement_target # Helping someone else
				is_close_relative = event_target:scoped_improvement_target
			}
		}
	}

	picture = {
		picture = GFX_evt_matriarchy_throne_room
		trigger = {
			OR = {
				has_religion_feature = religion_matriarchal

				AND = {
					character = event_target:scoped_improvement_target
					is_female = yes
					has_law = status_of_women_4
				}
			}
		}
	}
	picture = {
		picture = GFX_evt_tengri_throneroom_oldgods
		trigger = { has_religion_feature = religion_patriarchal }
	}
	picture = {
		picture = GFX_evt_prospering_province
		trigger = {
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal

				AND = {
					character = event_target:scoped_improvement_target
					is_female = yes
					has_law = status_of_women_4
				}
			}
		}
	}

	is_triggered_only = yes # stable_attribute_improvement_decision, HF_religious_decisions.txt

	immediate = {
		save_event_target_as = scoped_improvement_ruler

		FROM = {
			save_event_target_as = scoped_improvement_target
			clr_character_flag = flag_training_diplomacy_attribute
			clr_character_flag = flag_training_martial_attribute
			clr_character_flag = flag_training_combat_rating
			clr_character_flag = flag_training_stewardship_attribute
			clr_character_flag = flag_training_intrigue_attribute
			clr_character_flag = flag_training_learning_attribute
		}
	}

	# Statemanship (Diplomacy/Stewardship)
	# War (Martial/Combat Rating)
	# Knowledge (Intrigue/Learning)
	# Cancel

	option = {
		name = EVTOPTAHF23760

		trigger = {
			OR = {
				character = event_target:scoped_improvement_target
				diplomacy > event_target:scoped_improvement_target
				stewardship > event_target:scoped_improvement_target
			}
		}

		if = {
			limit = { character = event_target:scoped_improvement_target }

			random_list = {
				50 = {
					change_diplomacy = 1
					set_character_flag = flag_training_diplomacy_attribute

					if = {
						limit = {
							has_education_diplomacy_trigger = yes

							OR = {
								has_religion_feature = religion_meritocratic
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_patriarchal
							}
						}

						custom_tooltip = { text = tooltip_synergic_education_ugrade }
					}
				}

				50 = {
					change_stewardship = 1
					set_character_flag = flag_training_stewardship_attribute

					if = {
						limit = {
							has_education_stewardship_trigger = yes

							OR = {
								has_religion_feature = religion_meritocratic
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_patriarchal
							}
						}

						custom_tooltip = { text = tooltip_synergic_education_ugrade }
					}
				}
			}
		}
		else = {
			event_target:scoped_improvement_target = {
				show_scope_change = no

				random_list = {
					50 = {
						trigger = { diplomacy < event_target:scoped_improvement_ruler }

						change_diplomacy = 1
						set_character_flag = flag_training_diplomacy_attribute

						if = {
							limit = {
								has_education_diplomacy_trigger = yes

								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}

							custom_tooltip = { text = tooltip_synergic_education_ugrade }
						}
					}

					50 = {
						trigger = { stewardship < event_target:scoped_improvement_ruler }

						change_stewardship = 1
						set_character_flag = flag_training_stewardship_attribute

						if = {
							limit = {
								has_education_stewardship_trigger = yes

								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}

							custom_tooltip = { text = tooltip_synergic_education_ugrade }
						}
					}
				}
			}
		}

		hidden_effect = {
			event_target:scoped_improvement_target = {
				change_variable = {
					which = burnout_count
					value = 1
				}

				stable_attribute_improvement_effect = yes
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				has_education_diplomacy_trigger = yes
			}

			mult_modifier = {
				factor = 1.5
				has_education_stewardship_trigger = yes
			}
		}
	}

	option = {
		name = EVTOPTBHF23760

		trigger = {
			OR = {
				character = event_target:scoped_improvement_target
				martial > event_target:scoped_improvement_target
				combat_rating > event_target:scoped_improvement_target
			}
		}

		if = {
			limit = { character = event_target:scoped_improvement_target }

			random_list = {
				50 = {
					change_martial = 1
					set_character_flag = flag_training_martial_attribute
				}

				50 = {
					add_one_duel_experience_modifier = yes
					set_character_flag = flag_training_combat_rating
				}
			}
		}
		else = {
			event_target:scoped_improvement_target = {
				random_list = {
					50 = {
						trigger = { martial < event_target:scoped_improvement_ruler }

						change_martial = 1
						set_character_flag = flag_training_martial_attribute
					}

					50 = {
						trigger = { combat_rating < event_target:scoped_improvement_ruler }

						add_one_duel_experience_modifier = yes
						set_character_flag = flag_training_combat_rating
					}
				}
			}
		}

		if = {
			limit = {
				event_target:scoped_improvement_target = {
					has_education_martial_trigger = yes
				}

				event_target:scoped_improvement_ruler = {
					OR = {
						has_religion_feature = religion_meritocratic
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_patriarchal
					}
				}
			}

			custom_tooltip = { text = tooltip_synergic_education_ugrade }
		}

		hidden_effect = {
			event_target:scoped_improvement_target = {
				change_variable = {
					which = burnout_count
					value = 1
				}

				stable_attribute_improvement_effect = yes
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				has_education_martial_trigger = yes
			}
		}
	}

	option = {
		name = EVTOPTCHF23760

		trigger = {
			OR = {
				character = event_target:scoped_improvement_target
				intrigue > event_target:scoped_improvement_target
				learning > event_target:scoped_improvement_target
			}
		}

		if = {
			limit = { character = event_target:scoped_improvement_target }

			random_list = {
				50 = {
					change_intrigue = 1
					set_character_flag = flag_training_intrigue_attribute

					if = {
						limit = {
							has_education_intrigue_trigger = yes

							OR = {
								has_religion_feature = religion_meritocratic
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_patriarchal
							}
						}

						custom_tooltip = { text = tooltip_synergic_education_ugrade }
					}
				}

				50 = {
					change_learning = 1
					set_character_flag = flag_training_learning_attribute

					if = {
						limit = {
							has_education_learning_trigger = yes

							OR = {
								has_religion_feature = religion_meritocratic
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_patriarchal
							}
						}

						custom_tooltip = { text = tooltip_synergic_education_ugrade }
					}
				}
			}
		}
		else = {
			event_target:scoped_improvement_target = {
				show_scope_change = no

				random_list = {
					50 = {
						trigger = { intrigue < event_target:scoped_improvement_ruler }

						change_intrigue = 1
						set_character_flag = flag_training_intrigue_attribute

						if = {
							limit = {
								has_education_intrigue_trigger = yes

								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}

							custom_tooltip = { text = tooltip_synergic_education_ugrade }
						}
					}

					50 = {
						trigger = { learning < event_target:scoped_improvement_ruler }

						change_learning = 1
						set_character_flag = flag_training_learning_attribute

						if = {
							limit = {
								has_education_learning_trigger = yes

								event_target:scoped_improvement_ruler = {
									OR = {
										has_religion_feature = religion_meritocratic
										has_religion_feature = religion_matriarchal
										has_religion_feature = religion_patriarchal
									}
								}
							}

							custom_tooltip = { text = tooltip_synergic_education_ugrade }
						}
					}
				}
			}
		}

		hidden_effect = {
			event_target:scoped_improvement_target = {
				change_variable = {
					which = burnout_count
					value = 1
				}

				stable_attribute_improvement_effect = yes
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				has_education_intrigue_trigger = yes
			}

			mult_modifier = {
				factor = 1.5
				has_education_learning_trigger = yes
			}
		}
	}

	option = {
		name = EVTOPTDHF23760

		hidden_effect = {
			piety = 150 # Refund

			if = {
				limit = { character = FROM } # Used on yourself
				prestige = 500
			}

			remove_character_modifier = stable_attribute_improvement_cooldown

			event_target:scoped_improvement_target = {
				remove_character_modifier = stable_attribute_improvement_target_cooldown
			}
		}
	}
}

# Thanks to synergy and good work, target has improved his education
character_event = {
	id = HF.23761
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_improvement_ruler

	desc = {
		text = EVTDESCAHF23761
		trigger = {
			has_character_flag = flag_training_diplomacy_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCBHF23761
		trigger = {
			has_character_flag = flag_training_martial_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCCHF23761
		trigger = {
			has_character_flag = flag_training_combat_rating
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCDHF23761
		trigger = {
			has_character_flag = flag_training_stewardship_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCEHF23761
		trigger = {
			has_character_flag = flag_training_intrigue_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCFHF23761
		trigger = {
			has_character_flag = flag_training_learning_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCGHF23761
		trigger = {
			has_character_flag = flag_training_diplomacy_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCHHF23761
		trigger = {
			has_character_flag = flag_training_martial_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCIHF23761
		trigger = {
			has_character_flag = flag_training_combat_rating
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCLHF23761
		trigger = {
			has_character_flag = flag_training_stewardship_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCMHF23761
		trigger = {
			has_character_flag = flag_training_intrigue_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCNHF23761
		trigger = {
			has_character_flag = flag_training_learning_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}

	picture = {
		picture = GFX_evt_matriarchy_throne_room
		trigger = {
			OR = {
				has_religion_feature = religion_matriarchal

				AND = {
					character = event_target:scoped_improvement_ruler
					is_female = yes
					has_law = status_of_women_4
				}
			}
		}
	}
	picture = {
		picture = GFX_evt_tengri_throneroom_oldgods
		trigger = { has_religion_feature = religion_patriarchal }
	}
	picture = {
		picture = GFX_evt_prospering_province
		trigger = {
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal

				AND = {
					character = event_target:scoped_improvement_ruler
					is_female = yes
					has_law = status_of_women_4
				}
			}
		}
	}

	is_triggered_only = yes # stable_attribute_improvement_effect

	option = {
		name = EVTOPTAHF23761

		if = {
			limit = { character = event_target:scoped_improvement_target }

			opinion = {
				who = event_target:scoped_improvement_ruler
				name = opinion_mentor
				years = 5
			}
		}

		if = {
			limit = { has_character_flag = flag_training_diplomacy_attribute }

			trigger_switch = {
				on_trigger = trait

				### Diplomacy ###
				naive_appeaser = {
					remove_trait = naive_appeaser
					add_trait = underhanded_rogue
				}

				underhanded_rogue = {
					remove_trait = underhanded_rogue
					add_trait = charismatic_negotiator
				}

				charismatic_negotiator = {
					remove_trait = charismatic_negotiator
					add_trait = grey_eminence
				}
			}

			clr_character_flag = flag_training_diplomacy_attribute
		}
		else_if = {
			limit = {
				OR = {
					has_character_flag = flag_training_martial_attribute
					has_character_flag = flag_training_combat_rating
				}
			}

			trigger_switch = {
				on_trigger = trait

				### Martial ###
				misguided_warrior = {
					remove_trait = misguided_warrior
					add_trait = tough_soldier
				}

				tough_soldier = {
					remove_trait = tough_soldier
					add_trait = skilled_tactician
				}

				skilled_tactician = {
					remove_trait = skilled_tactician
					add_trait = brilliant_strategist
				}
			}

			clr_character_flag = flag_training_martial_attribute
			clr_character_flag = flag_training_combat_rating
		}
		else_if = {
			limit = { has_character_flag = flag_training_stewardship_attribute }

			trigger_switch = {
				on_trigger = trait

				### Stewardship ###
				indulgent_wastrel = {
					remove_trait = indulgent_wastrel
					add_trait = thrifty_clerk
				}

				thrifty_clerk = {
					remove_trait = thrifty_clerk
					add_trait = fortune_builder
				}

				fortune_builder = {
					remove_trait = fortune_builder
					add_trait = midas_touched
				}
			}

			clr_character_flag = flag_training_stewardship_attribute
		}
		else_if = {
			limit = { has_character_flag = flag_training_intrigue_attribute }

			trigger_switch = {
				on_trigger = trait

				### Intrigue ###
				amateurish_plotter = {
					remove_trait = amateurish_plotter
					add_trait = flamboyant_schemer
				}

				flamboyant_schemer = {
					remove_trait = flamboyant_schemer
					add_trait = intricate_webweaver
				}

				intricate_webweaver = {
					remove_trait = intricate_webweaver
					add_trait = elusive_shadow
				}
			}

			clr_character_flag = flag_training_intrigue_attribute
		}
		else_if = {
			limit = { has_character_flag = flag_training_learning_attribute }

			trigger_switch = {
				on_trigger = trait

				### Learning ###
				detached_priest = {
					remove_trait = detached_priest
					add_trait = dutiful_cleric
				}

				dutiful_cleric = {
					remove_trait = dutiful_cleric
					add_trait = scholarly_theologian
				}

				scholarly_theologian = {
					remove_trait = scholarly_theologian
					add_trait = mastermind_theologian
				}
			}

			clr_character_flag = flag_training_learning_attribute
		}
	}
}

# Too much pressure resulted in burnout
character_event = {
	id = HF.23762
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_improvement_ruler

	desc = {
		text = EVTDESCAHF23762
		trigger = {
			has_character_flag = flag_training_diplomacy_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCBHF23762
		trigger = {
			has_character_flag = flag_training_martial_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCCHF23762
		trigger = {
			has_character_flag = flag_training_combat_rating
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCDHF23762
		trigger = {
			has_character_flag = flag_training_stewardship_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCEHF23762
		trigger = {
			has_character_flag = flag_training_intrigue_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCFHF23762
		trigger = {
			has_character_flag = flag_training_learning_attribute
			character = event_target:scoped_improvement_ruler # Doing self-improvement
		}
	}
	desc = {
		text = EVTDESCGHF23762
		trigger = {
			has_character_flag = flag_training_diplomacy_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCHHF23762
		trigger = {
			has_character_flag = flag_training_martial_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCIHF23762
		trigger = {
			has_character_flag = flag_training_combat_rating
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCLHF23762
		trigger = {
			has_character_flag = flag_training_stewardship_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCMHF23762
		trigger = {
			has_character_flag = flag_training_intrigue_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}
	desc = {
		text = EVTDESCNHF23762
		trigger = {
			has_character_flag = flag_training_learning_attribute
			NOT = { character = event_target:scoped_improvement_ruler } # Helping someone else
		}
	}

	picture = {
		picture = GFX_evt_bad_news_female
		trigger = { is_female = yes }
	}
	picture = {
		picture = GFX_evt_bad_news
		trigger = { is_female = no }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23762

		trigger = {
			NOT = { trait = stressed }
		}

		add_trait = stressed
		health = -0.25

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.5
				trait = slothful
			}

			mult_modifier = {
				factor = 1.5
				trait = diligent
			}
		}
	}

	option = { # Sacrifice personal grooming
		name = EVTOPTBHF23762

		trigger = {
			NOT = { trait = uncouth }
		}

		if = {
			limit = {
				NOR = {
					trait = groomed
					character = event_target:scoped_improvement_ruler
				}

				event_target:scoped_improvement_ruler = {
					trait = uncouth # Kindred coping
				}
			}

			opinion = {
				name = opinion_kindred_spirit
				who = event_target:scoped_improvement_ruler
				years = 5
			}

			event_target:scoped_improvement_ruler  = {
				show_scope_change = no

				opinion = {
					name = opinion_kindred_spirit
					who = ROOT
					years = 5
				}

				character_event = { id = HF.23763 }
			}
		}
		else_if = { # If self-improving, look for kindred vassal
			limit = {
				character = event_target:scoped_improvement_ruler
				NOT = { trait = groomed }

				any_courtier_or_vassal = {
					trait = uncouth
					is_adult = yes
					is_incapable = no
					prisoner = no

					NOR = {
						is_rival = ROOT
						trait = proud
					}

					opinion = {
						who = ROOT
						value >= 0
					}
				}
			}

			hidden_effect = {
				random_courtier_or_vassal = {
					limit = {
						trait = uncouth
						is_adult = yes
						is_incapable = no
						prisoner = no

						NOR = {
							is_rival = ROOT
							trait = proud
						}

						opinion = {
							who = ROOT
							value >= 0
						}
					}

					preferred_limit = { is_married = ROOT }
					preferred_limit = { is_lover = ROOT }
					preferred_limit = { is_friend = ROOT }

					save_event_target_as = scoped_kindred
				}

				character_event = { id = HF.23764 }
			}
		}

		if = {
			limit = { trait = groomed }
			remove_trait = groomed
		}
		else = {
			add_trait = uncouth
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.5
				trait = proud
			}
		}
	}

	option = { # Eat more
		name = EVTOPTCHF23762

		trigger = {
			NOR = {
				trait = fat
				trait = malnourished
			}
		}

		show_trait = fat
		gain_weight_medium_effect = yes
		set_character_flag = flag_primed_physique # No random flavor needed
		weight_trait_check_effect = yes

		if = {
			limit = {
				OR = {
					check_variable = {
						which = physique_variable
						value < -5
					}

					trait = frail
				}
			}

			health = 0.5
		}
		else_if = {
			limit = {
				check_variable = {
					which = physique_variable
					value >= 15 # Nearing threshold
				}

				event_target:scoped_improvement_ruler = {
					trait = fat # Kindred coping
				}
			}

			opinion = {
				who = event_target:scoped_improvement_ruler
				name = opinion_kindred_spirit
				years = 5
			}

			event_target:scoped_improvement_ruler = {
				show_scope_change = no

				opinion = {
					who = ROOT
					name = opinion_kindred_spirit
					years = 5
				}

				character_event = { id = HF.23765 }
			}

			hidden_effect = { # Random flavor
				set_character_flag = flag_fat_for_stress
				apply_weight_modifier_effect = yes
				clear_fat_flags_effect = yes
			}
		}
		else_if = { # If self-improving, look for kindred vassal
			limit = {
				character = event_target:scoped_improvement_ruler

				check_variable = {
					which = physique_variable
					value >= 15 # Nearing threshold
				}

				any_courtier_or_vassal = {
					trait = fat
					is_adult = yes
					is_incapable = no
					prisoner = no

					NOR = {
						is_rival = ROOT
						trait = temperate
					}

					opinion = {
						who = ROOT
						value >= 0
					}
				}
			}

			hidden_effect = {
				random_courtier_or_vassal = {
					limit = {
						trait = fat
						is_adult = yes
						is_incapable = no
						prisoner = no

						NOR = {
							is_rival = ROOT
							trait = temperate
						}

						opinion = {
							who = ROOT
							value >= 0
						}
					}

					preferred_limit = { is_married = ROOT }
					preferred_limit = { is_lover = ROOT }
					preferred_limit = { is_friend = ROOT }

					save_event_target_as = scoped_kindred
				}

				character_event = { id = HF.23766 }
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.5
				trait = temperate
			}
		}
	}

	option = { # Eat less
		name = EVTOPTDHF23762

		trigger = {
			NOR = {
				trait = fat
				trait = malnourished
			}
		}

		show_trait = malnourished
		lose_weight_medium_effect = yes
		set_character_flag = flag_primed_physique # No random flavor needed
		weight_trait_check_effect = yes

		if = {
			limit = {
				OR = {
					check_variable = {
						which = physique_variable
						value >= 5
					}

					trait = sturdy
				}
			}

			health = 0.5
		}
		else_if = {
			limit = {
				check_variable = {
					which = physique_variable
					value < -15 # Nearing threshold
				}

				event_target:scoped_improvement_ruler = {
					trait = malnourished # Kindred coping
				}
			}

			opinion = {
				who = event_target:scoped_improvement_ruler
				name = opinion_kindred_spirit
				years = 5
			}

			event_target:scoped_improvement_ruler = {
				show_scope_change = no

				opinion = {
					name = opinion_kindred_spirit
					who = ROOT
					years = 5
				}

				character_event = { id = HF.23767 }
			}

			hidden_effect = { # Random flavor
				set_character_flag = flag_malnourished_for_diligence
				apply_weight_modifier_effect = yes
				clear_malnourished_flags_effect = yes
			}
		}
		else_if = { # If self-improving, look for kindred vassal
			limit = {
				character = event_target:scoped_improvement_ruler

				any_courtier_or_vassal = {
					trait = malnourished
					is_adult = yes
					is_incapable = no
					prisoner = no

					NOR = {
						is_rival = ROOT
						trait = gluttonous
					}

					opinion = {
						who = ROOT
						value >= 0
					}
				}

				check_variable = {
					which = physique_variable
					value < -15 # Nearing threshold
				}
			}

			hidden_effect = {
				random_courtier_or_vassal = {
					limit = {
						trait = malnourished
						is_adult = yes
						is_incapable = no
						prisoner = no

						NOR = {
							is_rival = ROOT
							trait = gluttonous
						}

						opinion = {
							who = ROOT
							value >= 0
						}
					}

					preferred_limit = { is_married = ROOT }
					preferred_limit = { is_lover = ROOT }
					preferred_limit = { is_friend = ROOT }

					save_event_target_as = scoped_kindred
				}

				character_event = { id = HF.23768 }
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 0.5
				trait = gluttonous
			}
		}
	}

	option = { # Total burnout
		name = EVTOPTFHF23762

		trigger = {
			OR = {
				trait = stressed
				trait = uncouth
				trait = fat
				trait = malnourished
			}
		}

		if = {
			limit = { NOT = { character = event_target:scoped_improvement_ruler } }

			hidden_effect = {
				event_target:scoped_improvement_ruler = {
					character_event = { id = HF.23769 } # Notify
				}
			}
		}

		trigger_switch = {
			on_trigger = trait

			### Intrigue ###
			amateurish_plotter = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOT = { trait = dull } }
					add_trait = dull
				}
				else_if = {
					limit = { NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}

			flamboyant_schemer = {
				remove_trait = flamboyant_schemer
				add_trait = amateurish_plotter
			}

			intricate_webweaver = {
				remove_trait = intricate_webweaver
				add_trait = flamboyant_schemer
			}

			elusive_shadow = {
				remove_trait = elusive_shadow
				add_trait = intricate_webweaver
			}

			### Diplomacy ###
			naive_appeaser = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOT = { trait = dull } }
					add_trait = dull
				}
				else_if = {
					limit = { NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}

			underhanded_rogue = {
				remove_trait = underhanded_rogue
				add_trait = naive_appeaser
			}

			charismatic_negotiator = {
				remove_trait = charismatic_negotiator
				add_trait = underhanded_rogue
			}

			grey_eminence = {
				remove_trait = grey_eminence
				add_trait = charismatic_negotiator
			}

			### Stewardship ###
			indulgent_wastrel = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOT = { trait = dull } }
					add_trait = dull
				}
				else_if = {
					limit = { NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}

			thrifty_clerk = {
				remove_trait = thrifty_clerk
				add_trait = indulgent_wastrel
			}

			fortune_builder = {
				remove_trait = fortune_builder
				add_trait = thrifty_clerk
			}

			midas_touched = {
				remove_trait = midas_touched
				add_trait = fortune_builder
			}

			### Martial ###
			misguided_warrior = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOT = { trait = dull } }
					add_trait = dull
				}
				else_if = {
					limit = { NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}

			tough_soldier = {
				remove_trait = tough_soldier
				add_trait = misguided_warrior
			}

			skilled_tactician = {
				remove_trait = skilled_tactician
				add_trait = tough_soldier
			}

			brilliant_strategist = {
				remove_trait = brilliant_strategist
				add_trait = skilled_tactician
			}

			### Learning ###
			detached_priest = {
				if = {
					limit = { trait = shrewd }
					remove_trait = shrewd
				}
				else_if = {
					limit = { NOT = { trait = dull } }
					add_trait = dull
				}
				else_if = {
					limit = { NOT = { trait = depressed } }
					add_trait = depressed
				}
				else = {
					health = -0.75
				}
			}

			dutiful_cleric = {
				remove_trait = dutiful_cleric
				add_trait = detached_priest
			}

			scholarly_theologian = {
				remove_trait = scholarly_theologian
				add_trait = dutiful_cleric
			}

			mastermind_theologian = {
				remove_trait = mastermind_theologian
				add_trait = scholarly_theologian
			}
		}
	}

	after = {
		clr_character_flag = flag_training_diplomacy_attribute
		clr_character_flag = flag_training_martial_attribute
		clr_character_flag = flag_training_combat_rating
		clr_character_flag = flag_training_stewardship_attribute
		clr_character_flag = flag_training_intrigue_attribute
		clr_character_flag = flag_training_learning_attribute
	}
}

# Ruler: Target become as uncouth as you
character_event = {
	id = HF.23763
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23763
		trigger = { FROM = { is_female = no } }
	}
	desc = {
		text = EVTDESCBHF23763
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23763
		tooltip_info = uncouth

		tooltip = {
			opinion = {
				name = opinion_kindred_spirit
				who = event_target:scoped_improvement_target
				years = 5
			}

			reverse_opinion = {
				name = opinion_kindred_spirit
				who = event_target:scoped_improvement_target
				years = 5
			}
		}
	}
}

# Target: Random courtier approves of uncouthness
character_event = {
	id = HF.23764
	picture = GFX_evt_drunk
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	desc = {
		text = EVTDESCAHF23764
		trigger = { is_female = no }
	}
	desc = {
		text = EVTDESCBHF23764
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23764
		tooltip_info = uncouth

		opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}

		reverse_opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}
	}
}

# Ruler: Target become as fat as you
character_event = {
	id = HF.23765
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23765
		trigger = { FROM = { is_female = no } }
	}
	desc = {
		text = EVTDESCBHF23765
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23765
		tooltip_info = fat

		tooltip = {
			opinion = {
				name = opinion_kindred_spirit
				who = FROM
				years = 5
			}

			reverse_opinion = {
				name = opinion_kindred_spirit
				who = FROM
				years = 5
			}
		}
	}
}

# Target: Random courtier approves of weight
character_event = {
	id = HF.23766
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	desc = {
		text = EVTDESCAHF23766
		trigger = { is_female = no }
	}
	desc = {
		text = EVTDESCBHF23766
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	option = {
		name = {
			text = EVTOPTAHF23766_A
			trigger = { is_female = no }
		}
		name = {
			text = EVTOPTAHF23766_B
			trigger = { is_female = yes }
		}
		tooltip_info = fat

		opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}

		reverse_opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}

		hidden_effect = {
			# Random flavor
			set_character_flag = flag_fat_for_stress
			apply_weight_modifier_effect = yes
			clear_fat_flags_effect = yes
		}
	}
}

# Ruler: Target become as thin as you
character_event = {
	id = HF.23767
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23767
		trigger = { FROM = { is_female = no } }
	}
	desc = {
		text = EVTDESCBHF23767
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	ai = no

	option = {
		name = EVTOPTAHF23767
		tooltip_info = malnourished

		tooltip = {
			opinion = {
				name = opinion_kindred_spirit
				who = FROM
				years = 5
			}

			reverse_opinion = {
				name = opinion_kindred_spirit
				who = FROM
				years = 5
			}
		}
	}
}

# Target: Random courtier approves of weight
character_event = {
	id = HF.23768
	picture = GFX_evt_fancy_feast
	border = GFX_event_normal_frame_religion
	portrait = event_target:scoped_kindred

	desc = {
		text = EVTDESCAHF23768
		trigger = { is_female = no }
	}
	desc = {
		text = EVTDESCBHF23768
		trigger = { is_female = yes }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23768
		tooltip_info = malnourished

		opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}

		reverse_opinion = {
			name = opinion_kindred_spirit
			who = event_target:scoped_kindred
			years = 5
		}

		hidden_effect = {
			# Random flavor
			set_character_flag = flag_malnourished_for_diligence
			apply_weight_modifier_effect = yes
			clear_malnourished_flags_effect = yes
		}
	}
}

# Ruler: Target experienced burnout
character_event = {
	id = HF.23769
	desc = EVTDESCAHF23769
	border = GFX_event_normal_frame_religion

	picture = {
		picture = GFX_evt_bad_news
		trigger = { FROM = { is_female = no } }
	}
	picture = {
		picture = GFX_evt_bad_news_female
		trigger = { FROM = { is_female = yes } }
	}

	is_triggered_only = yes

	option = {
		name = EVTOPTAHF23769

		tiered_piety_negative_effect = yes
	}
}

# Family Bloodline gained from improving close relatives
narrative_event = {
	id = HF.23770
	title = EVTTITLEHF24059
	picture = GFX_evt_family
	border = GFX_event_narrative_frame_diplomacy
	sound = bloodline_added

	desc = {
		text = EVTDESCAHF24061
		trigger = { num_of_dynasty_members >= 10 }
	}
	desc = {
		text = EVTDESCBHF24061
		trigger = { num_of_dynasty_members < 10 }
	}

	is_triggered_only = yes # stable_attribute_improvement_decision, HF_religious_decisions.txt

	has_dlc = "Holy Fury"

	trigger = {
		NOT = {
			any_owned_bloodline = {
				has_bloodline_flag = created_bloodline
				bloodline_is_active_for = PREV
			}
		}
	}

	option = {
		name = EVTOPTAHF24061

		if = {
			limit = { is_female = no }

			if = {
				limit = {
					this_has_cool_nickname_trigger = no
					this_has_super_cool_nickname_trigger = no
				}

				give_nickname = nick_the_grand_patriarch
			}

			create_bloodline = { type = event_family_bloodline_01 }
		}

		else = {
			if = {
				limit = {
					this_has_cool_nickname_trigger = no
					this_has_super_cool_nickname_trigger = no
					is_female = yes
				}

				give_nickname = nick_the_grand_matriarch
			}

			create_bloodline = {
				type = event_family_bloodline_01
				inheritance = matrilineal
			}
		}
	}
}

# Benevolent Bloodline gained
narrative_event = {
	id = HF.23771
	title = EVTTITLEHF24056
	desc = EVTDESCHF24058
	border = GFX_event_narrative_frame_diplomacy
	sound = bloodline_added

	picture = {
		picture = GFX_evt_matriarchy_throne_room
		trigger = { has_religion_feature = religion_matriarchal }
	}
	picture = {
		picture = GFX_evt_tengri_throneroom_oldgods
		trigger = { has_religion_feature = religion_patriarchal }
	}
	picture = {
		picture = GFX_evt_throne_room
		trigger = {
			NOR = {
				has_religion_feature = religion_patriarchal
				has_religion_feature = religion_matriarchal
			}
		}
	}

	is_triggered_only = yes # stable_attribute_improvement_decision, HF_religious_decisions.txt

	has_dlc = "Holy Fury"

	trigger = {
		NOT = {
			any_owned_bloodline = {
				has_bloodline_flag = created_bloodline
				bloodline_is_active_for = PREV
			}
		}
	}

	option = {
		name = EVTOPTAHF24058

		if = {
			limit = {
				this_has_cool_nickname_trigger = no
				this_has_super_cool_nickname_trigger = no
			}

			give_nickname = nick_the_benevolent
		}

		if = {
			limit = { is_female = no }

			create_bloodline = {
				type = event_benevolent_bloodline_01
			}
		}
		else = {
			create_bloodline = {
				type = event_benevolent_bloodline_01
				inheritance = matrilineal
			}
		}
	}
}

# Safety flag cleanup event
character_event = {
	id = HF.23772

	is_triggered_only = yes # stable_attribute_improvement_decision, HF_religious_decisions.txt
	hide_window = yes

	immediate = {
		clr_character_flag = flag_training_diplomacy_attribute
		clr_character_flag = flag_training_martial_attribute
		clr_character_flag = flag_training_combat_rating
		clr_character_flag = flag_training_stewardship_attribute
		clr_character_flag = flag_training_intrigue_attribute
		clr_character_flag = flag_training_learning_attribute
	}
}

# on_adulthood (delayed): African rite of passage
# First select investment for ceremony
character_event = {
	id = HF.23773
	desc = EVTDESCAHF23773
	border = GFX_event_normal_frame_religion

	picture = {
		trigger = { religion_openly_west_african_or_reformed_trigger = yes }
		picture = GFX_evt_west_african_ruler
	}
	picture = {
		trigger = {
			OR = {
				has_religion_feature = religion_animistic
				has_religion_feature = religion_feature_celtic
			}

			religion_openly_west_african_or_reformed_trigger = no
		}
		picture = GFX_evt_magic_ritual
	}

	is_triggered_only = yes

	has_dlc = "Holy Fury"
	only_capable = yes

	trigger = {
		OR = {
			religion_openly_west_african_or_reformed_trigger = yes
			has_religion_feature = religion_animistic
			has_religion_feature = religion_feature_celtic
		}

		is_lowborn = no
	}

	option = {
		name = EVTOPTAHF23773

		custom_tooltip = { text = tooltip_EVTOPTAHF23773 }

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.0
				min = -150
				max = -350
			}
		}

		if = {
			limit = {
				higher_real_tier_than = BARON
				is_landed = yes
				religion = job_spiritual
			}

			reverse_opinion = {
				name = opinion_placated_spirits
				who = job_spiritual
				years = 20
			}
		}

		set_character_flag = flag_african_initiation_high
		character_event = { id = HF.23774 }

		ai_chance = {
			factor = 10

			mult_modifier = {
				factor = 1.5
				trait = zealous
			}

			mult_modifier = {
				factor = 1.5
				trait = proud
			}

		#	mult_modifier = {
		#		factor = 0.25
		#		wealth < 350
		#	}
		#
		#	mult_modifier = {
		#		factor = 0.15
		#		wealth < 100
		#	}
		}
	}

	option = {
		name = EVTOPTBHF23773

		custom_tooltip = { text = tooltip_EVTOPTBHF23773 }

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.0
				min = -50
				max = -100
			}
		}

		set_character_flag = flag_african_initiation_medium
		character_event = { id = HF.23774 }

		ai_chance = {
			factor = 30

		#	mult_modifier = {
		#		factor = 0.5
		#		wealth < 100
		#	}
		#
		#	mult_modifier = {
		#		factor = 0.25
		#		wealth < 50
		#	}
		}
	}

	option = {
		name = EVTOPTCHF23773

		custom_tooltip = { text = tooltip_EVTOPTCHF23773 }

		if = {
			limit = { ai = no }

			scaled_wealth = {
				value = -1.0
				min = -15
				max = -50
			}
		}

		set_character_flag = flag_african_initiation_low
		character_event = { id = HF.23774 }

		ai_chance = {
			factor = 50

		#	mult_modifier = {
		#		factor = 0.75
		#		wealth < 50
		#	}
		#
		#	mult_modifier = {
		#		factor = 0.35
		#		wealth < 0
		#	}
		}
	}

	option = {
		name = EVTOPTDHF23773

		custom_tooltip = { text = tooltip_EVTOPTDHF23773 }

		remove_trait_silently_zealous_effect = yes
		tiered_piety_negative_effect = yes

		ai_chance = {
			factor = 5

			mult_modifier = {
				factor = 0.1
				trait = zealous
			}

			mult_modifier = {
				factor = 2
				trait = cynical
			}

			mult_modifier = {
				factor = 1.25
				trait = greedy
			}
		}
	}
}

# Then select the kind of bonus
character_event = {
	id = HF.23774
	border = GFX_event_normal_frame_religion

	desc = {
		text = EVTDESCAHF23774
		trigger = { has_character_flag = flag_african_initiation_high }
	}
	desc = {
		text = EVTDESCBHF23774
		trigger = { has_character_flag = flag_african_initiation_medium }
	}
	desc = {
		text = EVTDESCCHF23774
		trigger = { has_character_flag = flag_african_initiation_low }
	}

	picture = {
		picture = GFX_evt_west_african_ruler
		trigger = { religion_openly_west_african_or_reformed_trigger = yes }
	}
	picture = {
		picture = GFX_evt_magic_ritual
		trigger = {
			OR = {
				has_religion_feature = religion_animistic
				has_religion_feature = religion_feature_celtic
			}
			religion_openly_west_african_or_reformed_trigger = no
		}
	}

	is_triggered_only = yes

	option = { # Prosperity
		name = EVTOPTAHF23774

		custom_tooltip = {
			text = tooltip_EVTOPTAHF23774

			# Tattoos
			random_list = {
				10 = {
					trigger = { religion_openly_west_african_or_reformed_trigger = no }
					add_trait = slavic_tattoo_6
				}

				25 = { add_trait = african_tattoo_12 }
				25 = { add_trait = african_tattoo_8 }
				50 = { add_trait = african_tattoo_2 }
			}
		}

		trigger_switch = {
			on_trigger = has_character_flag

			flag_african_initiation_high = {
				add_character_modifier = {
					name = african_adulthood_rites_1
					years = 20
				}
			}

			flag_african_initiation_medium = {
				add_character_modifier = {
					name = african_adulthood_rites_1
					years = 10
				}
			}

			flag_african_initiation_low = {
				add_character_modifier = {
					name = african_adulthood_rites_1
					years = 5
				}
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = charitable
			}

			mult_modifier = {
				factor = 1.5
				trait = kind
			}

			mult_modifier = {
				factor = 1.5
				trait = idolizer
			}

			mult_modifier = {
				factor = 1.5
				trait = affectionate
			}
		}
	}

	option = { # Power
		name = EVTOPTBHF23774

		custom_tooltip = {
			text = tooltip_EVTOPTBHF23774

			# Tattoos
			random_list = {
				10 = {
					trigger = { religion_openly_west_african_or_reformed_trigger = no }
					add_trait = norse_tattoo_6
				}

				25 = { add_trait = african_tattoo_10 }
				25 = { add_trait = african_tattoo_7 }
				50 = { add_trait = african_tattoo_1 }
			}
		}

		trigger_switch = {
			on_trigger = has_character_flag

			flag_african_initiation_high = {
				add_character_modifier = {
					name = african_adulthood_rites_2
					years = 20
				}
			}

			flag_african_initiation_medium = {
				add_character_modifier = {
					name = african_adulthood_rites_2
					years = 10
				}
			}

			flag_african_initiation_low = {
				add_character_modifier = {
					name = african_adulthood_rites_2
					years = 5
				}
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = wroth
			}

			mult_modifier = {
				factor = 1.5
				trait = cruel
			}

			mult_modifier = {
				factor = 1.5
				trait = rowdy
			}
			modifier = {
				factor = 1.5
				trait = haughty
			}
		}
	}

	option = { # Shadows
		name = EVTOPTCHF23774

		custom_tooltip = {
			text = tooltip_EVTOPTCHF23774

			# Tattoos
			random_list = {
				10 = {
					trigger = { religion_openly_west_african_or_reformed_trigger = no }
					add_trait = norse_tattoo_3
				}

				25 = { add_trait = african_tattoo_9 }
				25 = { add_trait = african_tattoo_6 }
				50 = { add_trait = african_tattoo_3 }
			}
		}

		trigger_switch = {
			on_trigger = has_character_flag

			flag_african_initiation_high = {
				add_character_modifier = {
					name = african_adulthood_rites_3
					years = 20
				}
			}

			flag_african_initiation_medium = {
				add_character_modifier = {
					name = african_adulthood_rites_3
					years = 10
				}
			}

			flag_african_initiation_low = {
				add_character_modifier = {
					name = african_adulthood_rites_3
					years = 5
				}
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = envious
			}

			mult_modifier = {
				factor = 1.5
				trait = deceitful
			}

			mult_modifier = {
				factor = 1.5
				trait = timid
			}

			mult_modifier = {
				factor = 1.5
				trait = fussy
			}
		}
	}

	option = { # Death
		name = EVTOPTDHF23774

		custom_tooltip = {
			text = tooltip_EVTOPTDHF23774

			# Tattoos
			random_list = {
				10 = {
					trigger = { religion_openly_west_african_or_reformed_trigger = no }
					add_trait = norse_tattoo_4
				}

				25 = { add_trait = african_tattoo_11 }
				25 = { add_trait = african_tattoo_5 }
				50 = { add_trait = african_tattoo_4 }
			}
		}

		trigger_switch = {
			on_trigger = has_character_flag

			flag_african_initiation_high = {
				add_character_modifier = {
					name = african_adulthood_rites_4
					years = 20
				}
			}

			flag_african_initiation_medium = {
				add_character_modifier = {
					name = african_adulthood_rites_4
					years = 10
				}
			}

			flag_african_initiation_low = {
				add_character_modifier = {
					name = african_adulthood_rites_4
					years = 5
				}
			}
		}

		ai_chance = {
			factor = 25

			mult_modifier = {
				factor = 1.5
				trait = frail
			}

			mult_modifier = {
				factor = 1.5
				trait = slothful
			}

			mult_modifier = {
				factor = 1.5
				trait = patient
			}

			mult_modifier = {
				factor = 1.5
				trait = brooding
			}

			mult_modifier = {
				factor = 1.5
				trait = indolent
			}
		}
	}

	after = {
		clr_character_flag = flag_african_initiation_high
		clr_character_flag = flag_african_initiation_medium
		clr_character_flag = flag_african_initiation_low
	}
}

# on_adulthood: actual event, firing delay to avoid clutter
character_event = {
	id = HF.23775

	is_triggered_only = yes # on_adulthood
	hide_window = yes

	only_capable = yes
	has_dlc = "Holy Fury"

	trigger = {
		OR = {
			religion_openly_west_african_or_reformed_trigger = yes
			has_religion_feature = religion_animistic
			has_religion_feature = religion_feature_celtic
		}

		is_lowborn = no
	}

	immediate = {
		character_event = {
			id = HF.23773
			days = 50
			random = 50
		}
	}
}

# on_startup event to assign african face paint
character_event = {
	id = HF.23776

	is_triggered_only = yes
	hide_window = yes

	min_age = 16
	ai = yes

	trigger = {
		OR = {
			religion_openly_west_african_or_reformed_trigger = yes
			has_religion_feature = religion_animistic
			has_religion_feature = religion_feature_celtic
		}

		is_save_game = no
	}

	immediate = {
		random_list = {
			25 = { } # Nothing
			15 = { add_trait = african_tattoo_1 }
			15 = { add_trait = african_tattoo_2 }
			15 = { add_trait = african_tattoo_3 }
			15 = { add_trait = african_tattoo_4 }
			 5 = { add_trait = african_tattoo_5 }
			 4 = { add_trait = african_tattoo_6 }
			 3 = { add_trait = african_tattoo_7 }
			 2 = { add_trait = african_tattoo_8 }
			10 = { add_trait = african_tattoo_9 }
			10 = { add_trait = african_tattoo_10 }
			10 = { add_trait = african_tattoo_11 }
			10 = { add_trait = african_tattoo_12 }
		}

		if = {
			limit = { age < 23 }

			random_list = { # Modifier, if young enough
				10 = { } # Nothing

				25 = {
					trigger = {
						OR = {
							trait = african_tattoo_12
							trait = african_tattoo_8
							trait = african_tattoo_2
						}
					}

					add_character_modifier = {
						name = african_adulthood_rites_1
						years = 6
					}
				}

				25 = {
					trigger = {
						OR = {
							trait = african_tattoo_10
							trait = african_tattoo_7
							trait = african_tattoo_1
						}
					}

					add_character_modifier = {
						name = african_adulthood_rites_2
						years = 6
					}
				}

				25 = {
					trigger = {
						OR = {
							trait = african_tattoo_9
							trait = african_tattoo_6
							trait = african_tattoo_3
						}
					}

					add_character_modifier = {
						name = african_adulthood_rites_3
						years = 6
					}
				}

				25 = {
					trigger = {
						OR = {
							trait = african_tattoo_11
							trait = african_tattoo_5
							trait = african_tattoo_4
						}
					}

					add_character_modifier = {
						name = african_adulthood_rites_4
						years = 6
					}
				}
			}
		}
	}
}

# on_marriage: Divine Marriage due to Doctrine
# Sent to employers of both spouses
# ROOT is employer
# FROM is employers "employee"
# new_character is the other spouse
character_event = {
	id = HF.23777
	desc = EVTDESCHF23777
	picture = GFX_evt_marriage_zoroastrian_group

	is_triggered_only = yes # on_marriage

	trigger = {
		OR = {
			has_religion_feature = religion_holy_family
			has_religion_feature = religion_feature_zun
		}

		new_character = { is_close_relative = FROM } # Spouses are related

		OR = {
			FROM = { character = ROOT } # I'm the ony getting married

			AND = {
				FROM = { # My heir is getting married
					dynasty = ROOT
					is_primary_heir = ROOT
				}

				new_character = { # But not to me
					NOT = { character = ROOT }
				}
			}
		}
	}

	option = {
		name = EVTOPTA500

		scaled_wealth = {
			value = 0.5
			min = 10
		}

		trigger_switch = {
			on_trigger = real_tier

			EMPEROR = { piety = 300 }
			KING    = { piety = 200 }
			DUKE    = { piety = 100 }
			COUNT   = { piety =  50 }
			BARON   = { piety =  25 }
		}
	}

	option = {
		name = EVTOPTB500

		if = {
			limit = { yearly_income < 50 }

			trigger_switch = {
				on_trigger = real_tier

				EMPEROR = { prestige = 150 }
				KING    = { prestige =  50 }
				DUKE    = { prestige =  25 }
				COUNT   = { prestige =  13 }
				BARON   = { prestige =   6 }
			}
		}
		else = {
			trigger_switch = {
				on_trigger = real_tier

				EMPEROR = { prestige = 300 }
				KING    = { prestige = 200 }
				DUKE    = { prestige = 100 }
				COUNT   = { prestige =  50 }
				BARON   = { prestige =  25 }
			}
		}

		trigger_switch = {
			on_trigger = real_tier

			EMPEROR = { piety = 300 }
			KING    = { piety = 200 }
			DUKE    = { piety = 100 }
			COUNT   = { piety =  50 }
			BARON   = { piety =  25 }
		}
	}
}


# on_startup: Dogmatic + Holy Family + Temporal Head = Ruling religious head is the high god
character_event = {
	id = HF.23778

	is_triggered_only = yes # on_startup
	hide_window = yes

	trigger = {
		controls_religion = yes
		has_religion_feature = religion_temporal_head
		has_religion_feature = religion_dogmatic

		OR = {
			has_religion_feature = religion_holy_family
			has_religion_feature = religion_feature_zun
		}
	}

	immediate = {
		set_high_god_name = string_reformer_god
	}
}

# on_new_holder(_inheritance) event: Dogmatic + Holy Family + Temporal Head = Ruling religious head is the high god
# ROOT is the character
# FROM is the title
# FROMFROM is the old holder
character_event = {
	id = HF.23779

	is_triggered_only = yes # on_new_holder(_inheritance)
	hide_window = yes

	trigger = {
		FROM = { controls_religion = yes }
		has_religion_feature = religion_temporal_head
		has_religion_feature = religion_dogmatic

		OR = {
			has_religion_feature = religion_holy_family
			has_religion_feature = religion_feature_zun
		}

		# religion = FROMFROM
	}

	immediate = {
		set_high_god_name = string_reformer_god
	}
}